<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unidad 1 Conceptos básicos | Simulación de Procesos y Sistemas</title>
<meta name="description" content="En esta unidad repasamos los conceptos básicos de probabilidad relacionados con las variables aleatorias y las distribuciones de probabilidad. Presentamos las distribuciones de probabilidad más...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Unidad 1 Conceptos básicos | Simulación de Procesos y Sistemas">
<meta property="og:type" content="book">
<meta property="og:description" content="En esta unidad repasamos los conceptos básicos de probabilidad relacionados con las variables aleatorias y las distribuciones de probabilidad. Presentamos las distribuciones de probabilidad más...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unidad 1 Conceptos básicos | Simulación de Procesos y Sistemas">
<meta name="twitter:description" content="En esta unidad repasamos los conceptos básicos de probabilidad relacionados con las variables aleatorias y las distribuciones de probabilidad. Presentamos las distribuciones de probabilidad más...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Simulación de Procesos y Sistemas</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Antes de comenzar</a></li>
<li><a class="" href="software.html">Software</a></li>
<li><a class="active" href="intro.html"><span class="header-section-number">1</span> Conceptos básicos</a></li>
<li><a class="" href="cmtd.html"><span class="header-section-number">2</span> Cadenas de Markov de Tiempo Discreto</a></li>
<li><a class="" href="poissonprocess.html"><span class="header-section-number">3</span> Proceso de Poisson</a></li>
<li><a class="" href="CMTC.html"><span class="header-section-number">4</span> Cadenas de Markov de Tiempo Contínuo</a></li>
<li><a class="" href="COLAS.html"><span class="header-section-number">5</span> Sistemas de colas</a></li>
<li><a class="" href="SIMSIST.html"><span class="header-section-number">6</span> Aplicaciones prácticas</a></li>
<li><a class="" href="bibliograf%C3%ADa.html">Bibliografía</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="intro" class="section level1" number="1">
<h1>
<span class="header-section-number">Unidad 1</span> Conceptos básicos<a class="anchor" aria-label="anchor" href="#intro"><i class="fas fa-link"></i></a>
</h1>
<p>En esta unidad repasamos los conceptos básicos de probabilidad relacionados con las variables aleatorias y las distribuciones de probabilidad. Presentamos las distribuciones de probabilidad más relevantes, discretas y continuas, y otras no estandarizadas, junto con varios algoritmos y funciones de <code>R</code> útiles para simularlas y realizar cálculos de probabilidad. Resolvemos por simulación múltiples problemas basados en los diferentes tipos de variables presentadas. Por último, introducimos la definición de proceso estocástico, con diversos ejemplos, con el fin de preparar el camino para las unidades siguientes, que ya estarán enfocadas en estudiar en profundidad diferentes tipos de procesos estocásticos. Proponemos al final de la unidad más ejercicios y estudios de caso, para que el alumnado practique los conceptos y algoritmos estudiados.</p>
<div id="variables-aleatorias" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Variables aleatorias<a class="anchor" aria-label="anchor" href="#variables-aleatorias"><i class="fas fa-link"></i></a>
</h2>
<p>Introducimos una serie de conceptos básicos.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:randomvar" class="definition"><strong>Definición 1.1  </strong></span>Una <strong>variable aleatoria</strong> es una función que asigna un número real a cada uno de los posibles resultados de un experimento o característica de interés susceptibles de ser observados o medidos en una población objetivo.</p>
</div>
</div>
<p>Las variables aleatorias pueden ser <strong>discretas</strong> o <strong>continuas</strong> en función de sus posibles valores. Si los valores o resultados posibles se pueden contar (sin ser infinitos), se dice que la variable aleatoria es ‘discreta’; en caso contrario, se dice que es ‘continua.’ Veamos varios ejemplos.</p>
<div class="example">
<p><span id="exm:rvdiscreta" class="example"><strong>Ejemplo 1.1  </strong></span><em>Un proveedor vende huevos por cajas que contienen 144 huevos. El proveedor desea estudiar el número de huevos que se suelen romper en cada una de las cajas durante el proceso de distribución. Es de interés pues, la variable aleatoria</em> <span class="math inline">\(N\)</span> que contabiliza el número de huevos rotos en una caja, y cuyos valores posibles son <span class="math inline">\(0, 1, 2,..., 144\)</span>. Se trata por tanto de una variable de tipo discreto.</p>
</div>
<div class="example">
<p><span id="exm:rvdcontinua" class="example"><strong>Ejemplo 1.2  </strong></span><em>Se desea realizar un estudio para estimar la estatura de los habitantes de una ciudad. Se define la variable aleatoria</em> <span class="math inline">\(X\)</span> como la altura en cm de cada uno de los habitantes de la ciudad. Dado que los posibles resultados son infinitos, diremos que dicha variable es de tipo continuo.</p>
</div>
<div class="yellowbox">
<div class="definition">
<p><span id="def:espacioprob" class="definition"><strong>Definición 1.2  </strong></span>Se define el <strong>espacio probabilístico</strong> <span class="math inline">\(S\)</span> asociado a una variable aleatoria como el conjunto de todos los valores posibles o con probabilidad que puede tomar dicha variable.</p>
</div>
</div>
<div id="función-de-probabilidad" class="section level3" number="1.1.1">
<h3>
<span class="header-section-number">1.1.1</span> Función de probabilidad<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-probabilidad"><i class="fas fa-link"></i></a>
</h3>
<p>Para caracterizar completamente cualquier variable aleatoria es necesario definir la función de distribución, que nos da la probabilidad acumulada por debajo de un valor plausible en el espacio probabilístico <span class="math inline">\(S\)</span> en el que está definida dicha variable.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:fd" class="definition"><strong>Definición 1.3  </strong></span>La <strong>función de distribución</strong> para una variable <span class="math inline">\(X\)</span> en un punto <span class="math inline">\(a\)</span> del espacio probabilístico <span class="math inline">\(S\)</span> se define como la probabilidad acumulada por debajo de dicho valor:</p>
<p><span class="math display">\[\begin{equation*}
  F(a) = P(X \leq a).
\end{equation*}\]</span></p>
</div>
</div>
<p>En el caso de variables aleatorias de tipo discreto podemos caracterizar su comportamiento mediante las probabilidades asociadas a cada uno de los elementos del espacio probabilístico Esto se hace a través de la ‘función puntual de probabilidad’ o ‘función de masa de probabilidad.’</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:fmp" class="definition"><strong>Definición 1.4  </strong></span>La <strong>función de masa de probabilidad (fmp)</strong> para una variable discreta <span class="math inline">\(X\)</span> en un punto <span class="math inline">\(a\)</span> del espacio probabilístico <span class="math inline">\(S\)</span> se define como la probabilidad de que la variable <span class="math inline">\(X\)</span> tome dicho valor:</p>
<p><span class="math display">\[\begin{equation*}
  f(a) = P(X = a).
\end{equation*}\]</span></p>
</div>
</div>
<p>En el caso de variables aleatorias de tipo discreto, la función de distribución de probabilidad se puede obtener a partir de la función de masa de probabilidad como:</p>
<p><span class="math display">\[\begin{equation*}
  F(a) = \sum_{k \leq a} f(k) = 1 - \sum_{k &gt; a} f(k).
\end{equation*}\]</span></p>
<p>para cualquier valor de <span class="math inline">\(a\)</span> en <span class="math inline">\(S\)</span>.</p>
<p>Sim embargo, en las variables aleatorias de tipo continuo no es posible asignar una probabilidad a cada uno de los infinitos valores de la variable, dado que en ese caso la probabilidad del espacio probabilístico íntegro excedería el valor 1 y por lo tanto no sería una probabilidad. En estas variables es preciso definir otra función que permita cuantificar cualquier situación que involucre los resultados del espacio probabilístico <span class="math inline">\(S\)</span> asociado a la variable aleatoria. Surge la ‘función de densidad de probabilidad.’</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:fdp" class="definition"><strong>Definición 1.5  </strong></span>La <strong>función de densidad de probabilidad (fdp)</strong>, <span class="math inline">\(f\)</span>, asociada a una variable <span class="math inline">\(X\)</span> de tipo continuo permite calcular la probabilidad acumulada en un intervalo cualesquiera <span class="math inline">\((a,b]\)</span> del espacio probabilístico <span class="math inline">\(S\)</span> a través de la integral en dicho intervalo:</p>
<p><span class="math display">\[\begin{equation*}
  \int_{a}^{b} f(s)ds = Pr(a &lt; X \leq b) = F(b) - F(a).
\end{equation*}\]</span></p>
</div>
</div>
<p>De esta forma la ‘función de distribución’ de una variable continua se puede obtener como:</p>
<p><span class="math display">\[\begin{equation*}
  F(a) = \int_{r_{min}}^{a} f(s)ds.
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(r_{min}\)</span> es el valor mínimo de <span class="math inline">\(X\)</span> en el espacio probabilístico <span class="math inline">\(S\)</span>.</p>
</div>
<div id="variables-relevantes" class="section level3" number="1.1.2">
<h3>
<span class="header-section-number">1.1.2</span> Variables relevantes<a class="anchor" aria-label="anchor" href="#variables-relevantes"><i class="fas fa-link"></i></a>
</h3>
<p>Hay muchas funciones de distribución que se utilizan con tanta frecuencia que se conocen con nombres especiales, y que presentamos en las Secciones <a href="intro.html#distribuciones-discretas">Distribuciones Discretas</a> y <a href="intro.html#distribuciones-continuas">Distribuciones continuas</a>. Para estas variables resulta bastante sencillo realizar cualquier calculo de probabilidad, ya que la mayoría de programas informáticos tienen implementadas sus funciones de distribución. Utilizaremos no obstante la simulación para realizar cálculos probabilísticos.</p>
<div class="silverbox">
<p>En <span class="math inline">\(R\)</span> se puede acceder directamente a la función de densidad, función de distribución, quantiles y simulación de valores de cualquiera de las distribuciones que presentamos a continuación mediante las funciones:</p>
<ul>
<li>
<span class="math inline">\(dXXXX(par)\)</span>: función de densidad,</li>
<li>
<span class="math inline">\(pXXXX(par)\)</span>: función de distribución,</li>
<li>
<span class="math inline">\(qXXXX(par)\)</span>: quantiles,</li>
<li>
<span class="math inline">\(rXXXX(par)\)</span>: generación de valores de la variable,</li>
</ul>
<p>donde <span class="math inline">\(XXXX\)</span> identifica la distribución/variable de interés y <span class="math inline">\(par\)</span> son los parámetros que la caracterizan.</p>
</div>
</div>
<div id="media-y-varianza" class="section level3" number="1.1.3">
<h3>
<span class="header-section-number">1.1.3</span> Media y varianza<a class="anchor" aria-label="anchor" href="#media-y-varianza"><i class="fas fa-link"></i></a>
</h3>
<p>Muchas variables aleatorias tienen funciones de distribución complicadas y, por tanto, es difícil obtener una comprensión intuitiva del comportamiento de la variable conociendo simplemente la función de distribución. Dos medidas, la <strong>media o valor esperado</strong> y la <strong>varianza</strong> se definen para ayudar a describir el comportamiento de una variable aleatoria. El valor esperado equivale a la media aritmética de infinitas observaciones de la variable aleatoria y la varianza es una indicación de la variabilidad o dispersión de los valores de dicha variable.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:unlabeled-div-3" class="definition"><strong>Definición 1.6  </strong></span>Dada una variable aleatoria <span class="math inline">\(X\)</span> discreta sobre un espacio probabilístico <span class="math inline">\(S\)</span>, se define el valor esperado o <strong>esperanza</strong> de <span class="math inline">\(X\)</span>, <span class="math inline">\(E(X)\)</span>, como</p>
<p><span class="math display">\[E(X) = \sum_{k \ in S} kf(k)\]</span></p>
<p>donde <span class="math inline">\(f\)</span> es la fmp de <span class="math inline">\(X\)</span>.</p>
<p>Cuando <span class="math inline">\(X\)</span> es una variable aleatoria continua, su valor esperado se define a partir de la fdp de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[E(X) = \int_S xf(x)dx.\]</span></p>
</div>
</div>
<p>Esta definición se puede aplicar a cualquier función o transformación de una variable aleatoria, <span class="math inline">\(h(X)\)</span>, para obtener su valor esperado <span class="math inline">\(E[h(X)]\)</span>, y así por ejemplo en el caso continuo tendríamos:</p>
<p><span class="math display">\[E[h(X)]=\int_S h(x)f(x)dx.\]</span></p>
<p>El valor esperado nos da una medida de localización para la variable aleatoria <span class="math inline">\(X\)</span>, pero es bien sabido que dichas medidas de localización se deben acompañar siempre de una medida de dispersión, como la varianza o desviación típica.</p>
<div class="yellowbox">

<div class="definition">
<p><span id="def:unnamed-chunk-1" class="definition"><strong>Definición 1.7  </strong></span>Dada una variable aleatoria <span class="math inline">\(X\)</span> con valor esperado <span class="math inline">\(E(X)\)</span> se define la <strong>varianza</strong> de <span class="math inline">\(X\)</span>, <span class="math inline">\(V(X)\)</span> como:</p>
<span class="math display">\[V(X) = E[(X-E(X))^2]=E(X^2) - E(X)^2\]</span>
</div>
</div>
<p>A partir de la varianza se define la <strong>desviación típica</strong> de la variable <span class="math inline">\(X\)</span> como la raíz cuadrada de su varianza. Las propiedades siguientes se derivan directamente a partir de la definición de esperanza y varianza:</p>
<div class="bluebox">
<p>Si <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son dos variables aleatorias y <span class="math inline">\(c\)</span> una constante, entonces:</p>
<ul>
<li><span class="math inline">\(E(c) = c\)</span></li>
<li><span class="math inline">\(E(cX) = cE(X)\)</span></li>
<li><span class="math inline">\(E(X+Y) = E(X) + E(Y)\)</span></li>
<li><span class="math inline">\(V(cX) = c^2 V(X)\)</span></li>
</ul>
</div>
</div>
</div>
<div id="APMC" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Aproximación Monte Carlo<a class="anchor" aria-label="anchor" href="#APMC"><i class="fas fa-link"></i></a>
</h2>
<p>Cuando trabajamos con variables aleatorias, es común el problema de querer estimar el valor esperado de cualquier cantidad <span class="math inline">\(h(X)\)</span>, siendo <span class="math inline">\(X\)</span> una variable aleatoria. Utilizando la simulación es posible obtener estimaciones de dichos valores de un modo relativamente sencillo: a través de la <strong>integración Monte Carlo</strong>.</p>
<p>Ante un problema genérico relativo a calcular el valor esperado de cierta función <span class="math inline">\(h(X)\)</span> para una variable aleatoria con fdp <span class="math inline">\(X \sim f(x)\)</span>,</p>
<p><span class="math display" id="eq:problemaestimacionMC">\[\begin{equation}
E[h(X)]=\int_S h(x) f(x) dx
\tag{1.1}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(S\)</span> denota el conjunto en el que la variable <span class="math inline">\(X\)</span> toma valores,</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:MCestimacion" class="definition"><strong>Definición 1.8  </strong></span>Ante el problema de estimar <a href="intro.html#eq:problemaestimacionMC">(1.1)</a>, el procedimiento de estimación Monte Carlo propone simular una muestra aleatoria de la distribución de <span class="math inline">\(X\)</span>, <span class="math inline">\(x_1,\ldots,x_n\)</span> y con ella obtener una aproximación empírica a través del promedio de las cantidades <span class="math inline">\(h(x_1),\ldots,h(x_n)\)</span>,</p>
<p><span class="math display" id="eq:estimacionMC">\[\begin{equation}
\bar{h_n}=\frac{\sum_{i=1}^n h(x_i)}{n}.
\tag{1.2}
\end{equation}\]</span></p>
</div>
</div>
<p>Por la Ley de los Grandes Números, <span class="math inline">\(\bar{h_n}\)</span> converge casi seguro a la cantidad de interés <span class="math inline">\(E[h(X)]\)</span>. Además, cuando <span class="math inline">\(h^2(X)\)</span> tiene un valor esperado finito, la velocidad de convergencia de <span class="math inline">\(\bar{h_n}\)</span> se puede calcular y la varianza asintótica de la aproximación es <span class="math display">\[Var(\bar{h_n})=\frac{1}{n} \int_S (h(x)-E[h(X)])^2 f(x) dx,\]</span> que se puede estimar con la muestra <span class="math inline">\(x_1,\ldots,x_n\)</span> a través de</p>
<p><span class="math display" id="eq:varianzaMC">\[\begin{equation}
v_n=\frac{1}{n^2} \sum_{i=1}^n [h(x_i)-\bar{h_n}]^2.
\tag{1.3}
\end{equation}\]</span></p>
<p>Más específicamente, por el Teorema Central del Límite, para <span class="math inline">\(n\)</span> grande tendremos que</p>
<p><span class="math display" id="eq:distMC">\[\begin{equation}
\frac{\bar{h_n}-E[h(X)]}{\sqrt{v_n}} \sim N(0,1),
\tag{1.4}
\end{equation}\]</span></p>
<p>lo que permitirá además, construir bandas de confianza para la aproximación Monte Carlo, a la que en adelante nos referiremos por “aproximación MC.”</p>
<p><span class="math display" id="eq:icMC">\[\begin{equation}
IC_{1-\alpha}[\bar{h_n}]=[\bar{h_n}-z_{1-\alpha/2} \sqrt{v_n}, \bar{h_n}+z_{1-\alpha/2} \sqrt{v_n}]
\tag{1.5}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(z_{1-\alpha/2}\)</span> es el cuantil <span class="math inline">\(1-\alpha/2\)</span> de una normal estándar, asociado al nivel de confianza <span class="math inline">\(1-\alpha\)</span>.</p>
<div id="mc-y-probabilidad" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> MC y probabilidad<a class="anchor" aria-label="anchor" href="#mc-y-probabilidad"><i class="fas fa-link"></i></a>
</h3>
<p>Aunque en las situaciones más sencillas se puede evaluar cualquier probabilidad mediante la correspondiente función de distribución, en muchas ocasiones resulta sencillo obtener una muestra simulada de la variable aleatoria y aproximar dicha probabilidad de interés mediante el denominado <strong>estimador Monte-Carlo</strong>.</p>
<p>Se obtiene la estimación Monte-Carlo (MC) de la probabilidad de que una variable aleatoria <span class="math inline">\(X\)</span> tome algún valor en un conjunto <span class="math inline">\(A\)</span> de valores dentro de su espacio probabilístico, <span class="math inline">\(Pr(X \in A)\)</span>, a partir de un conjunto de observaciones o simulaciones <span class="math inline">\(x_1, x_2,...,x_N\)</span> de la variable <span class="math inline">\(X\)</span>, mediante el cociente entre el número de simulaciones que están en dicha región <span class="math inline">\(A\)</span>, y el número de datos disponibles,</p>
<p><span class="math display">\[\begin{equation}
Pr(X \in A) \approx \frac{\#\{x_1, x_2,...,x_N\} \in A}{N}.
\end{equation}\]</span></p>
<p>Básicamente esta definición se fundamenta en la interpretación empírica de la probabilidad, a través del ratio de casos favorables por casos posibles:</p>
<p><span class="math display">\[probabilidad=\frac{\mbox{casos favorables}}{\mbox{casos posibles}}.\]</span></p>
<p>La fórmula anterior la podemos expresar en notación similar a la utilizada en <a href="intro.html#eq:estimacionMC">(1.2)</a> definiendo una variable dicotómica <span class="math display">\[I_A(X)=1 \text{,  si } X \in A\]</span> y 0 en otro caso, de manera que el problema de calcular una probabilidad según una distribución de probabilidad para <span class="math inline">\(X\)</span> se convierte en el valor esperado de una distribución Bernouilli para una distribución de</p>
<p><span class="math display">\[Pr(X \in A)=\int_A f(x)dx=\int_S I_A(X)f(x)dx=E[I_A(X)]\]</span> y la estimación MC <a href="intro.html#eq:estimacionMC">(1.2)</a> se puede expresar, para un conjunto de <span class="math inline">\(n\)</span> simulaciones <span class="math inline">\(x_1,\ldots,x_n\)</span>, como</p>
<p><span class="math display" id="eq:estimacionMCprob">\[\begin{equation}
Pr(X \in A)\approx \hat{h_n}= \frac{\sum_{i=1}^n I_A(x_i)}{n},
\tag{1.6}
\end{equation}\]</span></p>
<p>y su varianza con</p>
<p><span class="math display" id="eq:varMCprob">\[\begin{equation}
v_n=\frac{1}{n^2} \sum_{i=1}^n [I_A(x_i)-\bar{h_n}]^2.
\tag{1.7}
\end{equation}\]</span></p>
<div class="example">
<p><span id="exm:unlabeled-div-4" class="example"><strong>Ejemplo 1.3  </strong></span>En la situación del ejemplo <a href="intro.html#exm:rvdiscreta">1.1</a>, supongamos que disponemos de un conjunto de 200 simulaciones del número de huevos defectuosos en 200 cajas distribuídas. Queremos descubrir, utilizando exclusivamente esas simulaciones:</p>
<ol style="list-style-type: decimal">
<li>La probabilidad de que una caja tenga más de 3 huevos defectuosos, <span class="math inline">\(Pr(X&gt;3)\)</span>.</li>
<li>La probabilidad de que una caja tenga a lo sumo 3 huevos defectuosos, <span class="math inline">\(Pr(X\leq 3)\)</span>.</li>
<li>La probabilidad de que una caja no tenga ningún huevo defectuoso, <span class="math inline">\(Pr(X=0)\)</span>.</li>
<li>La probabilidad de que la proporción de huevos defectuosos en una caja sea inferior al 1%, <span class="math inline">\(Pr(X/144 &lt; 0.01)=Pr(X&lt;1.44)\)</span>.</li>
</ol>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulaciones disponibles</span>
<span class="va">defectos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, 
<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, 
<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, 
<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, 
<span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, 
<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, 
<span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, 
<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">1</span>, 
<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, 
<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, 
<span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, 
<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0</span>, 
<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co"># Número de simulaciones/observaciones</span>
<span class="va">nsim</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">defectos</span><span class="op">)</span>
<span class="co"># Tamaño de la caja</span>
<span class="va">tamaño</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">144</span>,<span class="fl">200</span><span class="op">)</span>
<span class="co"># Conjunto de datos</span>
<span class="va">huevos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tamaño</span>, <span class="va">defectos</span><span class="op">)</span></code></pre></div>
<p>Y vamos aproximando por Monte-Carlo las probabilidades de interés, estableciendo las condiciones lógicas en cada situación.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(X &gt; 3)</span>
<span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">huevos</span>, <span class="va">defectos</span> <span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sel</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Probabilidad estimada [Pr(X &gt; 3)]: "</span>, <span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## Probabilidad estimada [Pr(X &gt; 3)]:  0.075</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(X &lt;= 3)</span>
<span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">huevos</span>, <span class="va">defectos</span> <span class="op">&lt;=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sel</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Probabilidad estimada [Pr(X &lt;= 3)]: "</span>, <span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## Probabilidad estimada [Pr(X &lt;= 3)]:  0.925</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(X = 0)</span>
<span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">huevos</span>, <span class="va">defectos</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sel</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Probabilidad estimada [Pr(X = 0): "</span>, <span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## Probabilidad estimada [Pr(X = 0):  0.235</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(X/144 &lt;=0.01)</span>
<span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">huevos</span>, <span class="va">defectos</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fl">0.01</span><span class="op">*</span><span class="fl">144</span><span class="op">)</span><span class="op">)</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sel</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Probabilidad estimada [Pr(X/144 &lt;=0.01): "</span>, <span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## Probabilidad estimada [Pr(X/144 &lt;=0.01):  0.62</code></pre>
<p>El error asociado a la estimación de la probabilidad anterior, lo calculamos aplicando <a href="intro.html#eq:varMCprob">(1.7)</a>, y también el intervalo de confianza al 95% con <a href="intro.html#eq:icMC">(1.5)</a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I.a</span><span class="op">=</span><span class="op">(</span><span class="va">huevos</span><span class="op">$</span><span class="va">defectos</span> <span class="op">&lt;=</span> <span class="fl">1.44</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span>
<span class="va">prob</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I.a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"prob.estim="</span>,<span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## prob.estim= 0.62</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vn</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">I.a</span><span class="op">-</span><span class="va">prob</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vn</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Error Estimado="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error Estimado= 0.034</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC(prob.estim)]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC(prob.estim)]=[ 0.553 , 0.687 ]</code></pre>
<p>De esta forma resultará posible estimar cualquier probabilidad asociada a una variable aleatoria, aun desconociendo su función de distribución o de probabilidad, siempre que dispongamos de una muestra simulada, y esta estimación será más precisa cuanto mayor sea el tamaño de dicha muestra.</p>
</div>
<div id="mc-y-momentos" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> MC y momentos<a class="anchor" aria-label="anchor" href="#mc-y-momentos"><i class="fas fa-link"></i></a>
</h3>
<p>Si disponemos de una muestra (de observaciones o simulaciones) lo suficientemente grande de la variable aleatoria <span class="math inline">\(X\)</span> podemos aproximar -de modo razonablemente preciso- el valor esperado y la varianza (o desviación típica) sin más que calcular la media y varianza de los datos que componen la muestra.</p>
<p>La precisión de estas estimaciones estará directamente relacionada con el tamaño de la muestra utilizada.</p>
<p>Sean <span class="math inline">\(x_1, x_2,...,x_N\)</span> simulaciones disponibles para <span class="math inline">\(X\)</span>. Entonces</p>
<p><span class="math display">\[\begin{eqnarray*}
E(X) &amp;\approx&amp; \bar{x}_N=\sum_{i=1}^N x_i /N \\
Var(X) &amp;\approx&amp; \sum_{i=1}^N (x_i-\bar{x}_N)^2/n = \bar{x}_N^2-\sum_{i=1}^N x_i^2 /N.
\end{eqnarray*}\]</span></p>
<div class="example">
<p><span id="exm:unlabeled-div-5" class="example"><strong>Ejemplo 1.4  </strong></span>Con los datos del ejemplo anterior, queremos saber cuál es el número aproximado de huevos que se rompen en cada caja, conocer su dispersión y tener así mismo un intervalo de confianza para la media.</p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># media</span>
<span class="va">media</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">huevos</span><span class="op">$</span><span class="va">defectos</span><span class="op">)</span>
<span class="co"># dispersión</span>
<span class="va">varianza</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">huevos</span><span class="op">$</span><span class="va">defectos</span><span class="op">)</span>
<span class="va">desvtip</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">huevos</span><span class="op">$</span><span class="va">defectos</span><span class="op">)</span>

<span class="co"># ic para la media</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">huevos</span><span class="op">$</span><span class="va">defectos</span><span class="op">-</span><span class="va">media</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Error Estimado (media)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Error Estimado (media)= 0.089</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">media</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">media</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC(media)]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC(media)]=[ 1.255 , 1.605 ]</code></pre>
</div>
</div>
<div id="distribuciones-discretas" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Distribuciones discretas<a class="anchor" aria-label="anchor" href="#distribuciones-discretas"><i class="fas fa-link"></i></a>
</h2>
<p>Destacamos como principales variables de tipo discreto las siguientes: Bernouilli, Binomial, Geométrica y Poisson.</p>
<div id="bernouilli" class="section level3" number="1.3.1">
<h3>
<span class="header-section-number">1.3.1</span> Bernouilli<a class="anchor" aria-label="anchor" href="#bernouilli"><i class="fas fa-link"></i></a>
</h3>
<p>Imaginemos una situación experimental donde el resultado de cierta variable que observamos únicamente puede tomar dos valores posibles, denominados “éxito” (codificado con el valor 1) y “fracaso” (codificado con el valor 0). Así pues, la variable aleatoria asociada <span class="math inline">\(X\)</span> verifica que:</p>
<p><span class="math display" id="eq:var-bernouilli">\[\begin{equation}
Pr(X = x) = 
\begin{cases}
\theta &amp; \text{ si } x = 1 (\text{ éxito})\\
1- \theta &amp; \text{ si } x = 0 (\text{ fracaso.})
\end{cases}
\tag{1.8}
\end{equation}\]</span></p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vber" class="definition"><strong>Definición 1.9  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span> cuya fmp viene dada por <a href="intro.html#eq:var-bernouilli">(1.8)</a> se denomina <strong>variable Bernouilli</strong>, con probabilidad de éxito <span class="math inline">\(\theta\)</span>, y se denota por:</p>
<p><span class="math display">\[X \sim Ber(\theta)\]</span></p>
<p>de forma que <span class="math inline">\(E(X) = \theta\)</span> y <span class="math inline">\(V(X) = \theta(1-\theta).\)</span></p>
</div>
</div>
<p>Un ejemplo típico de una variable Bernouilli es el lanzamiento de una moneda que sólo tiene dos posibles resultados: cara o cruz. Si la moneda esta equilibrada tenemos que <span class="math inline">\(\theta = 0.5\)</span> (idéntica probabilidad para cualquiera de los dos resultados), de forma que si definimos por ejemplo el éxito por conseguir cara, tendremos:</p>
<p><span class="math display">\[X = \text{ Obtener cara } \sim Ber(0.5)\]</span></p>
<div class="whitebox">
<p>Una distribución <span class="math inline">\(Ber(p)\)</span> es equivalente a una distribución binomial con parámetros 1 y p, <span class="math inline">\(Bin(1,p)\)</span>, de modo que para simular y realizar cálculos de probabilidad con ella utilizaremos las funciones correspondientes a la distribución binomial que vemos a continuación.</p>
<ul>
<li>La función <code>dbinom(x,1,prob)</code> nos permite evaluar la <span class="math inline">\(Pr(X=x)\)</span> para una variable Bernoilli con probabilidad de éxito <code>prob</code>.</li>
<li>La función <code>pbinom(x,1,prob)</code> nos permite evaluar la <span class="math inline">\(Pr(X \leq x), x=0,1\)</span>.</li>
<li>La función <code>rbinom(n,1,prob)</code> permite simular <span class="math inline">\(n\)</span> valores Bernouilli.</li>
</ul>
</div>
</div>
<div id="binomial" class="section level3" number="1.3.2">
<h3>
<span class="header-section-number">1.3.2</span> Binomial<a class="anchor" aria-label="anchor" href="#binomial"><i class="fas fa-link"></i></a>
</h3>
<p>Consideramos un experimento Bernouilli que repetimos en <span class="math inline">\(n\)</span> ocasiones, obteniendo en cada repetición sólo dos resultados posibles, “éxito” o “fracaso,” con cierta probabilidad <span class="math inline">\(\theta\)</span> para el éxito, y contabilizamos el número de éxitos <span class="math inline">\(N\)</span>. Los posibles resultados de este experimento son <span class="math inline">\(\{0, 1, 2,...,n\}\)</span> éxitos conseguidos en un total de <span class="math inline">\(n\)</span> pruebas. La probabilidad de observar <span class="math inline">\(x\)</span> éxitos en <span class="math inline">\(n\)</span> pruebas viene dada por la función:</p>
<p><span class="math display" id="eq:var-binomial">\[\begin{equation}
Pr(N = x) = \frac{n!}{x!(n-x)!}  \theta^{x} (1-\theta)^{n-x}  \text{ para } x = 0, 1,\ldots,n,
\tag{1.9}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(n\)</span> el número de repeticiones o pruebas Bernouilli realizadas, <span class="math inline">\(x\)</span> el número de éxitos obtenidos, y <span class="math inline">\(\theta\)</span> la probabilidad de éxito.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vbinom" class="definition"><strong>Definición 1.10  </strong></span>La variable aleatoria <span class="math inline">\(N\)</span> que se obtiene como la suma de <span class="math inline">\(n\)</span> variables Bernouilli independientes con la misma probabilidad de éxito <span class="math inline">\(\theta\)</span>, y cuya función de masa de probabilidad viene dada en <a href="intro.html#eq:var-binomial">(1.9)</a>, se denomina variable Binomial de tamaño <span class="math inline">\(n\)</span> y probabilidad de éxito <span class="math inline">\(\theta\)</span>, y se denota por:</p>
<p><span class="math display">\[N \sim Bi(n,\theta)\]</span></p>
<p>con <span class="math inline">\(E(N) = n\theta\)</span> y <span class="math inline">\(V(N) = n\theta(1-\theta).\)</span></p>
</div>
</div>
<p>A continuación se presentan algunos ejemplos de aplicación de la variable Binomial donde representamos tanto la fmp como la función de distribución asociada al problema de interés. Antes mencionamos las funciones de <code>R</code> relacionadas con esta distribución.</p>
<div class="whitebox">
<ul>
<li>La función <code>dbinom(x,size,prob)</code> nos permite evaluar la <span class="math inline">\(Pr(N=x)\)</span> para una variable Binomial con tamaño <code>size</code> y probabilidad de éxito <code>prob</code>.</li>
<li>
<code>pbinom(x,size,prob)</code> permite evaluar la <span class="math inline">\(Pr(N \leq x)\)</span>.</li>
<li>
<code>rbinom(n,size,prob)</code> permite simular <span class="math inline">\(n\)</span> valores de una variable Binomial de tamaño <code>size</code> y probabilidad de éxito <span class="math inline">\(prob\)</span>.</li>
</ul>
</div>
<div class="example">
<p><span id="exm:binom01" class="example"><strong>Ejemplo 1.5  </strong></span>Estamos revisando en una empresa el comportamiento de las bajas laborales. En base al histórico, se tiene que cada día aproximadamente el 3% de los trabajadores faltan al trabajo alegando una baja laboral. Si el número de trabajadores de la empresa es de 150, queremos saber qué porcentaje de días vamos a tener al menos 3 trabajadores de baja.</p>
<p>Denotemos por <span class="math inline">\(N\)</span> a la variable aleatoria que indica el número de trabajadores de baja en un día cualquiera, e identifiquemos el “éxito” por el hecho de “estar de baja.” Así, podemos asumir que la distribución de <span class="math inline">\(N\)</span> es binomial, con tamaño 50 y probabilidad 0.03.</p>
<p><span class="math display">\[N \sim Bi(50,0.03).\]</span></p>
<p>En consecuencia, el valor esperado del número de trabajadores de baja cada día es <span class="math inline">\(E(N) = 50 \cdot 0.03=1.5\)</span>.</p>
<p>A continuación, en la Figura <a href="intro.html#fig:01-005">1.1</a> representamos la fmp y la función de distribución asociadas.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># los valores posibles de la variable Bin(1000,0.03) son</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">50</span>
<span class="va">n</span><span class="op">=</span><span class="fl">50</span>
<span class="va">p</span><span class="op">=</span><span class="fl">0.03</span>
<span class="co"># Data frame</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="va">xs</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">n</span>,<span class="va">p</span><span class="op">)</span>, 
                    probsacum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span>
<span class="co"># función de masa de probabilidad</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">xs</span>, y<span class="op">=</span><span class="va">probs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Probabilidad puntual. Pr(N=x)"</span><span class="op">)</span>
<span class="co"># función de distribución</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">probsacum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_extended.html">breaks_extended</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span><span class="st">"Probabilidad acumulada. Pr(N&lt;=x)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-005"></span>
<img src="01-Probabilidad_files/figure-html/01-005-1.png" alt="Función de masa de probabilidad y Función de distribución para el número de trabajadores de baja un día cualquiera." width="95%"><p class="caption">
Figura 1.1: Función de masa de probabilidad y Función de distribución para el número de trabajadores de baja un día cualquiera.
</p>
</div>
<p>En la fmp (Figura <a href="intro.html#fig:01-005">1.1</a>-izquierda) podemos ver que en este caso la probabilidad se concentra en muy pocos valores, en concreto por debajo de 10, de modo que antes de llegar a <span class="math inline">\(x=10\)</span> la probabilidad acumulada llega al valor 1, como se aprecia en la Figura <a href="intro.html#fig:01-005">1.1</a>-derecha.</p>
<p>La probabilidad que nos reclaman en el enunciado es <span class="math display">\[Pr(N\geq 3)=1-Pr(N \leq 2),\]</span> que calculamos y podemos aproximar por MC a partir, por ejemplo, de 1000 simulaciones.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsim</span><span class="op">=</span><span class="fl">1000</span>
<span class="va">n</span><span class="op">=</span><span class="fl">50</span>
<span class="va">p</span><span class="op">=</span><span class="fl">0.03</span>
<span class="co"># valor real de la probabilidad</span>
<span class="va">prob</span><span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(N&gt;=3)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(N&gt;=3)= 0.189</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="co"># simulaciones</span>
<span class="va">I.a</span><span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">nsim</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span>  <span class="co"># función indicatriz para la probabilidad requerida</span>
<span class="va">prob</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I.a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AproxMC="</span>,<span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## AproxMC= 0.193</code></pre>
<p>El error estimado de esta aproximación, que calculamos con la raíz cuadrada de <a href="intro.html#eq:varianzaMC">(1.3)</a> es</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">I.a</span><span class="op">-</span><span class="va">prob</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Error.AproxMC="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error.AproxMC= 0.012</code></pre>
<p>de donde podríamos calcular un intervalo de confianza para la aproximación MC de <span class="math inline">\(Pr(N \geq 3)\)</span> al 95% utilizando la distribución <a href="intro.html#eq:distMC">(1.4)</a> y la fórmula <a href="intro.html#eq:icMC">(1.5)</a>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC]=[ 0.169 , 0.217 ]</code></pre>
</div>
<div class="example">
<p><span id="exm:binom02" class="example"><strong>Ejemplo 1.6  </strong></span>Una empresa de fabricación produce piezas, de las cuales el 97% están dentro de las especiﬁcaciones y el 3% son defectuosas (fuera de las especiﬁcaciones). Aparentemente no hay ningún patrón en la producción de piezas defectuosas. La cadena de producción empaqueta las piezas en cajas de 20 piezas cada una, y produce 1000 cajas al día. Al gerente de la empresa le gustaría estimar el número de cajas con al menos dos piezas defectuosas, de entre todas las que se producen al día durante un día cualquiera.</p>
</div>
<p>Si <span class="math inline">\(N\)</span> es la variable aleatoria que recoge el número de piezas defectuosas en una caja, tenemos que:</p>
<p><span class="math display">\[N \sim Bi(20, 0.03)\]</span></p>
<p>La probabilidad de que una caja tenga al menos dos piezas defectuosas se calcula con <span class="math inline">\(p_N=Pr(N \geq 2)=1-Pr(N\leq 1)\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span><span class="op">=</span><span class="fl">20</span>
<span class="va">p</span><span class="op">=</span><span class="fl">0.03</span>
<span class="va">prob</span><span class="op">=</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Probabilidad de que una caja tenga al menos dos defectos="</span>,<span class="va">prob</span><span class="op">)</span></code></pre></div>
<pre><code>## Probabilidad de que una caja tenga al menos dos defectos= 0.119838</code></pre>
<p>Sin embargo, lo que nos piden es, de un total de 1000 cajas, cuál es el número esperado de cajas con al meos dos piezas defectuosas. Para ello, surge la variable <span class="math inline">\(D_N\)</span> que representa el número de cajas, de un total de 1000, con al menos 2 piezas defectuosas, que es binomial de tamaño 1000 y probabilidad <span class="math inline">\(p_N\)</span>,</p>
<p><span class="math display">\[D_N \sim Bin(1000,p_N),\]</span></p>
<p>y lo que nos están pidiendo es <span class="math inline">\(E(D_N)=1000 p_N\)</span>.</p>
<p>Si simulamos con la distribución de <span class="math inline">\(N\)</span> lo acontecido un día, esto es, con 1000 cajas o simulaciones, y contamos el número de cajas con 2 o más piezas defectuosas, obtenemos una aproximación a la cantidad que nos piden.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span><span class="op">=</span><span class="fl">20</span>
<span class="va">p</span><span class="op">=</span><span class="fl">0.03</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 99</code></pre>
<p>El problema es que no todos los días son iguales. De hecho si repites los siguientes cálculos varias veces, verás como el resultado varía. La aproximación Monte Carlo habría de considerar simulaciones de la variable <span class="math inline">\(D_n\)</span> , esto es, <code>nsim</code> días, para con ellos poder sacar una conclusión “promedio” de lo que puede ocurrir un día cualquiera.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsim</span><span class="op">=</span><span class="fl">5000</span> <span class="co"># número de días simulados</span>
<span class="va">n</span><span class="op">=</span><span class="fl">1000</span>
<span class="va">p</span><span class="op">=</span><span class="va">prob</span>
<span class="co"># valor real del valor esperado</span>
<span class="va">media</span><span class="op">=</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(D_N)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">media</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## E(D_N)= 119.838</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulaciones</span>
<span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">nsim</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span>
<span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">nsim</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AproxMC="</span>,<span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## AproxMC= 119.7926</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Error MC</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">xi</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC]=[ 119.51 , 120.076 ]</code></pre>
</div>
<div id="geométrica" class="section level3" number="1.3.3">
<h3>
<span class="header-section-number">1.3.3</span> Geométrica<a class="anchor" aria-label="anchor" href="#geom%C3%A9trica"><i class="fas fa-link"></i></a>
</h3>
<p>Imaginemos una situación experimental donde se repite un experimento hasta que sucede un “éxito.” En otras palabras, se piensa en <span class="math inline">\(\theta\)</span> como la probabilidad de éxito para un solo ensayo, y realizamos sucesivamente los ensayos hasta que se produce un éxito. La variable aleatoria <span class="math inline">\(N\)</span> se define entonces como el número de ensayos Bernouilli realizados hasta conseguir un éxito. Nótese que aunque la variable aleatoria geométrica es discreta, su rango es inﬁnito, y su fmp viene dada por:</p>
<p><span class="math display" id="eq:var-geometrica">\[\begin{equation}
Pr(N = x) = \theta (1-\theta)^{x}  \text{ para } x = \text{1, 2,...}
\tag{1.10}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(x\)</span> el número de repeticiones hasta alcanzar un éxito, y <span class="math inline">\(\theta\)</span> la probabilidad de éxito.</p>
<div class="yellowbox">

<div class="definition">
<p><span id="def:vgeom" class="definition"><strong>Definición 1.11  </strong></span>La variable aleatoria <span class="math inline">\(N\)</span> cuya función de masa de probabilidad viene dada en <a href="intro.html#eq:var-geometrica">(1.10)</a> se denomina variable Geométrica de parámetro <span class="math inline">\(\theta\)</span>, y se denota por:</p>
<p><span class="math display">\[N \sim Ge(\theta)\]</span></p>
con <span class="math inline">\(E(N) = \frac{1 - \theta}{\theta}\)</span> y <span class="math inline">\(V(N) = \frac{1-\theta}{\theta^2}.\)</span>
</div>
</div>
<p>Las funciones de <code>R</code> relacionadas con esta distribución se presentan a continuación, y tras ello un ejemplo de aplicación de la variable Geométrica.</p>
<div class="whitebox">
<ul>
<li>La función <code>dgeom(x, prob)</code> nos permite evaluar la <span class="math inline">\(Pr(N=x)\)</span> para una variable Geométrica con probabilidad de éxito <code>prob</code>.</li>
<li>
<code>pgeom(x, prob)</code> calcula la función de distribución.</li>
<li>
<code>rgeom(n, prob)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Geométrica con probabilidad de éxito <span class="math inline">\(prob\)</span>. Los resultados que proporciona son el número de repeticiones realizadas hasta alcanzar el primer éxito.</li>
</ul>
</div>
<div class="example">
<p><span id="exm:geom01" class="example"><strong>Ejemplo 1.7  </strong></span>Una vendedora de coches ha hecho un análisis estadístico de su historial de ventas anterior y ha determinado que cada día tiene un 10% de probabilidad de vender un coche de lujo. Tras un cuidadoso análisis posterior, también está claro que la venta de un coche de lujo en un día es independiente de la ventas realizadas cualquier otro día. El día de Año Nuevo (un día festivo en el que el concesionario estaba cerrado) la vendedora está intentando predecir cuándo venderá su primer coche de lujo del año.</p>
</div>
<p>Si consideramos <span class="math inline">\(N\)</span> como la variable aleatoria que indica el día de la primera venta de coches de lujo (N = 1 implica que la venta se realizaría el día 2 de enero), entonces:</p>
<p><span class="math display">\[N \sim Ge(0.1)\]</span></p>
<p>En este caso el valor esperado del número de días transcurridos hasta la venta del primer coche de lujo es <span class="math inline">\(E(N) = 0.9/0.1 = 9\)</span> días, con una desviación típica de 9.5 días. Así pues, es posible que el día 10 de enero tenga su primera venta. En la Figura <a href="intro.html#fig:01-008">1.2</a> se muestran la fmp y la función de distribución asociadas.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valores de N</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">1</span><span class="op">)</span>
<span class="co"># Data frame</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="va">xs</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html">dgeom</a></span><span class="op">(</span><span class="va">xs</span>, <span class="fl">0.1</span><span class="op">)</span>, 
                    probsacum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html">pgeom</a></span><span class="op">(</span><span class="va">xs</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="co"># función de masa de probabilidad</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">probs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.12</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Probabilidad puntual. Pr(N=x)"</span><span class="op">)</span>
<span class="co"># función de distribución</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">probsacum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_extended.html">breaks_extended</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Probabilidad acumulada Pr(N&lt;=x)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-008"></span>
<img src="01-Probabilidad_files/figure-html/01-008-1.png" alt="Función de masa de probabilidad y Función de distribución para el día en que venderá el primer coche de lujo." width="95%"><p class="caption">
Figura 1.2: Función de masa de probabilidad y Función de distribución para el día en que venderá el primer coche de lujo.
</p>
</div>
<p>Hacemos a continuación un análisis de simulación para aproximar los datos teóricos dados en la definición <a href="intro.html#def:vgeom">1.11</a>. Simulamos 1000 valores de una <span class="math inline">\(Ge(0.1)\)</span>, con los que calculamos una aproximación al valor esperado de los días que deben transcurrir para vender un coche de lujo, y construimos un intervalo de confianza para la aproximación MC según <a href="intro.html#eq:icMC">(1.5)</a>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros de la simulación</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>
<span class="va">media</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prob</span><span class="op">)</span><span class="op">/</span><span class="va">prob</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(N)="</span>,<span class="va">media</span><span class="op">)</span></code></pre></div>
<pre><code>## E(N)= 9</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valores simulados</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html">rgeom</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">prob</span><span class="op">)</span>
<span class="co"># Aproximación MC del valor esperado</span>
<span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AproxMC="</span>,<span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## AproxMC= 9</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Error MC</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">datos</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC]=[ 8.811 , 9.189 ]</code></pre>
</div>
<div id="poisson" class="section level3" number="1.3.4">
<h3>
<span class="header-section-number">1.3.4</span> Poisson<a class="anchor" aria-label="anchor" href="#poisson"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución de Poisson se emplea como un modelo para variables aleatorias de tipo discreto cuando se quieren obtener las probabilidades de ocurrencia de un evento que se distribuye al azar en el espacio o el tiempo. Algunos ejemplos de esta distribución se presentan a continuación.</p>
<ul>
<li><p>En el estudio de cierto organismo acuático, se toman un gran número de muestras de un lago y se cuenta el número de dichos organismos que aparecen en cada muestra. Podríamos plantear como objetivo el conocer cuál es la probabilidad de encontrar dicho organismo en una próxima muestra si la media observada en el conjunto de muestras es de 2 organismos.</p></li>
<li><p>En un estudio sobre la efectividad de un insecticida sobre cierto tipo de insecto, se fumiga una gran región. Posteriormente se crea una cuadrícula sobre el terreno, se selecciona de forma aleatoria un conjunto de ellas, y se cuenta el número de insectos vivos dentro de cada una. Planteamos como objetivo conocer cuál es la probabilidad de que no encontremos ningún insecto vivo en una próxima cuadrícula si se sabe que la media de insectos vivos en las cuadrículas analizadas es de 0.5.</p></li>
<li><p>Un grupo de investigadores observó la ocurrencia de hemangioma capilar retiniano (RCH) en pacientes con la enfermedad de von Hippel-Lindau (VHL). RCH es un tumor vascular benigno de la retina. Usando una revisión retrospectiva de series de casos consecutivos, los investigadores encontraron que el número de medio de tumores RCH por ojo para pacientes con VHL era de 4. Están interesados en conocer cuál es la probabilidad de que se detecten más de cuatro tumores por ojo.</p></li>
</ul>
<p>La variable aleatoria <span class="math inline">\(N\)</span> se define entonces como el número de eventos que ocurren en un espacio o un tiempo determinados, y viene caracterizada por la denominada <em>tasa de eventos</em> o <em>número medio de eventos</em> que ocurren en el tiempo o espacio, y que se denota habitualmente por <span class="math inline">\(\lambda\)</span>. El rango de esta variable es infinito y su fmp viene dada por:</p>
<p><span class="math display" id="eq:var-poisson">\[\begin{equation}
Pr(N = x) = \frac{e^{-\lambda}\lambda^x}{x!}  \text{ para } x = \text{1, 2,...}
\tag{1.11}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(\lambda\)</span> es la tasa y <span class="math inline">\(x\)</span> es el número de eventos que han ocurrido.</p>
<div class="yellowbox">

<div class="definition">
<p><span id="def:vpoisson" class="definition"><strong>Definición 1.12  </strong></span>La variable aleatoria <span class="math inline">\(X\)</span> cuya función de masa de probabilidad viene dada en <a href="intro.html#eq:var-poisson">(1.11)</a> se denomina variable poisson de parámetro <span class="math inline">\(\lambda &gt; 0\)</span>, y se denota por:</p>
<p><span class="math display">\[N \sim Po(\lambda)\]</span></p>
con <span class="math inline">\(E(N) = \lambda\)</span> y <span class="math inline">\(V(N) = \lambda.\)</span>
</div>
</div>
<p>A continuación vemos diferentes ejemplos de uso de la distribución de Poisson, tras presentar las funciones de <code>R</code> relacionadas.</p>
<div class="whitebox">
<ul>
<li>La función <code>dpois(x, lambda)</code> nos permite evaluar la <span class="math inline">\(Pr(X=x)\)</span> para una variable poisson de media <span class="math inline">\(\lambda\)</span>.</li>
<li>
<code>ppois(x, lambda)</code> calcula la función de distribución.</li>
<li>
<code>rpois(n, lambda)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Poisson con media <span class="math inline">\(\lambda\)</span>. Los resultados que proporciona son el número de eventos que ocurren en el tiempo o espacio determinado.</li>
</ul>
</div>
<div class="example">
<p><span id="exm:poisson01" class="example"><strong>Ejemplo 1.8  </strong></span>Una empresa de asesoramiento está realizando el análisis del funcionamiento de una panadería y ha estimado que el número medio de barras de pan que se venden en un periodo de media hora es de 12. La empresa está interesada en saber cuál es la capacidad de venta en cada franja de diez minutos (pues es prácticamente el tiempo de horneado), y también cuál es la probabilidad de que el número de barras que se venden en diez minutos sea exactamente de tres.</p>
</div>
<p>Como nuestro interés radica en un periodo de diez minutos y el número de intervalos de diez minutos en un periodo de 30 minutos es tres, tenemos que el número medio de barras puestas a la venta en ese periodo viene dado por:</p>
<p><span class="math display">\[\lambda = 12/3 = 4.\]</span></p>
<p>La variable aleatoria que reproduce el número de barras que se venden en una franja de cinco minutos es:</p>
<p><span class="math display">\[N \sim Po(4)\]</span></p>
<p>En este caso el valor esperado del número de barras que se venden es 4 y la desviación típica es igual a 2(<span class="math inline">\(=\sqrt{4}\)</span>). En la Figura <a href="intro.html#fig:01-010">1.3</a> se muestran la fmp y la función de distribución asociadas.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valores de N</span>
<span class="va">lambda</span><span class="op">=</span><span class="fl">4</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>
<span class="co"># Data frame</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="va">xs</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">lambda</span><span class="op">)</span>, 
                    probsacum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span>
<span class="co"># función de masa de probabilidad</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">probs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Probabilidad puntual. Pr(N=x)"</span><span class="op">)</span>
<span class="co"># función de distribución</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">probsacum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_extended.html">breaks_extended</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Probabilidad acumulada Pr(N&lt;=x)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-010"></span>
<img src="01-Probabilidad_files/figure-html/01-010-1.png" alt="Función de masa de probabilidad y Función de distribución para el número de barras de pan que se venden cada cinco minutos." width="95%"><p class="caption">
Figura 1.3: Función de masa de probabilidad y Función de distribución para el número de barras de pan que se venden cada cinco minutos.
</p>
</div>
<p>Podemos reconoder en la Figura <a href="intro.html#fig:01-010">1.3</a>-izquierda los valores más probables con las barras más altas (3 y 4). De hecho, en la Figura <a href="intro.html#fig:01-010">1.3</a>-derecha, la probabilidad de que a lo sumo se vendan menos de 5 barras es algo superior a 0.6.</p>
<p>Para calcular la probabilidad pretendida, esto es, <span class="math inline">\(Pr(N=3)\)</span> utilizamos la función fmp correspondiente en <code>R</code> y la aproximamos por MC con 1000 simulaciones, dando también una banda de confianza.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span><span class="op">=</span><span class="fl">4</span>
<span class="co"># Probabilidad buscada P(N=3) para la poisson con media 2</span>
<span class="va">media</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">lambda</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(N=4)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">media</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(N=4)= 0.195</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="co"># Simulamos de la poisson y evaluamos la función indicatriz para la prob de interés</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">)</span>
<span class="va">I.a</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span>
<span class="co"># Realizamos la aproximación MC</span>
<span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I.a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AproxMC="</span>,<span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## AproxMC= 0.1934</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Error MC</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">I.a</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC]=[ 0.186 , 0.201 ]</code></pre>
<p>Si la aproximación la hacemos con 10 veces más simulaciones, el intervalo de estimación resultará más preciso:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span><span class="op">=</span><span class="fl">4</span>
<span class="co"># Probabilidad buscada P(N=3) para la poisson con media 2</span>
<span class="va">media</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">lambda</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(N=4)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">media</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(N=4)= 0.195</code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">10000</span><span class="op">*</span><span class="fl">10</span>
<span class="co"># Simulamos de la poisson y evaluamos la función indicatriz para la prob de interés</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">)</span>
<span class="va">I.a</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span>
<span class="co"># Realizamos la aproximación MC</span>
<span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">I.a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AproxMC="</span>,<span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## AproxMC= 0.19375</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Error MC</span>
<span class="va">error</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">I.a</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># límites del IC redondeados a 3 cifras decimales</span>
<span class="va">ic.low</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ic.up</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(95%)[AproxMC]=["</span>,<span class="va">ic.low</span>,<span class="st">","</span>,<span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(95%)[AproxMC]=[ 0.191 , 0.196 ]</code></pre>
<div class="example">
<p><span id="exm:poisson02" class="example"><strong>Ejemplo 1.9  </strong></span>Una empresa de fabricación de galletas de chocolate está analizando la calidad en su empresa para responder del mejor modo posible a sus clientes. Para ello ha fijado que con probabilidad 0.8 las galletas deben contener al menos tres trozos de chocolate para satisfacer las exigencias de los clientes. Se trata pues de fijar el valor medio de trozos de chocolate que debe ir suministrando en la cadena de producción para cumplir con el nivel de exigencia establecido.</p>
</div>
<p>Si <span class="math inline">\(N\)</span> es la variable aleatoria que indica el número de trozos de chocolate en una galleta, tenemos que:</p>
<p><span class="math display">\[N \sim Po(\lambda)\]</span></p>
<p>donde en este caso el valor de <span class="math inline">\(\lambda\)</span> es desconocido y representa el número medio de trozos de chocolate en cada galleta. Planteamos un estudio de simulación para aproximar dicho valor.</p>
<div class="silverbox">
<p>Algoritmo para aproximar el valor de <span class="math inline">\(\lambda\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Considerar una secuencia de valores de <span class="math inline">\(\lambda_i\)</span>, <span class="math inline">\(i=1,...,K\)</span>
</li>
<li>Obtener una muestra de tamaño <span class="math inline">\(nsim\)</span> para cada distribución <span class="math inline">\(Po(\lambda_i)\)</span>, <span class="math inline">\(M_i=\{x_{i_1},\ldots,x_{i_{nsim}}\}\)</span>.</li>
<li>Con cada muestra <span class="math inline">\(M_i\)</span> aproximar la probabilidad de que el número de trozos sea mayor o igual a 3, <span class="math inline">\(p_i\approx Pr(N_{\lambda_i}\geq3)\)</span>.</li>
<li>Obtener el valor mínimo de <span class="math inline">\(\lambda\)</span>, de entre <span class="math inline">\(\{\lambda_1,\ldots,\lambda_K\}\)</span> que verifica <span class="math inline">\(p_i \geq 0.8\)</span>.</li>
</ol>
</div>
<p>En la Figura <a href="intro.html#fig:01-013">1.4</a> se muestra el proceso de simulación realizado a continuación y el resultado obtenido para el valor de <span class="math inline">\(\lambda\)</span> para cumplir los requisitos de la empresa.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Paso 1</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="va">lams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span> <span class="co"># valores de lambda</span>
<span class="va">nlams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lams</span><span class="op">)</span>     <span class="co"># número de lambdas para evaluar</span>
<span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># vector de probabilidades</span>

<span class="co"># Pasos 2 y 3</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nlams</span><span class="op">)</span><span class="op">{</span>
  <span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">lams</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>    
  <span class="va">prob</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span>   
<span class="op">}</span>

<span class="co"># Paso 4. Resultado del problema</span>
<span class="va">lambda</span><span class="op">=</span><span class="va">lams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">prob</span> <span class="op">&gt;=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>;<span class="va">lambda</span></code></pre></div>
<pre><code>## [1] 4.25</code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pintamos los resultados de la simulación realizada</span>
<span class="va">dat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>lams<span class="op">=</span><span class="va">lams</span>,prob<span class="op">=</span><span class="va">prob</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lams</span>,y<span class="op">=</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">lambda</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"lambda"</span>,y<span class="op">=</span><span class="st">"Pr(N&gt;=3)"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-013"></span>
<img src="01-Probabilidad_files/figure-html/01-013-1.png" alt="Probabilidad estimada de conseguir al menos 3 trozos de chocolate en cada galleta, en función de lambda." width="95%"><p class="caption">
Figura 1.4: Probabilidad estimada de conseguir al menos 3 trozos de chocolate en cada galleta, en función de lambda.
</p>
</div>
<p>Así pues, el número medio de trozos de chocolate que ha de suministrarse a cada galleta ha de ser al menos de 4.25.</p>
</div>
</div>
<div id="distribuciones-continuas" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Distribuciones continuas<a class="anchor" aria-label="anchor" href="#distribuciones-continuas"><i class="fas fa-link"></i></a>
</h2>
<p>En este punto estudiamos las principales variables de tipo continuo. La especificación de estas variables se hace a partir de la función de densidad.</p>
<div id="uniforme" class="section level3" number="1.4.1">
<h3>
<span class="header-section-number">1.4.1</span> Uniforme<a class="anchor" aria-label="anchor" href="#uniforme"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución uniforme es la distribución de probabilidad continua más sencilla y se refiere a eventos infinitos que tienen la misma probabilidad de ocurrir en una intervalo dado. Si <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> son dos números reales con <span class="math inline">\(a &lt; b\)</span> entonces la función de distribución asociada a la probabilidad acumulada a la izquierda de cualquier valor <span class="math inline">\(x \in [a, b]\)</span> viene dada por:</p>
<p><span class="math display" id="eq:var-uniforme2">\[\begin{equation}
F(x) = 
\begin{cases}
0 &amp; \text{ si } x &lt; a \\
\frac{x-a}{b-a} &amp; \text{ si } a \leq x \leq b\\
1 &amp; \text{ si } a \leq x \leq b.
\end{cases}
\tag{1.12}
\end{equation}\]</span></p>
<div class="yellowbox">

<div class="definition">
<p><span id="def:vuniforme" class="definition"><strong>Definición 1.13  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span> tiene una distribución uniforme en el intervalo <span class="math inline">\([a, b]\)</span>, con $a,b R,</p>
<p><span class="math display">\[X \sim U(a,b)\]</span></p>
<p>si su función de densidad viene dada por la expresión</p>
<p><span class="math display" id="eq:var-uniforme">\[\begin{equation}
f(x) = 
\begin{cases}
\frac{1}{b-a} &amp; \text{ si } a \leq x \leq b\\
0 &amp; \text{ en otro caso }
\end{cases}
\tag{1.13}
\end{equation}\]</span></p>
de forma que <span class="math inline">\(E(X) = (a+b)/2\)</span> y <span class="math inline">\(V(X) = (b-a)^2/12.\)</span>
</div>
</div>
<p>La variable uniforme más famosa es la <span class="math inline">\(U(0,1)\)</span> ya que se utiliza habitualmente para modelizar la incertidumbre sobre una probabilidad desconocida, y es la base para muchos de los algoritmos de simulación de variables y procesos que estudiaremos en el futuro.</p>
<div class="whitebox">
<ul>
<li>La función <code>runif(n, a, b)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable uniforme en el intervalo <span class="math inline">\([a, b]\)</span>; <code>runif(n)</code> da una muestra para una distribución uniforme en [0, 1].</li>
<li>
<code>dunif(x,a,b)</code> da la fdp en <span class="math inline">\(x\)</span>.</li>
<li>
<code>punif(x,a,b)</code> da la probabilidad acumulada para cualquier punto <span class="math inline">\(x \in [a,b]\)</span>.</li>
</ul>
</div>
</div>
<div id="exponencial" class="section level3" number="1.4.2">
<h3>
<span class="header-section-number">1.4.2</span> Exponencial<a class="anchor" aria-label="anchor" href="#exponencial"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución exponencial es una distribución muy común en la modelización probabilística. Esta distribución describe procesos que describen el tiempo entre sucesos consecutivos, con la peculiaridad de que sus probabilidades no dependen del instante en que se produzcan los eventos. Es decir:</p>
<p><span class="math display">\[Pr(X &gt; t+s | X &gt; t) = Pr(X &gt; s).\]</span></p>
<p>Esta propiedad es característica de la distribución exponencial y se denomina “propiedad de la pérdida de memoria.”</p>
<p>Ejemplos de este tipo de distribución son:</p>
<ul>
<li><p>El tiempo que tarda una partícula radiactiva en desintegrarse. El conocimiento de la ley que sigue este evento se utiliza en ciencias para, por ejemplo, la datación de fósiles o cualquier materia orgánica mediante la técnica del carbono 14.</p></li>
<li><p>El tiempo que puede transcurrir en un servicio de urgencias, entre llegadas de pacientes, o en una fábrica entre roturas de una máquina.</p></li>
</ul>
<p>Esta distribución está muy relacionada con unos procesos que estudiaremos más adelante, denominados Procesos de Poisson.</p>
<p>La distribución exponencial viene completamente especificada, a través del parámetro <span class="math inline">\(\lambda &gt;0\)</span> que mide el número esperado de veces que ocurre el evento de interés por cada unidad de tiempo, y cuya función de distribución viene dada por:</p>
<p><span class="math display" id="eq:var-exponencial2">\[\begin{equation}
F(x) = 
\begin{cases}
0 &amp; \text{ si } x &lt; 0 \\
1 - e^{\lambda x} &amp; \text{ si } x \geq 0.
\end{cases}
\tag{1.14}
\end{equation}\]</span></p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vexponencial" class="definition"><strong>Definición 1.14  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span> tiene una distribución exponencial de parámetro <span class="math inline">\(\lambda\)</span>, que se denota por</p>
<p><span class="math display">\[X \sim Exp(\lambda)\]</span></p>
<p>si su función de densidad viene dada por</p>
<p><span class="math display">\[\begin{equation}
f(x)=\lambda e^{-\lambda x}, \quad x \geq 0,
\end{equation}\]</span></p>
<p>de forma que <span class="math inline">\(E(X) = 1/\lambda\)</span> y <span class="math inline">\(V(X) = 1/\lambda^2.\)</span></p>
</div>
</div>
<p>Las funciones relacionadas con la distribución exponencial en <code>R</code> son:</p>
<div class="whitebox">
<ul>
<li>La función <code>dexp(x, lambda)</code> nos permite evaluar la función de densidad para una variable poisson de parámetro <span class="math inline">\(\lambda\)</span>.</li>
<li>
<code>pexp(x, lambda)</code> nos permite evaluar la función de distribución.</li>
<li>
<code>rexp(n, lambda)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Exponencial de parámetro <span class="math inline">\(\lambda\)</span>.</li>
</ul>
</div>
<p>A continuación estudiamos dos ejemplos de uso de la distribución exponencial. Como siempre presentamos los resultados téoricos y procedemos mediante simulación para ver la aproximación conseguida.</p>
<div class="example">
<p><span id="exm:exponencial01" class="example"><strong>Ejemplo 1.10  </strong></span>Se ha comprobado que el tiempo de vida de cierto tipo de marcapasos sigue una distribución exponencial con media 16 años. (1) ¿Cuál es la probabilidad de que a una persona a la que se le ha implantado este marcapasos se le deba reimplantar otro antes de 20 años? (2) Si el marcapasos lleva funcionando correctamente 5 años en un paciente, ¿cuál es la probabilidad de que haya que cambiarlo antes de 25 años desde que se implantó?</p>
</div>
<p>Si <span class="math inline">\(T\)</span> es la variable aleatoria que indica el tiempo de vida del marcapasos tenemos que:</p>
<p><span class="math display">\[T \sim Exp(\lambda = 1/16)\]</span></p>
<p>Se puede reponder fácilmente a las preguntas planteadas sin más que hacer uso de la función <code><a href="https://rdrr.io/r/stats/Exponential.html">pexp()</a></code>. Sin embargo, también simularemos para aproximarlas. Hemos de calcular</p>
<p>(1). Si es preciso implantar antes de 20 años, es porque el tiempo de vida no va a ser superior a 20. Hemos de calcular pues, <span class="math inline">\(Pr(T \leq 20)\)</span>. (2). Nos piden <span class="math inline">\(Pr(T \leq 25|T&gt;5)=Pr(T\leq 20)\)</span>, por la propiedad de la pérdida de memoria. Es decir, respondiendo a (1) tendremos respondidas las dos preguntas formuladas.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">16</span>
<span class="co"># Data frame para la representación gráfica</span>
<span class="va">sec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="va">datos</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sec <span class="op">=</span> <span class="va">sec</span>, densidad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">dexp</a></span><span class="op">(</span><span class="va">sec</span>,<span class="va">lambda</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Gráfico función de densidad</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">sec</span>, <span class="va">densidad</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span>,<span class="fl">5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_extended.html">breaks_extended</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"Tiempo de vida del marcapasos (en años)"</span>, 
       y <span class="op">=</span> <span class="st">"Función de densidad"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-014"></span>
<img src="01-Probabilidad_files/figure-html/01-014-1.png" alt="Función de densidad del tiempo de vida del marcapasos (en años)" width="95%"><p class="caption">
Figura 1.5: Función de densidad del tiempo de vida del marcapasos (en años)
</p>
</div>
<p>Obtenemos la probabilidad deseada:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Probabilidad real</span>
<span class="va">lambda</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">16</span>
<span class="va">p</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">pexp</a></span><span class="op">(</span><span class="fl">20</span>,<span class="va">lambda</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(T&lt;=20)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(T&lt;=20)= 0.713</code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros de la simulación</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="co"># Simulaciones</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">lambda</span><span class="op">)</span>
<span class="co"># Probabilidad de interés</span>
<span class="va">pMC</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos</span> <span class="op">&lt;=</span> <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Aprox.MC[Pr(T&lt;=20)]="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pMC</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Aprox.MC[Pr(T&lt;=20)]= 0.711</code></pre>
<p>La probabilidad de que el marcapasos dure más de 20 años y haya que reemplazarlo es de 0.289, por lo que efectivamente, es muy recomendable reemplazarlo antes. Sin embargo, al paciente en la pregunta (2) se le daría la misma recomendación, cuando la probabilidad de que el marcapasos dure más de 25 años desde su implante, que sería el tiempo que lo llevaría, es considerablemente inferior, 0.21. No es pues recomendable, utilizar esta distribución para modelizar el tiempo de vida de un implante.</p>
<div class="example">
<p><span id="exm:exponencial02" class="example"><strong>Ejemplo 1.11  </strong></span>Un motor eléctrico tiene una vida media de 6 años y se modeliza con una distribución exponencial. ¿Cuál debe ser el tiempo de garantía que debe tener el motor si se desea que a lo sumo el 15 % de los motores fallen antes de que expire su garantía?</p>
</div>
<p>Si <span class="math inline">\(T\)</span> es la variable aleatoria que indica el tiempo de vida del producto tenemos que: <span class="math display">\[T \sim Exp(\lambda = 1/6).\]</span><br>
En este caso estamos interesados en encontrar el tiempo para que podamos garantizar que el 85% de los motores siguen funcionando, es decir, buscamos el cuantil 0.15 de la distribución de <span class="math inline">\(T\)</span>. Planteamos un análisis de simulación para estimar dicho valor.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculamos el valor real para el periodo de garantía</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>
<span class="va">q</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="va">lambda</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Periodo de garantía recomendado="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">q</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Periodo de garantía recomendado= 0.98</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros de la simulación</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="co"># simulaciones</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">lambda</span><span class="op">)</span>
<span class="co"># cuantil de interés</span>
<span class="va">qMC</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fl">0.15</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Periodo de garantía aproximado="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">qMC</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Periodo de garantía aproximado= 1.02</code></pre>
<p>Para que tan sólo el 15% de los motores necesiten reparación durante el periodo de garantía, debemos establecer una garantía de aproximadamente 1 año.</p>
<p>En la Figura <a href="intro.html#fig:01-016-2">1.6</a> se representan, para los datos simulados, los cuantiles aproximados versus su probabilidad asociada. Con el gráfico se puede atisbar también el periodo de garantía recomendado.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cuantil de interés</span>
<span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="va">cuantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">probs</span><span class="op">)</span>
<span class="va">datoscuan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">probs</span>, <span class="va">cuantiles</span><span class="op">)</span>
<span class="co"># Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datoscuan</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">probs</span>,<span class="va">cuantiles</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">probs</span>, labels <span class="op">=</span> <span class="va">probs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_extended.html">breaks_extended</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.15</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"Probabilidad"</span>, y <span class="op">=</span> <span class="st">"Tiempo a la reparación (en años)"</span><span class="op">)</span>  </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-016-2"></span>
<img src="01-Probabilidad_files/figure-html/01-016-2-1.png" alt="Tiempo de garantía recomendado en función de la probabilidad de que los motores necesiten reparación." width="95%"><p class="caption">
Figura 1.6: Tiempo de garantía recomendado en función de la probabilidad de que los motores necesiten reparación.
</p>
</div>
<p>Con esta gráfica podemos establecer el tiempo de garantía en función de las especificaciones de la empresa, es decir, fijando el porcentaje de motores que necesitarán reparación.</p>
</div>
<div id="gamma" class="section level3" number="1.4.3">
<h3>
<span class="header-section-number">1.4.3</span> Gamma<a class="anchor" aria-label="anchor" href="#gamma"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución Gamma, al igual que ocurre con la exponencial, se utiliza habitualmente para modelizar variables aleatorias positivas y asimétricas, y sobre todo para describir procesos de eventos que ocurren en el tiempo. La función de densidad de una variable aleatoria Gamma se caracteriza por dos parámetros: <span class="math inline">\(\alpha\)</span> o parámetro de forma, y <span class="math inline">\(\beta\)</span> o parámetro de escala. El parámetro de forma se denomina así porque al variar su valor se obtienen diferentes formas para la fdp. La variación del parámetro de escala no cambia la forma de la distribución, pero tiende a “estirar” o “comprimir” el rango de valores sobre el que se define la probabilidad.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vgamma" class="definition"><strong>Definición 1.15  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span>, con <span class="math inline">\(x \geq 0\)</span>, tiene una distribución Gamma de parámetros <span class="math inline">\(\alpha &gt; 0\)</span> y <span class="math inline">\(\beta &gt; 0\)</span>, denotada por</p>
<p><span class="math display">\[X \sim Ga(\alpha, \beta)\]</span></p>
<p>si su función de densidad viene dada por la expresión</p>
<p><span class="math display" id="eq:dgamma">\[\begin{equation}
f(x) = \frac{x^{\alpha -1} e^{-x/\beta}}{\beta^{\alpha} \Gamma(\alpha)}; \quad \text{ para } x \geq 0,
\tag{1.15}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(\Gamma()\)</span> la función gamma, de forma que <span class="math inline">\(E(X) = \alpha\beta\)</span> y <span class="math inline">\(V(X) = \alpha\beta^2.\)</span></p>
</div>
</div>
<p>Un caso especial de la distribución Gamma es la <strong>distribución Erlang</strong>, que se denota por <span class="math inline">\(X \sim Erlang(k, \beta)\)</span>, y que se utiliza habitualmente en la modelización de sistemas de colas de espera. Su función de densidad viene dada por :</p>
<p><span class="math display" id="eq:derlang">\[\begin{equation}
f(x) = \frac{k(kx)^{\alpha -1} e^{-xk/\beta}}{\beta^{k} (k-1)!}; \quad \text{ para } x \geq 0,
\tag{1.16}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(E(x) = \beta\)</span> y <span class="math inline">\(V(X) = \beta^2/k\)</span>. La utilidad de una variable aleatoria Erlang con parámetros <span class="math inline">\(k\)</span> y <span class="math inline">\(\beta\)</span> es que es el resultado de sumar <span class="math inline">\(k\)</span> variables aleatorias exponenciales (independientes) cada una con media <span class="math inline">\(\beta/k\)</span>. En la modelización de los tiempos relacionados con un proceso industrial, la distribución exponencial suele ser inadecuada porque la desviación estándar no es tan grande como la media. Los ingenieros suelen tratar de diseñar sistemas que produzcan una desviación estándar de los tiempos del proceso que resulte significativamente menor que su media. La distribución Erlang tiene esta propiedad: su desviación estándar disminuye a medida que aumenta <span class="math inline">\(k\)</span>, de modo que los tiempos de proceso con una desviación estándar pequeña a menudo suelen ser aproximados por una variable aleatoria Erlang.</p>
<div class="whitebox">
<ul>
<li>La función <code>dgamma(x, shape, scale)</code> nos permite evaluar la función de densidad para una variable Gamma.</li>
<li>
<code>pgamma(x, shape, scale)</code> calcula la función de distribución.</li>
<li>
<code>rgamma(n, shape, scale)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Gamma.</li>
</ul>
<p>Para simular un dato de una distribución <span class="math inline">\(y \sim (Erlang(k, \beta)\)</span>) generamos <span class="math inline">\(k\)</span> datos exponenciales de <span class="math inline">\(x_i \sim Exp(\beta/k), i=1,\ldots,k,\)</span> y calculamos la suma de todos esos valores,<span class="math inline">\(y=\sum_i x_i\)</span>. Repetir este proceso tantas veces como indique el tamaño de la muestra simulada que deseamos para la distribución Erlang.</p>
</div>
<p>Si disponemos de la media y varianza de los datos resulta muy fácil ajustar los parámetros de la distribución Gamma o Erlang sin más que resolver las ecuaciones que nos dan el valor esperado y la varianza. Si <span class="math inline">\(\bar{x}\)</span> y <span class="math inline">\(s^2\)</span> son respectivamente la media y varianza, podemos ajustar los parámetros de la Gamma con:</p>
<p><span class="math display">\[ \beta = s^2/\bar{x}; \quad \alpha = \bar{x}/\beta\]</span></p>
<p>mientras que para la Erlang tenemos:</p>
<p><span class="math display">\[ \beta = \bar{x}; \quad k = \bar{x}^2/s^2.\]</span></p>
<p>A continuación se presenta la función para generar datos Erlang a patir de datos exponenciales:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Función para generar "nsim" simulaciones de una Erlang </span>
<span class="co"># con parámetros k (entero) y beta&gt;0</span>
<span class="va">rerlang</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nsim</span>, <span class="va">k</span>, <span class="va">beta</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># verificamos que k es entero</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">k</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">1</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="co"># parámetro de la exponencial</span>
    <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">beta</span><span class="op">/</span><span class="va">k</span>
    <span class="co"># Generamos y almacenamos datos exponenciales</span>
    <span class="va">datosexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">*</span><span class="va">k</span>, <span class="va">lambda</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nsim</span><span class="op">)</span>
    <span class="co"># Obtenemos la muestra de la Erlang</span>
    <span class="va">datoserl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">datosexp</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">datoserl</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">else</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"k debe ser entero"</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="weibull" class="section level3" number="1.4.4">
<h3>
<span class="header-section-number">1.4.4</span> Weibull<a class="anchor" aria-label="anchor" href="#weibull"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución Weibull se utiliza para describir la resistencia a la rotura de diversos materiales o para describir los tiempos de fallo de muchos tipos de sistemas diferentes. La distribución Weibull tiene dos parámetros: un parámetro de escala, <span class="math inline">\(\beta\)</span> , y un parámetro de forma <span class="math inline">\(\alpha\)</span>, ambos positivos. La funcion de distribución asociada viene dada por:</p>
<p><span class="math display" id="eq:var-weibull2">\[\begin{equation}
F(x) = 
\begin{cases}
0 &amp; \text{ si } x &lt; 0 \\
1 - e^{-(x/\beta)^{\alpha}} &amp; \text{ si } x \geq 0
\end{cases}
\tag{1.17}
\end{equation}\]</span></p>
<p>Como en el caso de la distribución Gamma el parámetro de forma determina la forma general de la fdp y el parámetro de escala expande o contrae la fdp.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vweibull" class="definition"><strong>Definición 1.16  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span> tiene una distribución Weibull de parámetros <span class="math inline">\(\alpha&gt;0\)</span> y <span class="math inline">\(\beta&gt;0\)</span>, que se denota por</p>
<p><span class="math display">\[X \sim Weib(\alpha, \beta)\]</span></p>
<p>si su función de densidad viene dada por la expresión</p>
<p><span class="math display" id="eq:var-weibull">\[\begin{equation}
f(x)=\frac{\alpha}{\beta}\frac{x}{\beta}^{\alpha-1}e^{-(x/\beta)^{\alpha}}, \quad x \geq 0.
\tag{1.18}
\end{equation}\]</span></p>
<p>El valor esperado y la varianza vienen dados por:</p>
<p><span class="math display">\[E(X) = \beta \Gamma(1 + 1/\alpha); \quad V(X) = \beta^2 (\Gamma(1 + 2/\alpha) - (\Gamma(1 + 1/\alpha))^2).\]</span></p>
</div>
</div>
<p>En <code>R</code> tenemos las siguientes funciones relacionadas con la distribución Weibull.</p>
<div class="whitebox">
<ul>
<li>La función <code>dweibull(x, shape, scale)</code> nos permite evaluar la función de densidad para una variable Weibull</li>
<li>
<code>pweibull(x, shape, scale)</code> calcula la función de distribución.</li>
<li>
<code>rweibull(n, shape, scale)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Weibull.</li>
</ul>
</div>
<p>A partir de la media (<span class="math inline">\(\bar{x}\)</span>) y varianza (<span class="math inline">\(S^2\)</span>) de un conjunto de datos, es posible obtener los parámetros de la distribución Weibull sin más que resolver las ecuaciones:</p>
<p><span class="math display" id="eq:estimaweibuleq">\[\begin{eqnarray}
\beta &amp;=&amp; \frac{\bar{x}}{\Gamma(1 + 1/ \alpha)} \\
\frac{s^2}{\bar{x}^2} - \frac{\Gamma(1+ 2/\alpha)}{(\Gamma(1 + 1/ \alpha))^2} + 1 &amp;=&amp; 0.
\tag{1.19}
\end{eqnarray}\]</span></p>
<p>A continuación se propone una función que permite obtener los parámetros a partir de la media y varianza de los datos, junto con un pequeño ejemplo para verificar su funcionalidad.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">estima.weibull</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span>, <span class="va">s</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co">#m=media, s=desviación típica</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rootSolve</span><span class="op">)</span>
  <span class="co"># Función para optimizar alpha</span>
  <span class="va">fun.alpha</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">m</span>, <span class="va">s</span><span class="op">)</span>
              <span class="op">{</span>
                <span class="va">res</span><span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">s</span><span class="op">/</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="va">a</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
                <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
              <span class="op">}</span>
  <span class="co"># Obtención de alpha</span>
    <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html">uniroot</a></span><span class="op">(</span><span class="va">fun.alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10000</span><span class="op">)</span>,m<span class="op">=</span><span class="va">m</span>,s<span class="op">=</span><span class="va">s</span><span class="op">)</span><span class="op">$</span><span class="va">root</span>,<span class="fl">2</span><span class="op">)</span>
  <span class="co"># Obtención de beta</span>
  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">alpha</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="co"># Devolvemos alpha y beta</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Datos de ejemplo</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">80</span>     <span class="co"># media</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>  <span class="co"># desviación típica</span>
<span class="co"># Estimación</span>
<span class="va">res</span><span class="op">=</span><span class="fu">estima.weibull</span><span class="op">(</span><span class="va">m</span>,<span class="va">s</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Weibull alpha="</span>,<span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">", Weibull beta="</span>,<span class="va">res</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## Weibull alpha= 13.83 , Weibull beta= 83.06</code></pre>
</div>
<div id="normal" class="section level3" number="1.4.5">
<h3>
<span class="header-section-number">1.4.5</span> Normal<a class="anchor" aria-label="anchor" href="#normal"><i class="fas fa-link"></i></a>
</h3>
<p>La distribución normal es la distribución más común, reconocida por la mayoría de personas por su curva en forma de “campana,” y también llamada “campana de Gauss.” Aunque la distribución normal no se utiliza mucho en la modelización de procesos y sitemas, es sin duda, la más relevante de las distribuciones aleatorias, ya que representa el supuesto básico distribucional para resolver muchos de los problemas de inferencia estadística habituales, como veremos en la sección final de esta unidad.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:vnormal" class="definition"><strong>Definición 1.17  </strong></span>Una variable aleatoria <span class="math inline">\(X\)</span> tiene una distribución Normal de parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> con <span class="math inline">\(\sigma &gt;0\)</span>, denotada por</p>
<p><span class="math display">\[ X \sim N(\mu, \sigma^2),\]</span></p>
<p>si su función de densidad viene dada por</p>
<p><span class="math display">\[\begin{equation}
f(x) = \frac{1}{\sigma\sqrt{2\pi}} exp\left(\frac{-(x-\mu)^2}{2\sigma^2}\right), \quad x \in R
\end{equation}\]</span></p>
<p>con <span class="math inline">\(E(X) = \mu\)</span> y <span class="math inline">\(V(X) = \sigma^2\)</span>, y que se denota:</p>
</div>
</div>
<p>El parámetro <span class="math inline">\(\mu\)</span> identifica la media, y por lo tanto el centro de la distribución al ser simétrica, y el parámetro <span class="math inline">\(\sigma\)</span> la desviación típica.</p>
<p>El caso más destacado es la denominada distribución <strong>Normal estándar</strong>, para la que <span class="math inline">\(\mu = 0\)</span> y <span class="math inline">\(\sigma = 1\)</span>, por su utilización en problemas inferenciales sencillos donde la variabilidad es conocida.</p>
<p>A partir de cualquier distribución Normal podemos transformar a una distribución Normal estándar. Si <span class="math inline">\(X \sim N(\mu, \sigma^2)\)</span> entonces la variable aleatoria <span class="math inline">\(Z\)</span> definida como</p>
<p><span class="math display">\[Z = \frac{X - \mu}{\sigma} \sim N(0,1).\]</span></p>
<p>Vinculadas a la distribución Normal surgen las distribuciones <span class="math inline">\(t\)</span> de Student, <strong>Chi-chadrado</strong> y <span class="math inline">\(F\)</span> de Snedecor (también llamada de Fisher-Snedecor), que son ampliamente utilizadas en inferencia estadística. En el último apartado de esta unidad veremos cómo utilizar estas distrbuciones para resolver mediante simulación problemas de intervalos de confianza o contrastes de hipótesis.</p>
<p>Si <span class="math inline">\(\bar{X_n}=\sum_i X_i/n\)</span> representa la media muestral de <span class="math inline">\(n\)</span> v.a. <span class="math inline">\(N(\mu,\sigma)\)</span> y <span class="math inline">\(S^2=\sum_i(X_i-\bar{X_n})^2/(n-1)\)</span> su varianza muestral, entonces la variable <span class="math inline">\(Y\)</span> <span class="math display">\[ Y= \frac{\bar{X_n}-\mu}{S/\sqrt{n}}\sim St(n-1)\]</span> sigue una distribución t de Student con <span class="math inline">\(n-1\)</span> grados de libertad, y se denota por <span class="math inline">\(Y\sim St(n-1)\)</span>.</p>
<p>Si tenemos un conjunto de variables normales estándar independientes, <span class="math inline">\(X_i\sim N(0,1), i=1,\ldots,n\)</span>, entonces su suma al cuadrado sigue una distribución chi-cuadrado con <span class="math inline">\(n\)</span> grados de libertad. <span class="math display">\[Z=\sum_{i=1}^n X_i^2 \sim \chi^2_{n}\]</span> Por último, a partir de dos distribuciones chi-cuadrado independientes, <span class="math inline">\(U\sim \chi^2_n\)</span> y <span class="math inline">\(V\sim \chi^2_m\)</span>, tenemos que su cociente, corregido por sus grados de libertad, sigue una distribución F de Snedecor con <span class="math inline">\(n\)</span> y <span class="math inline">\(m\)</span> grados de libertad, <span class="math display">\[ W=\frac{U/n}{V/m} \sim F_{(n,m)}.\]</span></p>
<div class="whitebox">
<p>Para la distribución Normal,</p>
<ul>
<li>La función <code>dnorm(x, mean, sd)</code> nos permite evaluar la función de densidad para una variable Normal.</li>
<li>
<code>pnorm(x, mean, sd)</code> calcula la función de distribución.</li>
<li>
<code>rnorm(n, mean, sd)</code> permite generar <span class="math inline">\(n\)</span> valores de una variable Normal.</li>
</ul>
<p>Para la distribución t de Student con <span class="math inline">\(df1\)</span> grados de libertad, las funciones correspondientes son <code>dt(x, df1)</code>, <code>pt(x, df1)</code> y <code>rt(n,df1)</code>.</p>
<p>Para la distribución chi-cuadrado con <span class="math inline">\(df1\)</span> grados de libertad, contamos con las funciones <code>dchisq(x,df1)</code>, <code>pchisq(x,df1)</code> y <code>rchisq(n,df1)</code> respectivamente.</p>
<p>Para la distribución F de Snedecor con <span class="math inline">\(df1\)</span> y <span class="math inline">\(df2\)</span> grados de libertad, tenemos las correspondencias <code>df(x, df1, df2)</code>, <code>pf(x, df1, df2)</code> y <code>rf(n,df1,df2)</code>.</p>
</div>
<p>En la Figura <a href="intro.html#fig:graficosnormal">1.7</a> aparecen representadas varias distribuciones normales con distinta media y varianza.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">0.1</span><span class="op">)</span>
<span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">y3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">y4</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as.tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y1</span>,<span class="va">y2</span>,<span class="va">y3</span>,<span class="va">y4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: `as.tibble()` was deprecated in tibble 2.0.0.
## Please use `as_tibble()` instead.
## The signature and semantics have changed, see `?as_tibble`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">levels</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"N(0,1)"</span><span class="op">=</span><span class="st">"y1"</span>,<span class="st">"N(0,3)"</span><span class="op">=</span><span class="st">"y2"</span>,<span class="st">"N(2,1)"</span><span class="op">=</span><span class="st">"y3"</span>,<span class="st">"N(2,3)"</span><span class="op">=</span><span class="st">"y4"</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,names_to<span class="op">=</span><span class="st">"tipo"</span>,values_to<span class="op">=</span><span class="st">"valor"</span><span class="op">)</span> 
<span class="va">datos</span><span class="op">$</span><span class="va">tipo</span><span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">tipo</span>,<span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">levels</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">valor</span>,color<span class="op">=</span><span class="va">tipo</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Distribuciones"</span>,y<span class="op">=</span><span class="st">"Función de densidad"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graficosnormal"></span>
<img src="01-Probabilidad_files/figure-html/graficosnormal-1.png" alt="Funciones de densidad para varias distribuciones normales." width="95%"><p class="caption">
Figura 1.7: Funciones de densidad para varias distribuciones normales.
</p>
</div>
<p>En la Figura <a href="intro.html#fig:graficost">1.8</a> aparecen representadas varias distribuciones t de Student con distintos grados de libertad.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">0.1</span><span class="op">)</span>
<span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">y3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">y4</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as.tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y1</span>,<span class="va">y2</span>,<span class="va">y3</span>,<span class="va">y4</span><span class="op">)</span><span class="op">)</span>
<span class="va">levels</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"St(2)"</span><span class="op">=</span><span class="st">"y1"</span>,<span class="st">"St(5)"</span><span class="op">=</span><span class="st">"y2"</span>,<span class="st">"St(10)"</span><span class="op">=</span><span class="st">"y3"</span>,<span class="st">"N(0,1)"</span><span class="op">=</span><span class="st">"y4"</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,names_to<span class="op">=</span><span class="st">"tipo"</span>,values_to<span class="op">=</span><span class="st">"valor"</span><span class="op">)</span> 
<span class="va">datos</span><span class="op">$</span><span class="va">tipo</span><span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">tipo</span>,<span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">levels</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">valor</span>,color<span class="op">=</span><span class="va">tipo</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Distribuciones"</span>,y<span class="op">=</span><span class="st">"Función de densidad"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graficost"></span>
<img src="01-Probabilidad_files/figure-html/graficost-1.png" alt="Funciones de densidad para varias distribuciones T de Student." width="95%"><p class="caption">
Figura 1.8: Funciones de densidad para varias distribuciones T de Student.
</p>
</div>
<p>En la Figura <a href="intro.html#fig:graficoschi2">1.9</a> aparecen representadas varias distribuciones chi-cuadrado con distintos grados de libertad.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>,<span class="fl">0.1</span><span class="op">)</span>
<span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">dchisq</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">dchisq</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">y3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">dchisq</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">50</span><span class="op">)</span>
<span class="va">y4</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">dchisq</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">100</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as.tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y1</span>,<span class="va">y2</span>,<span class="va">y3</span>,<span class="va">y4</span><span class="op">)</span><span class="op">)</span>
<span class="va">levels</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chi2(5)"</span><span class="op">=</span><span class="st">"y1"</span>,<span class="st">"Chi2(10)"</span><span class="op">=</span><span class="st">"y2"</span>,<span class="st">"Chi2(50)"</span><span class="op">=</span><span class="st">"y3"</span>,<span class="st">"Chi2(100)"</span><span class="op">=</span><span class="st">"y4"</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,names_to<span class="op">=</span><span class="st">"tipo"</span>,values_to<span class="op">=</span><span class="st">"valor"</span><span class="op">)</span> 
<span class="va">datos</span><span class="op">$</span><span class="va">tipo</span><span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">tipo</span>,<span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">levels</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">valor</span>,color<span class="op">=</span><span class="va">tipo</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Distribuciones"</span>,y<span class="op">=</span><span class="st">"Función de densidad"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graficoschi2"></span>
<img src="01-Probabilidad_files/figure-html/graficoschi2-1.png" alt="Funciones de densidad para varias distribuciones Chi-cuadrado." width="95%"><p class="caption">
Figura 1.9: Funciones de densidad para varias distribuciones Chi-cuadrado.
</p>
</div>
<p>En la Figura <a href="intro.html#fig:graficosf">1.10</a> aparecen representadas varias distribuciones F de Snedecor con distintos grados de libertad.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">0.01</span><span class="op">)</span>
<span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">df</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">df</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">y3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">df</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">50</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">y4</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">df</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">100</span>,<span class="fl">200</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as.tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y1</span>,<span class="va">y2</span>,<span class="va">y3</span>,<span class="va">y4</span><span class="op">)</span><span class="op">)</span>
<span class="va">levels</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F(5,5)"</span><span class="op">=</span><span class="st">"y1"</span>,<span class="st">"F(1,5)"</span><span class="op">=</span><span class="st">"y2"</span>,<span class="st">"F(50,10)"</span><span class="op">=</span><span class="st">"y3"</span>,<span class="st">"F(100,200)"</span><span class="op">=</span><span class="st">"y4"</span><span class="op">)</span>
<span class="va">datos</span><span class="op">=</span><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,names_to<span class="op">=</span><span class="st">"tipo"</span>,values_to<span class="op">=</span><span class="st">"valor"</span><span class="op">)</span> 
<span class="va">datos</span><span class="op">$</span><span class="va">tipo</span><span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">tipo</span>,<span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">levels</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">valor</span>,color<span class="op">=</span><span class="va">tipo</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Distribuciones"</span>,y<span class="op">=</span><span class="st">"Función de densidad"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graficosf"></span>
<img src="01-Probabilidad_files/figure-html/graficosf-1.png" alt="Funciones de densidad para varias distribuciones F-Snedecor." width="95%"><p class="caption">
Figura 1.10: Funciones de densidad para varias distribuciones F-Snedecor.
</p>
</div>
</div>
</div>
<div id="transformadainversa" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Simular con la Transformada Inversa<a class="anchor" aria-label="anchor" href="#transformadainversa"><i class="fas fa-link"></i></a>
</h2>
<p>Aunque las distribuciones estudiadas en el punto anterior, al ser habituales provocan que los algoritmos de simulación y sus funciones de probabilidad ya estén implementadas en la mayoría de los paquetes estadísticos y de cálculo, en otras ocasiones, ante otras distribuciones menos comunes, no disponemos de un método directo para la simulación de muestras aleatorias, y necesitamos recurrir a algoritmos genéricos de simulación de variables.</p>
<p>Presentamos a continuación un algoritmo genérico para simular de variables discretas o continuas definidas a trozos: el <strong>algoritmo de la transformada inversa</strong>, que pasamos a describir, tanto para variables continuas como para variables discretas.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:aticontinua" class="definition"><strong>Definición 1.18  </strong></span><strong>Algoritmo de la transformada inversa para variables continuas</strong></p>
<p>Dada una variable aleatoria <span class="math inline">\(X\)</span> de tipo continuo, cuya función de distribución viene dada por <span class="math inline">\(F(x)\)</span>, y cuya función de distribución inversa se denota por <span class="math inline">\(F^{-1}(x)\)</span>, el algoritmo de la transformada inversa permite obtener una muestra de tamaño <span class="math inline">\(n\)</span> de la variable <span class="math inline">\(X\)</span> mediante el siguiente procedimiento:</p>
<ul>
<li>Generar <span class="math inline">\(n\)</span> valores uniformes en el intervalo <span class="math inline">\([0,1]\)</span>,</li>
</ul>
<p><span class="math display">\[u_i\sim U(0,1), \quad i=1,...,n\]</span></p>
<ul>
<li>Devolver <span class="math inline">\(x_i = F^{-1}(u_i)\)</span>.</li>
</ul>
<p>Así los valores <span class="math inline">\(\{x_1,...,x_n\}\)</span> constituyen una muestra de <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<p>El algoritmo es conceptualmente similar para variables discretas, si bien por la discretización, varía levemente.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:atidiscreta" class="definition"><strong>Definición 1.19  </strong></span><strong>Algoritmo de la transformada inversa para variables discretas</strong></p>
<p>Dada una variable aleatoria <span class="math inline">\(X\)</span>, de tipo discreto, con <span class="math inline">\(k\)</span> posibles valores diferentes <span class="math inline">\(x_1,...,x_k\)</span>, y cuya función de distribución viene dada por:</p>
<p><span class="math display">\[F(x) = Pr(X \leq x) = \sum_{x_i \leq x} Pr(X = x_i), i=1,...,k,\]</span></p>
<p>el algoritmo de la transformada inversa permite obtener una muestra de tamaño <span class="math inline">\(n\)</span> de la variable <span class="math inline">\(X\)</span> mediante el siguiente procedimiento:</p>
<ul>
<li>Generar <span class="math inline">\(n\)</span> valores uniformes en el intervalo <span class="math inline">\([0,1]\)</span>, <span class="math display">\[u_i\sim U(0,1), \quad i=1,...,n\]</span>
</li>
<li>Para cada <span class="math inline">\(u_i\)</span> generado se determina el entero <span class="math inline">\(I\)</span> más pequeño que satisface <span class="math inline">\(u_i \leq F(x_I)\)</span>, del conjunto <span class="math inline">\(\{x_1,...,x_k\}\)</span>
</li>
<li>Devolver <span class="math inline">\(x_I\)</span> para cada valor simulado.</li>
</ul>
<p>Así los valores <span class="math inline">\(\{x_1,...,x_n\}\)</span> constituyen una muestra de <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<p>En los puntos siguientes vamos a mostrar el uso de los algoritmos <a href="intro.html#def:aticontinua">1.18</a> y <a href="intro.html#def:atidiscreta">1.19</a> en diferentes ejemplos de variables de tipo discreto y continuo.</p>
</div>
<div id="otras-distribuciones-discretas" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Otras distribuciones discretas<a class="anchor" aria-label="anchor" href="#otras-distribuciones-discretas"><i class="fas fa-link"></i></a>
</h2>
<p>Analizamos diferentes ejemplos en los que estamos interesados en evaluar un sistema que involucra a una o más variables de tipo discreto, y donde únicamente disponemos de información sobre la función de masa de probabilidad o sobre la función de distribución.</p>
<div id="una-variable-discreta" class="section level3" number="1.6.1">
<h3>
<span class="header-section-number">1.6.1</span> Una variable discreta<a class="anchor" aria-label="anchor" href="#una-variable-discreta"><i class="fas fa-link"></i></a>
</h3>
<p>Supongamos un sistema en el que contamos con información de una única variable discreta de interés que deseamos estudiar. En los casos más sencillos que tratamos aquí, las situaciones planteadas se pueden resolver teóricamente sin mucha dificultad, pero el objetivo es mostrar el uso de la simulación para llegar a resultados aproximados a los que proporcionan los métodos análiticos.</p>
<div class="example">
<p><span id="exm:discreta1" class="example"><strong>Ejemplo 1.12  </strong></span>Una empresa que fabrica piezas para maquinaria de fabricación de calzado tiene diseñada la cadena de producción de tal forma que las piezas fabricadas se almacenan (y venden) en cajas de dos unidades. El beneficio estimado de una caja sin defectos es de 300 euros. La política de la empresa establece que si al servir una caja a los clientes, esta contiene una pieza defectuosa, debe ser devuelta de forma inmediata para su reemplazo, lo que supone una pérdida de 50 euros por pieza defectuosa (y la devolución de los 300 euros de beneficio por la venta). El problema es que una vez cerradas las cajas en la cadena de producción no se inspeccionan para estimar el número de cajas que se podrían devolver. La única información disponible hace referencia a la tasa de defectos observada en cada caja cuando esta es devuelta, junto con el porcentaje de cajas que son devueltas. En base a esta información, si <span class="math inline">\(N\)</span> refleja el número de piezas defectuosas observadas, la empresa ha establecido que:</p>
<p><span class="math display" id="eq:var-discreta1">\[\begin{equation}
Pr(N = k) = 
\begin{cases}
0.82 &amp; \text{ para } k = 0\\
0.15 &amp; \text{ para } k = 1\\
0.03 &amp; \text{ para } k = 2\\
\end{cases}
\tag{1.20}
\end{equation}\]</span></p>
<p>La empresa quiere estudiar el beneficio estimado de acuerdo a la politica de producción actual para el próximo mes, sabiendo que se pueden llegar a producir hasta 1500 cajas en ese periodo. Además la empresa está interesada en conocer el beneficio estimado si cambiara su politica de calidad reduciendo su tasa de defectos por caja de acuerdo a las siguientes proporciones:</p>
<p><span class="math display" id="eq:var-discreta1-1">\[\begin{equation}
Pr(N = k) = 
\begin{cases}
0.85 &amp; \text{ para } k = 0\\
0.13 &amp; \text{ para } k = 1\\
0.02 &amp; \text{ para } k = 2\\
\end{cases}
\tag{1.21}
\end{equation}\]</span></p>
</div>
<p>Para resolver las inquietudes de la empresa, vamos a simular el proceso en las dos situaciones planteadas, para el horizonte propuesto de un mes, esto es, simulando las 1500 cajas y estimando el beneficio obtenido de acuerdo a las políticas de calidad dadas en <a href="intro.html#eq:var-discreta1">(1.20)</a> y <a href="intro.html#eq:var-discreta1-1">(1.21)</a>.</p>
<p>Proponemos el siguiente algoritmo de simulación para obtener la ganancia asociada a cada una de las políticas de calidad, y con dichas ganancias compararlas y concluir cuál es la más beneficiosa.</p>
<div class="silverbox">
<p><strong>Algoritmo de simulación</strong> Ante una política de calidad:</p>
<ol style="list-style-type: decimal">
<li>Fijar las condiciones de simulación: nº cajas (<span class="math inline">\(nsim = 1500\)</span>).</li>
<li>Obtener las función de distribución acumulada vinculada con la politica de calidad de interés y aplicar el algoritmo dado en al definición <a href="intro.html#def:atidiscreta">1.19</a> para obtener una muestra de <span class="math inline">\(N\)</span>, <span class="math inline">\(x_1,...,x_n\)</span>, relativas al número de piezas defectuosas en cada caja.</li>
<li>Calcular el beneficio obtenido para cada caja, vinculado a cada valor <span class="math inline">\(x_i\)</span>, denominado <span class="math inline">\(b_i\)</span>.</li>
<li>Obtener la ganancia global con todas las cajas simuladas como:</li>
</ol>
<p><span class="math display">\[G = \sum_{i=1}^n b_i\]</span></p>
</div>
<p>Lancemos el algoritmo para cada situación y obtengamos los beneficios esperados.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros de la simulación</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1500</span>
<span class="co"># datos uniformes</span>
<span class="va">unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>
<span class="co"># Valores a devolver (piezas defectuosas por caja)</span>
<span class="va">valores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co"># Valores a devolver y probabilidad acumulada para la política 1</span>
<span class="va">prob1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.82</span>, <span class="fl">0.15</span>, <span class="fl">0.03</span><span class="op">)</span>
<span class="va">probacum1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">prob1</span><span class="op">)</span>
<span class="co"># Valores a devolver y probabilidad acumulada para la política 2</span>
<span class="va">prob2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.13</span>, <span class="fl">0.02</span><span class="op">)</span>
<span class="va">probacum2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">prob2</span><span class="op">)</span>
<span class="co"># Inicialización de variables donde almacenamos las simulaciones</span>
<span class="va">xs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>; <span class="va">benef1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">xs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>; <span class="va">benef2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Simulación de la variable de interés</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="va">nsim</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># politica 1</span>
  <span class="va">xs1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">valores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">unif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">probacum1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
  <span class="va">benef1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xs1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="op">-</span><span class="fl">50</span><span class="op">*</span><span class="va">xs1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># beneficios</span>
  <span class="co"># politica 2</span>
  <span class="va">xs2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">valores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">unif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">probacum2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>  
  <span class="va">benef2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xs2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="op">-</span><span class="fl">50</span><span class="op">*</span><span class="va">xs2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="co"># nueva simulación</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="co"># Resultados para las nsim simulaciones</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>defec.s1 <span class="op">=</span> <span class="va">xs1</span>, benef.s1 <span class="op">=</span> <span class="va">benef1</span>, 
                         defec.s2 <span class="op">=</span> <span class="va">xs2</span>, benef.s2 <span class="op">=</span> <span class="va">benef2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Una muestra de las simulaciones realizadas es ...\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## Una muestra de las simulaciones realizadas es ...</code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span></code></pre></div>
<pre><code>##   defec.s1 benef.s1 defec.s2 benef.s2
## 1        0      300        0      300
## 2        0      300        0      300
## 3        0      300        0      300
## 4        0      300        0      300
## 5        0      300        0      300
## 6        0      300        0      300</code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Rendimientos globales</span>
<span class="va">beneficios</span><span class="op">=</span><span class="va">simulacion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>G1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">benef.s1</span><span class="op">)</span>, G2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">benef.s2</span><span class="op">)</span>, 
                         Dif <span class="op">=</span> <span class="va">G2</span> <span class="op">-</span> <span class="va">G1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Beneficios S1 (€):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">G1</span>,
    <span class="st">"Beneficios S2 (€):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">G2</span>,
    <span class="st">"Diferencia S2-S1 (€):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">Dif</span><span class="op">)</span></code></pre></div>
<pre><code>## Beneficios S1 (€): 350950 Beneficios S2 (€): 367200 Diferencia S2-S1 (€): 16250</code></pre>
<p>En consecuencia, se aprecia cómo una leve mejora de la calidad en la producción (reduciendo la tasa de defectos) proporciona a la empresa una ganancia sustancial, por lo que la política S2 sin duda es la más ventajosa para su negocio.</p>
<div class="example">
<p><span id="exm:discreta2" class="example"><strong>Ejemplo 1.13  </strong></span>Una empresa de inversiones está considerando tres nuevos planes de inversión. Cada plan requiere una inversión de 25.000 dólares y el retorno será un año después. El plan A retornará de forma fija 27.500 dólares. El plan B retornará 27.000 dólares o 28.000 dólares, con probabilidades 0.4 y 0.6, respectivamente. El plan C retornará 24.000, 27.000 o 33.000 dólares con probabilidades de 0.2, 0.5 y 0.3, respectivamente. Si el objetivo de la empresa es maximizar el rendimiento esperado, ¿qué plan debería elegir?</p>
</div>
<p>Hay que tener en cuenta que en este caso no sólo es relevante el rendimiento esperado, sino también la volatilidad esperada para ese beneficio, expresada en términos de variabilidad o incertidumbre. Será pues interesante, calcular el rendimiento o el retorno esperado en cada situación, además de su varianza o desviación típica.</p>
<p>Vamos a plantear un proceso de simulación para estimar los beneficios y volatilidad asociadas a cada plan. Fijaremos el mismo número de simulaciones en cada plan, con el fin de hacer comparables los resultados. El algoritmo se presenta a continuación.</p>
<div class="silverbox">
<p><strong>Algoritmo de simulación</strong></p>
<ol style="list-style-type: decimal">
<li>Fijar condiciones de simulación (<span class="math inline">\(nsim = 1000\)</span>)</li>
<li>Obtener la función de distribución acumulada vinculada con cada uno de los planes de inversión y aplicar el algoritmo dado en la definición <a href="intro.html#def:atidiscreta">1.19</a> para obtener una muestra de cada uno de ellos.</li>
<li>Calcular el beneficio obtenido para cada simulación en cada plan.</li>
<li>Obtener la ganancia estimada de cada plan como la media de los beneficios obtenidos para cada simulación, y la volatilidad como la desviación típica de los beneficios obtenidos.</li>
</ol>
</div>
<p>Y procedemos con la simulación, calculando el beneficio esperado y la desviación típica en cada plan de inversión. Considerando que el plan A no tiene incertidumbre alguna (<em>Varianza=0</em>) y el beneficio fijo que generará será de $2500, no lo incluimos en la simulación.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros de la simulación</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1970</span><span class="op">)</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="co"># datos uniformes</span>
<span class="va">unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>
<span class="co"># Beneficios asociados a cada plan</span>
<span class="va">BpB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">3000</span><span class="op">)</span>  <span class="co"># beneficio variable</span>
<span class="va">BpC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">8000</span><span class="op">)</span> <span class="co"># beneficio variable</span>
<span class="co"># Distribuciones de probabilidiad para los planes B y C</span>
<span class="va">probB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>
<span class="va">probacumB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">probB</span><span class="op">)</span> <span class="co"># función de distribución plan B</span>
<span class="va">probC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>
<span class="va">probacumC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">probC</span><span class="op">)</span> <span class="co"># función de distribución plan </span>
<span class="co"># Inicialización de variables donde almacenamos las beneficios </span>
<span class="co"># individuales para cada simulación</span>
<span class="va">benefB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">benefC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Simulación de la variable de interés</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="va">nsim</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># plan B</span>
  <span class="va">benefB</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">BpB</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">unif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">probacumB</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
  <span class="co"># plan C</span>
  <span class="va">benefC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">BpC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">unif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">probacumC</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>  
  <span class="co"># nueva simulación</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="co"># Resultado</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2500</span>,<span class="va">nsim</span><span class="op">)</span>,B <span class="op">=</span> <span class="va">benefB</span>, C <span class="op">=</span> <span class="va">benefC</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Una muestra de las simulaciones realizadas es ...\n"</span><span class="op">)</span></code></pre></div>
<pre><code>## Una muestra de las simulaciones realizadas es ...</code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span></code></pre></div>
<pre><code>##      A    B     C
## 1 2500 2000 -1000
## 2 2500 3000  8000
## 3 2500 2000 -1000
## 4 2500 2000 -1000
## 5 2500 3000  8000
## 6 2500 3000  8000</code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beneficios</span><span class="op">=</span><span class="va">simulacion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mPB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>, sdPB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>, 
            mPC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span>, sdPC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Beneficios PlanA ($):"</span>,<span class="fl">2500</span>,
    <span class="st">"Volatilidad (sd):"</span>,<span class="fl">0</span>,
   <span class="st">"Beneficios PlanB ($):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">mPB</span>,
    <span class="st">"Volatilidad (sd):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">sdPB</span>,
    <span class="st">"Beneficios PlanC ($):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">mPC</span>, 
    <span class="st">"Volatilidad (sd):"</span>,<span class="va">beneficios</span><span class="op">$</span><span class="va">sdPC</span><span class="op">)</span></code></pre></div>
<pre><code>## Beneficios PlanA ($): 2500 Volatilidad (sd): 0 Beneficios PlanB ($): 2604 Volatilidad (sd): 489.3091 Beneficios PlanC ($): 3122 Volatilidad (sd): 3315.435</code></pre>
<p>Podemos ver que aunque el plan C es el que proporcioanrá más retorno esperado, también es el que tiene una mayor volatilidad (sd), lo que produce incertidumbre y podría repercutir en una mayor pérdida al final del periodo de inversión. El plan A tiene un beneficio fijo sin volatilidad ninguna, pero es inferior al beneficio del plan B. A efetos estadísticos, ya que la volatilidad (desviación típica) del plan B toma un valor inferior a la media, el coeficiente de variación (<span class="math inline">\(cv=sd/media\)</span>) resulta inferior a 1, y en consecuencia da una alternativa razonable al plan A. Por contra, no ocurre así en el plan C (<span class="math inline">\(cv&gt;1\)</span>) lo que lo coloca en una situación de inferioridad frente a los otros planes de inversión.</p>
<p>Con el fin de afinar en nuestra comparación de los tres planes de inversión, no nos vamos a conformar con valores esperados y desviaciones típicas, y vamos a calcular la probabilidad de que beneficio obtenido sea mayor a 2500 dólares con cada plan, cálculo que podemos resolver fácilmente a partir de las simulaciones obtenidas.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Probabilidad beneficio &gt; 2500</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>prA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">A</span><span class="op">&gt;</span><span class="fl">2500</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>, 
  prB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">B</span><span class="op">&gt;</span><span class="fl">2500</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>, 
  prC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">C</span><span class="op">&gt;</span><span class="fl">2500</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></code></pre></div>
<pre><code>##   prA   prB   prC 
## 0.000 0.604 0.289</code></pre>
<p>Con este cálculo, el plan B sale claramente reforzado, con una probabilidad destacable de generar un beneficio superior a $2500 (prob=0.6), frente al plan A (prob=0) y al C (prob=0.29). El plan A no puede superar unos rendimientos superiores a 2500, al ser este valor su fijo.</p>
</div>
<div id="mixturas-de-discretas" class="section level3" number="1.6.2">
<h3>
<span class="header-section-number">1.6.2</span> Mixturas de Discretas<a class="anchor" aria-label="anchor" href="#mixturas-de-discretas"><i class="fas fa-link"></i></a>
</h3>
<p>Estas situaciones son muy habituales e involucran la combinación de diferentes variables de tipo discreto en un mismo sistema, en lo que se viene a denominar <strong>mixtura de variables aleatorias de tipo discreto</strong> o <strong>modelos secuenciales</strong>. Sobre este tipo de distribuciones resulta bastante sencillo plantear un algoritmo de simulación. Antes de comenzar veamos desde un punto de vista téorico el concepto de <strong>mixtura de variables</strong>.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:mixturadiscreta" class="definition"><strong>Definición 1.20  </strong></span>Sean <span class="math inline">\(X_1, X_2,...,X_n\)</span> un conjunto de variables aleatorias independientes de tipo discreto y sea <span class="math inline">\(I\)</span> una variable indicador de tipo discreto, definida en los valores <span class="math inline">\(\{1,..., n\}\)</span>, tal que <span class="math display">\[Pr(I=j)=p_j, j=1,..., n, \quad \sum_{j=1}^n p_j = 1.\]</span></p>
<p>La variable aleatoria <span class="math inline">\(T\)</span> que se define como:</p>
<p><span class="math display">\[ T = \sum_{j =1}^n p_j X_j\]</span></p>
<p>se denomina mixtura del conjunto <span class="math inline">\(X_1,...,X_n\)</span> con índice <span class="math inline">\(I\)</span>, y además cumple que:</p>
<p><span class="math display">\[E(T) = \sum_{j=1}^n p_j E(X_j)\]</span></p>
<p><span class="math display">\[E(T^2) = \sum_{j=1}^n p_j (V(X_j) + E(X_j)^2).\]</span></p>
<p>Así, la varianza de <span class="math inline">\(T\)</span> se puede calcular fácilmente a partir de la expresión:</p>
<p><span class="math display">\[V(T) = E(T^2) - E(T)^2\]</span></p>
</div>
</div>
<p>El algoritmo para simular de una mixtura es bastante sencillo y se basa en la aplicación consecutiva en dos pasos del algoritmo de la transformada inversa para variables discretas en la Definición <a href="intro.html#def:atidiscreta">1.19</a>.</p>
<div class="silverbox">
<div class="definition">
<p><span id="def:mixturadiscreta" class="definition"><strong>Definición 1.20  </strong></span><strong>Algoritmo simulación mixtura variables discretas</strong></p>
<p>En la situación descrita en la definición <a href="intro.html#def:mixturadiscreta">1.20</a> el algoritmo para generar una muestra de la mixtura debe proporcioanr en cada simulación un vector de dos componentes: variable seleccionada (<span class="math inline">\(I\)</span>) y valor generado de <span class="math inline">\(X_I\)</span>. En concreto:</p>
<ul>
<li>Paso 1. Establecer el tamaño de muestra a simular <span class="math inline">\(nsim\)</span>.</li>
</ul>
<p>Repetir los pasos 2 y 3 para cada iteración <span class="math inline">\(i\)</span> de <span class="math inline">\(1, 2,..., nsim\)</span>:</p>
<ul>
<li><p>Paso 2. Simular un valor para el indicador <span class="math inline">\(I_i\)</span> de la variable de mixtura, mediante el algoritmo de la transformada inversa para una variable discreta (Definición <a href="intro.html#def:atidiscreta">1.19</a>) con probabilidades <span class="math inline">\(p_1,...,p_n\)</span>, y seleccionar la variable <span class="math inline">\(X_{I_i}\)</span> para dicho indicador.</p></li>
<li><p>Paso 3. Simular un valor <span class="math inline">\(x_{I_i}\)</span> mediante el algoritmo de la transformada inversa para <span class="math inline">\(X_i\)</span>.</p></li>
<li><p>Paso 4. Devolver el conjunto de simulaciones <span class="math inline">\(\{I_i, x_{I_i}\}_{i=1}^{nsim}.\)</span></p></li>
</ul>
</div>
</div>
<p>Pasamos a estudiar un par de ejemplos de situaciones secuenciales para variables discretas que se pueden modelizar según una mixtura y donde podemos aplicar el algoritmo anterior.</p>
<div class="example">
<p><span id="exm:mixtura1" class="example"><strong>Ejemplo 1.14  </strong></span>Una tienda de electrodomésticos desea analizar las ventas de hornos microondas. Los gerentes de la tienda saben que en muchas ocasiones la gente entra en la tienda simplemente para curiosear, pero de todas las personas con intenciones claras de compra, el 50% acaba comprando uno de los tres modelos disponibles y el otro 50% finalmente no realiza ninguna compra. De los clientes que compran un horno, el 25% adquiere el modelo sencillo, el 50% el modelo estándar y el 25% el modelo de lujo. El modelo sencillo produce una ganancia de 30 dólares; el modelo estándar produce una ganancia de 60 dólares y el modelo de lujo produce una ganancia de 75 dólares.</p>
<p>Los gerentes están interesados en estimar el beneficio medio por cliente de todos aquellos con intención de comprar, y que por tanto utilizan el asesoramiento (y tiempo) de los vendedores.</p>
</div>
<p>El enfoque habitual para estimar el beneficio promedio sería mantener registros de todos los clientes que hablan con los vendedores y calcular con esos datos una estimación del beneficio esperado por cliente. Sin embargo, este proceso puede ser simulado sin mucha dificultad a partir de la información proporcionada, para estimar, por ejemplo, el beneficio promedio por cliente para los próximos cien clientes.</p>
<p>Este proceso se puede describir mediante una mixtura con dos variables <span class="math inline">\(X_0\)</span> y <span class="math inline">\(X_1\)</span> que expresan cuál es el beneficio que genera un cliente que entra en la tienda, mediante una variable indicador <span class="math inline">\(I\)</span>, que identifica si un cliente está interesado o no en comprar.</p>
<p>Sea <span class="math inline">\(X_i\)</span> la ganancia generada por cada cliente que entra a la tienda, para cada uno de los tipos de cliente: 0=no compra, 1=sí compra: <span class="math display">\[X_i, \quad i=0,1\]</span></p>
<p>La probabilidad de que un cliente compre o no viene dada por: <span class="math display">\[\begin{equation*}
Pr(I = i)=
\begin{cases}
0.5 &amp; i=1 \text{ (si compra)} \\
0.5 &amp; i=0 \text{ (si no compra) }
\end{cases}
\end{equation*}\]</span></p>
<p>De modo que un cliente que no compra produce beneficios 0 con probabilidad 1,</p>
<p><span class="math display">\[Pr(X_0=0)=1,\]</span> y el beneficio de un cliente que no compra tiene como distribución de probabilidad:</p>
<p><span class="math display">\[\begin{equation*}
Pr(X_1 = k) = 
\begin{cases}
0.25 &amp; \text{ para } k = 30 \text{ modelo sencillo}\\
0.50 &amp; \text{ para } k = 60 \text{ modelo estándar}\\
0.25 &amp; \text{ para } k = 75 \text{ modelo lujo}.
\end{cases}
\end{equation*}\]</span></p>
<p>Es fácil simular cualquiera de estas distribuciones discretas mediante el algoritmo de la transformada inversa para variables discretas en la Definición <a href="intro.html#def:atidiscreta">1.19</a>, para acabar simulando de <span class="math inline">\(T\)</span> con el algoritmo anterior en la Definición <a href="intro.html#def:mixturadiscreta">1.20</a>.</p>
<p>Simulemos pues el proceso de venta para 30 clientes, recopilando, además de la ganancia que genera cada uno, la ganancia acumulada por las compras realizadas. Construimos una función para simular el proceso, en la que introducimos como parámetros la semilla de inicialización de la simulación y el número de clientes, por si deseamos ampliar el espectro de simulación en algún momento.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simula.ventas.micro</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">clientes</span>, <span class="va">semilla</span><span class="op">)</span>
<span class="op">{</span>
<span class="co"># Descripción del proceso de compra o no compra</span>
<span class="va">compra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Si"</span>, <span class="st">"No"</span><span class="op">)</span>
<span class="va">pcompra</span> <span class="op">&lt;-</span> <span class="fl">0.50</span>
<span class="co"># Descripción del proceso de adquisión del microondas</span>
<span class="va">tipo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sencillo"</span>, <span class="st">"Estándar"</span>, <span class="st">"Lujo"</span><span class="op">)</span>
<span class="va">prmicro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span><span class="op">)</span> <span class="co"># fmp X1</span>
<span class="va">prmicroacum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">prmicro</span><span class="op">)</span> <span class="co"># fon. distribución X1</span>
<span class="va">beneficio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">75</span><span class="op">)</span>
<span class="co"># Inicialización de variables para las simulaciones</span>
<span class="va">indicador</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>             <span class="co"># proceso de compra</span>
<span class="va">micro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>                 <span class="co"># tipo microondas adquirido</span>
<span class="va">bind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">clientes</span><span class="op">)</span>     <span class="co"># beneficio individual</span>
<span class="va">bacum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">clientes</span><span class="op">)</span>    <span class="co"># beneficio acumulado</span>

<span class="co">## Simulación del proceso</span>
<span class="co">##########################</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co"># Generamos uniformes para describir el proceso de compra y </span>
<span class="co"># el tipo de microondas adquirido</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">semilla</span><span class="op">)</span>
<span class="va">ucompra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">clientes</span><span class="op">)</span> <span class="co"># uniformes para el indicador</span>
<span class="va">umicro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">clientes</span><span class="op">)</span>  <span class="co"># uniformes para la compra</span>

<span class="co"># Bucle de simulación</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="va">clientes</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># Proceso de compra</span>
  <span class="va">indicador</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ucompra</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, <span class="va">compra</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">compra</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="co"># Tipo de microndas</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">indicador</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="va">compra</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">umicro</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">prmicroacum</span><span class="op">)</span><span class="op">)</span>
    <span class="va">micro</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tipo</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span>
    <span class="va">bind</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">beneficio</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="kw">else</span>
  <span class="op">{</span>
    <span class="va">micro</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Sin venta"</span>
    <span class="va">bind</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="op">}</span>
  <span class="va">bacum</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bind</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>  <span class="co"># se acumulan todos los beneficios</span>
  <span class="co"># nueva simulación</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="co"># Resultado</span>
<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Compra <span class="op">=</span> <span class="va">indicador</span>, Tipo <span class="op">=</span> <span class="va">micro</span>, 
                  Bind <span class="op">=</span> <span class="va">bind</span>, Bacum <span class="op">=</span> <span class="va">bacum</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Generamos el proceso para 30 clientes y analizamos los resultados</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu">simula.ventas.micro</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">123</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span></code></pre></div>
<pre><code>##   Compra      Tipo Bind Bacum
## 1     Si      Lujo   75    75
## 2     No Sin venta    0    75
## 3     Si  Estándar   60   135
## 4     No Sin venta    0   135
## 5     No Sin venta    0   135
## 6     Si  Estándar   60   195</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># el beneficio acumulado tras el paso de 30 clientes</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">simulacion</span>,n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>##    Compra     Tipo Bind Bacum
## 30     Si Estándar   60   600</code></pre>
<p>El beneficio acumulado tras el paso de 30 clientes un día cualquiera que hemos simulado es de 600 dólares.</p>
<p>En la Figura <a href="intro.html#fig:01-025">1.11</a> se han representado los resultados de las simulaciones generadas (30 clientes que pasan a la tienda), así como los beneficios acumulados por las ventas realizadas.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g1</span><span class="op">=</span><span class="va">simulacion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Tipo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tipo</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Tipo</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, 
                  y <span class="op">=</span> <span class="va">prop</span>, group <span class="op">=</span> <span class="va">Tipo</span><span class="op">)</span>,
              position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,
              vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Tipo de cliente"</span>,y<span class="op">=</span><span class="st">"Proporción"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span>

<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulacion</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="va">Bacum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Cliente"</span>, y <span class="op">=</span> <span class="st">"Beneficio acumulado"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-025"></span>
<img src="01-Probabilidad_files/figure-html/01-025-1.png" alt="Frecuencia relativa de cada tipo de venta (izquierda) y beneficio acumulado para los 30 clientes (derecha)." width="95%"><p class="caption">
Figura 1.11: Frecuencia relativa de cada tipo de venta (izquierda) y beneficio acumulado para los 30 clientes (derecha).
</p>
</div>
<p>Podemos también calcular la ganancia promedio que se obtiene con esos 30 clientes a partir de la variable <code>simulaciones$Bind</code>, que resulta de</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Bind</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>Si queremos aproximar el beneficio esperado por cliente, bastará simular muchos clientes, y promediar los beneficios que le dan a la tienda, o incluso el beneficio esperado por cliente que compra un microondas.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># número de clientes simulados</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu">simula.ventas.micro</span><span class="op">(</span><span class="va">nsim</span>,<span class="fl">123</span><span class="op">)</span>
<span class="co"># aproximación MC del beneficio medio de un cliente cualquiera</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Bind</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 29.025</code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># beneficio medio de un cliente de compra</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Bind</span><span class="op">[</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Compra</span><span class="op">==</span><span class="st">"Si"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 57.24852</code></pre>
<p>Así, el beneficio medio por cliente es aproximadamente de 29.03 dólares, mientras que el beneficio esperado por cliente que compra un microondas es de 57.25 dólares. El beneficio esperado por cada 30 clientes que entran en la tienda será de <span class="math inline">\(20.025 \times 30=870.75\)</span> dólares.</p>
<div class="example">
<p><span id="exm:mixtura2" class="example"><strong>Ejemplo 1.15  </strong></span>Un fabricante de galletas presenta muchos productos nuevos cada año, de los cuales cerca del 60% fracasan, 30% tienen un éxito moderado y un 10% tienen un gran éxito. Para mejorar sus posibilidades, el fabricante somete a una prueba sus nuevos productos, ante un grupo de clientes que actúa como jurado calificador. De los productos que fracasaron, 50% son calificados como malos, 30% como regulares y 20% como buenos. Para los que tuvieron un éxito moderado, la calificación es mala para un 20%, regular para un 40% y buena para otro 40%. Para los que tuvieron un gran éxito, los porcentajes son: malos 10%, regulares 30% y buenos 60%. El fabricante está interesado en conocer:</p>
<ul>
<li><p>¿Cuál es la probabilidad conjunta de que un producto tenga un éxito moderado y reciba una mala calificación?</p></li>
<li><p>Si un nuevo producto tiene una buena calificación, ¿cuál es la probabilidad de que fracase?</p></li>
<li><p>¿Cuál es la probabilidad de que un producto tenga éxito moderado dado que este obtuvo una mala calificación?</p></li>
</ul>
</div>
<p>Modelicemos el problema como una mixtura de distribuciones discretas según la Definición <a href="intro.html#def:mixturadiscreta">1.20</a>.</p>
<p>Sea <span class="math inline">\(I_i\)</span> la variable indicadora tal que</p>
<p><span class="math display">\[\begin{equation*}
Pr(I = k) = 
\begin{cases}
0.25 &amp; \text{ para } k = 1 \text{ fracaso}\\
0.50 &amp; \text{ para } k = 2 \text{ éxito moderado}\\
0.25 &amp; \text{ para } k = 3 \text{ gran éxito}.
\end{cases}
\end{equation*}\]</span></p>
<p>Luego definimos las variables <span class="math inline">\(X_i\)</span> que representan la calificación del jurado de un producto cuyo éxito o fracaso funcionó según <span class="math inline">\(I=i\)</span>: <span class="math inline">\(X_1\)</span> calificación de un producto que fue un fracaso (<span class="math inline">\(I=1\)</span>), <span class="math inline">\(X_2\)</span> calificación de un producto con un éxito moderado (<span class="math inline">\(I=2\)</span>) y <span class="math inline">\(X_3\)</span> calificación de un producto con una gran éxito (<span class="math inline">\(I=3\)</span>). Las distribuciones de <span class="math inline">\(X_1, X_2, X_3\)</span> vienen dadas por:</p>
<p><span class="math display">\[\begin{equation*}
Pr(X_1 = k) = 
\begin{cases}
0.5 &amp; \text{ para } k = 1 \text{ malo}\\
0.3 &amp; \text{ para } k = 2 \text{ regular}\\
0.2 &amp; \text{ para } k = 3 \text{ bueno}.
\end{cases}
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
Pr(X_2 = k) = 
\begin{cases}
0.2 &amp; \text{ para } k = 1 \text{ malo}\\
0.4 &amp; \text{ para } k = 2 \text{ regular}\\
0.4 &amp; \text{ para } k = 3 \text{ bueno}.
\end{cases}
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
Pr(X_3 = k) = 
\begin{cases}
0.1 &amp; \text{ para } k = 1 \text{ malo}\\
0.3 &amp; \text{ para } k = 2 \text{ regular}\\
0.6 &amp; \text{ para } k = 3 \text{ bueno}.
\end{cases}
\end{equation*}\]</span></p>
<p>Veamos el algoritmo de simulación necesario para este problema. Queremos simular productos que pueden haber tenido un gran éxito, un éxito moderado y o haber fracasado. Y para cada uno de ellos, queremos simular su calificación por el jurado que lo evaluó.</p>
<div class="silverbox">
<p>Consideramos una variable <span class="math inline">\(I\)</span> que indica el éxito de un nuevo producto y <span class="math inline">\(X_I\)</span> que indica la evaluación del producto por un jurado (para cada tipo de producto <span class="math inline">\(I\)</span>). En esta situación debemos proporcionar las simulaciones correspondientes a <span class="math inline">\(I\)</span> e <span class="math inline">\(X_I\)</span>. En concreto:</p>
<ul>
<li>Paso 1. Establecer tamaño de muestra a simular <span class="math inline">\(nsim\)</span>.</li>
</ul>
<p>Repetir los pasos 2 y 3 para cada iteración <span class="math inline">\(i\)</span> de <span class="math inline">\(1, 2,..., nsim\)</span>:</p>
<ul>
<li><p>Paso 2. Simular de la variable indicador, <span class="math inline">\(I_i\)</span>, mediante el algoritmo de la transformada inversa para una variable discreta con probabilidades <span class="math inline">\(0.6, 0.3, 0.1\)</span> (fracaso, éxito moderado, gran éxito), y seleccionar la variable <span class="math inline">\(X_{I_i}\)</span>.</p></li>
<li>
<p>Paso 3. Simular un valor <span class="math inline">\(x_{I_i}\)</span> mediante el algoritmo de la transformada inversa para <span class="math inline">\(X_i\)</span> con valores malos, regulares, buenos, y probabilidades dadas por:</p>
<ul>
<li>fracasos (0.5, 0.3, 0.2)</li>
<li>éxito moderado (0.2, 0.4, 0.4)</li>
<li>gran éxito (0.1, 0.3, 0.6)</li>
</ul>
</li>
<li><p>Paso 4. Devolver el conjunto de simulaciones <span class="math inline">\(\{(I_i, x_{I_i})\}_{i=1}^{nsim}.\)</span></p></li>
</ul>
</div>
<p>Procedamos pues, a simular el proceso para, con las simulaciones, responder a las preguntas planteadas por la empresa.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="va">semilla</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="co"># Descripción variable indicadora</span>
<span class="va">exito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fracaso"</span>, <span class="st">"Moderado"</span>, <span class="st">"Éxito"</span><span class="op">)</span>
<span class="va">pexito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">pexitoacum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pexito</span><span class="op">)</span>
<span class="co"># Descripción del proceso de adquisión del microondas</span>
<span class="va">clasifi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Malo"</span>, <span class="st">"Regular"</span>, <span class="st">"Bueno"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span><span class="op">)</span>
<span class="va">p1acum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>
<span class="va">p2acum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>
<span class="va">p3acum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span>

<span class="co"># Inicialización de variables para las simulaciones</span>
<span class="va">producto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>             <span class="co"># éxito producto</span>
<span class="va">jurado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>               <span class="co"># clasificación jurado</span>

<span class="co">## Simulación del proceso</span>
<span class="co">##########################</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co"># Generamos uniformes para describir el proceso de indicadores de éxito</span>
<span class="co"># y también el de evaluación o clasificación por el jurado</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">semilla</span><span class="op">)</span>
<span class="va">uexito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>  
<span class="va">uclasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>

<span class="co"># Bucle de simulación</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="va">nsim</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># Éxito del producto</span>
  <span class="va">producto</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">exito</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">uexito</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">pexitoacum</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="co"># Tipo de microndas</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">producto</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="va">exito</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">jurado</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clasifi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">uclasi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">p1acum</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">producto</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="va">exito</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">jurado</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clasifi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">uclasi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">p2acum</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="kw">else</span>
  <span class="op">{</span>
    <span class="va">jurado</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clasifi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">uclasi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">p3acum</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>    
  <span class="op">}</span>
  <span class="co"># nueva simulación</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="co"># Resultado</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>producto <span class="op">=</span> <span class="va">producto</span>, jurado <span class="op">=</span> <span class="va">jurado</span><span class="op">)</span></code></pre></div>
<p>A partir de las simulaciones, obtenemos la tabla conjunta de frecuencias (Tabla <a href="intro.html#tab:01-030a">1.1</a>) y las frecuencias relativas (Tabla <a href="intro.html#tab:01-030b">1.2</a>), que constituyen una aproximación de las probabilidades de ocurrencia.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distri.conjunta.frec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="va">distri.conjunta.frec</span>,caption<span class="op">=</span><span class="st">"Frecuencias observadas en las simulaciones."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:01-030a">Tabla 1.1: </span>Frecuencias observadas en las simulaciones.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Bueno
</th>
<th style="text-align:right;">
Malo
</th>
<th style="text-align:right;">
Regular
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:right;">
327
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
166
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:right;">
650
</td>
<td style="text-align:right;">
1516
</td>
<td style="text-align:right;">
844
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:right;">
616
</td>
<td style="text-align:right;">
292
</td>
<td style="text-align:right;">
542
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distri.conjunta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="va">distri.conjunta</span>,caption<span class="op">=</span><span class="st">"Frecuencias relativas observadas en las simulaciones. Aproximación de la distribución conjunta."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:01-030b">Tabla 1.2: </span>Frecuencias relativas observadas en las simulaciones. Aproximación de la distribución conjunta.
</caption>
<thead><tr>
<th style="text-align:left;">
producto
</th>
<th style="text-align:left;">
jurado
</th>
<th style="text-align:right;">
Freq
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.0654
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.1300
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.1232
</td>
</tr>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.0094
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.3032
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.0584
</td>
</tr>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:left;">
Regular
</td>
<td style="text-align:right;">
0.0332
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:left;">
Regular
</td>
<td style="text-align:right;">
0.1688
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:left;">
Regular
</td>
<td style="text-align:right;">
0.1084
</td>
</tr>
</tbody>
</table></div>
<p>Podemos contestar ahora a las preguntas planteadas sin más que mirar la tabla anterior o realizar calculos sencillos con los datos obtenidos:</p>
<ul>
<li>¿Cuál es la probabilidad conjunta de que un producto tenga un éxito moderado y reciba una mala calificación? Estamos interesados en la probabilidad</li>
</ul>
<p><span class="math display">\[Pr(\text{Éxito = "Moderado" y Evaluación =  "Malo"})\]</span></p>
<p>cuyo valor es 0.0584.</p>
<ul>
<li>Si un nuevo producto tiene una buena calificación, ¿cuál es la probabilidad de que fracase? Para responder a esta pregunta podemos aplicar el Teorema de Bayes para resolver la probabilidad condicionada siguiente a partir de las frecuencias observadas en la simulación y mostradas en la Tabla <a href="intro.html#tab:01-030a">1.1</a>,</li>
</ul>
<p><span class="math display">\[Pr(\text{E= "Fracaso" | Eval= "Bueno"}) =
\frac{Pr(\text{ E="Fracaso" , Eval= "Bueno"})}{Pr(\text{ Eval= "Bueno"})}\]</span></p>
<p>donde <span class="math inline">\(E=\)</span>Éxito y <span class="math inline">\(Eval=\)</span>Evaluación,</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distri.conjunta.frec</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">distri.conjunta.frec</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.4080352</code></pre>
<p>o directamente seleccionar sobre la Tabla <a href="intro.html#tab:01-030b">1.2</a> las simulaciones en las que el producto fue evaluado como “Bueno” por el jurado, y contabilizar en cuántas de ellas el producto finalmente fracasó (a través del ratio correspondiente).</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distri.conjunta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">jurado</span> <span class="op">==</span> <span class="st">"Bueno"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pr.bueno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">)</span>, resultado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">/</span><span class="va">pr.bueno</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Distribución condicionada a que el producto fue evaluado como Bueno por el jurado."</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"hoover"</span><span class="op">)</span>,full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:01-031">Tabla 1.3: </span>Distribución condicionada a que el producto fue evaluado como Bueno por el jurado.
</caption>
<thead><tr>
<th style="text-align:left;">
producto
</th>
<th style="text-align:left;">
jurado
</th>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
pr.bueno
</th>
<th style="text-align:right;">
resultado
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.0654
</td>
<td style="text-align:right;">
0.3186
</td>
<td style="text-align:right;">
0.2053
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.1300
</td>
<td style="text-align:right;">
0.3186
</td>
<td style="text-align:right;">
0.4080
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:left;">
Bueno
</td>
<td style="text-align:right;">
0.1232
</td>
<td style="text-align:right;">
0.3186
</td>
<td style="text-align:right;">
0.3867
</td>
</tr>
</tbody>
</table></div>
<p>La probabilidad de interés resulta 0.4080. De hecho, en la Tabla <a href="intro.html#tab:01-031">1.3</a> se muestran, en la columna “resultado,” las probabilidades condicionadas a que el jurado emitió una buena calificación del producto. ¿Cómo podemos interpretar esas probabilidades?</p>
<ul>
<li>¿Cuál es la probabilidad de que un producto tenga éxito moderado dado que éste obtuvo una mala calificación? Procedemos como en la pregunta anterior ya que estamos interesados en</li>
</ul>
<p><span class="math display">\[Pr(\text{E= "Moderado" | Eval = "Malo"}) = \frac{Pr(\text{E= "Moderado" , Eval = "Malo"})}{Pr(\text{ Eval= "Malo"})}\]</span></p>
<p>y lo resolvemos de nuevo generando la distribución condicionada a que la evaluación por el jurado sea “Mala,” que se muestra en la Tabla <a href="intro.html#tab:01-032">1.4</a></p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distri.conjunta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">jurado</span> <span class="op">==</span> <span class="st">"Malo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pr.malo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">)</span>, resultado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">/</span><span class="va">pr.malo</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Distribución condicionada a que el producto fue evaluado como Malo por el jurado."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"hoover"</span><span class="op">)</span>,full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:01-032">Tabla 1.4: </span>Distribución condicionada a que el producto fue evaluado como Malo por el jurado.
</caption>
<thead><tr>
<th style="text-align:left;">
producto
</th>
<th style="text-align:left;">
jurado
</th>
<th style="text-align:right;">
Freq
</th>
<th style="text-align:right;">
pr.malo
</th>
<th style="text-align:right;">
resultado
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Éxito
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.0094
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.0253
</td>
</tr>
<tr>
<td style="text-align:left;">
Fracaso
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.3032
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.8173
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderado
</td>
<td style="text-align:left;">
Malo
</td>
<td style="text-align:right;">
0.0584
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.1574
</td>
</tr>
</tbody>
</table></div>
<p>La probabilidad de interés es 0.1574. ¿Cómo podemos interpretar la Tabla <a href="intro.html#tab:01-032">1.4</a> de probabilidades obtenida?</p>
</div>
</div>
<div id="otras-distribuciones-continuas" class="section level2" number="1.7">
<h2>
<span class="header-section-number">1.7</span> Otras distribuciones continuas<a class="anchor" aria-label="anchor" href="#otras-distribuciones-continuas"><i class="fas fa-link"></i></a>
</h2>
<p>En el caso de variables de tipo continuo de las que no disponemos de un generador de valores aleatorios pero sí disponemos de su función de densidad o distribución, podemos utilizar el algoritmo de la transformada inversa, dado en la definición <a href="intro.html#def:aticontinua">1.18</a>, para obtener una muestra aleatoria de tamaño <span class="math inline">\(n\)</span> de su distribución.</p>
<p>En primer lugar estudiamos situaciones con una variable y posteriormente vemos ejemplos de sistemas de variables continuas o mixturas de discretas y continuas.</p>
<div id="una-variable-continua" class="section level3" number="1.7.1">
<h3>
<span class="header-section-number">1.7.1</span> Una variable continua<a class="anchor" aria-label="anchor" href="#una-variable-continua"><i class="fas fa-link"></i></a>
</h3>
<p>Estudiamos aquí, a través de ejemplos, la simulación de variables aleatorias de tipo continua para las que conocemos la función de densidad o distribución, y se quiere revolver algún problema inferencial.</p>
<div class="example">
<p><span id="exm:cont1" class="example"><strong>Ejemplo 1.16  </strong></span>Sea <span class="math inline">\(X\)</span> una variable aleatoria de tipo continuo cuya función de densidad viene dada por:</p>
<p><span class="math display">\[\begin{equation*}
f(x) = 2e^{-2x}  \text{ para } x \geq 0
\end{equation*}\]</span></p>
<p>Estamos interesados en conocer:</p>
<ul>
<li>¿Cuál es la probabilidad de que la variable de interés tome valores en el intervalo [1, 2]?</li>
<li>¿Cuál es la probabilidad de que la variable de interés tome valores mayores o iguales a 1.5?</li>
<li>¿Cuál es el valor esperado de la variable? ¿y la desviación típica?</li>
</ul>
</div>
<p>Para poder responder a las preguntas planteadas debemos obtener en primer lugar la función de distribución asociada a <span class="math inline">\(X\)</span>, que viene dada por:</p>
<p><span class="math display" id="eq:fd1-16">\[\begin{equation}
F(x) = \int_0^x 2e^{-2s} ds=1 - e^{-2x} \text{ para } x \geq 0
\tag{1.22}
\end{equation}\]</span></p>
<p>Podemos aplicar ahora el método de la transformada inversa para obtener una muestra de <span class="math inline">\(X\)</span>.</p>
<p>El algoritmo de simulación basado en la transformada inversa, en la Definición <a href="intro.html#def:aticontinua">1.18</a> viene dado por:</p>
<div class="silverbox">
<p>Si <span class="math inline">\(F(X)\)</span> es la función de distribución para <span class="math inline">\(X\)</span> dada en la Ecuación <a href="intro.html#eq:fd1-16">(1.22)</a></p>
<ul>
<li>Paso 1. Establecer el tamaño de muestra a simular <span class="math inline">\(nsim\)</span>.</li>
</ul>
<p>Repetir los pasos 2 y 3 para cada iteración <span class="math inline">\(i\)</span> de <span class="math inline">\(1, 2,..., nsim\)</span>:</p>
<ul>
<li><p>Paso 2. Generar <span class="math inline">\(u_i\)</span> a partir de una <span class="math inline">\(U(0,1)\)</span>.</p></li>
<li><p>Paso 3. Aplicar el método de la transformada inversa para obtener <span class="math inline">\(x_i = F^{-1}(u_i)\)</span> con <span class="math inline">\(F^{1}(u_i) = -log(1-u_i)/2.\)</span></p></li>
<li><p>Paso 4. Devolver el conjunto de simulaciones <span class="math inline">\(\{x_i\}_{i=1}^{nsim}\)</span>.</p></li>
</ul>
</div>
<p>Apliquemos pues el algoritmo anterior, y generemos una muestra de tamaño <span class="math inline">\(nsim=5000\)</span> para <span class="math inline">\(X\)</span>. Aprovechamos el calculo vectorial de <code>R</code> para no tener que hacer un bucle.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generamos uniformes </span>
<span class="va">uniforme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>
<span class="co"># Calculamos x con F^-1</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">uniforme</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
<p>Y con las simulaciones obtenidas, respondamos a cada una de las preguntas planteadas:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(1 &lt;= X &lt;= 2)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(1 &lt;= X &lt;= 2)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xs</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">xs</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(1 &lt;= X &lt;= 2)= 0.121</code></pre>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(X &gt;= 1.5)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(X &gt;= 1.5)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xs</span> <span class="op">&gt;=</span> <span class="fl">1.5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(X &gt;= 1.5)= 0.053</code></pre>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valor esperado y varianza</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(X)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## E(X)= 0.5046</code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"V(X)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## V(X)= 0.5078</code></pre>
</div>
<div id="composicionsec" class="section level3" number="1.7.2">
<h3>
<span class="header-section-number">1.7.2</span> Transformaciones y Método de Composición<a class="anchor" aria-label="anchor" href="#composicionsec"><i class="fas fa-link"></i></a>
</h3>
<p>En ocasiones, se nos plantea el problema de inferir, a través de simulación, sobre una variable aleatoria <span class="math inline">\(Y\)</span> que se obtiene como una transformación continua de otra variable <span class="math inline">\(X\)</span> cuya distribución conocemos, esto es, <span class="math display">\[Y=h(X), \quad \text{ con } X \sim F(x).\]</span></p>
<p>En particular, <span class="math display">\[E(Y)=\int_S h(x) f(x)dx.\]</span></p>
<p>Se propone un algoritmo sencillo para simular muestras aleatorias de la variable <span class="math inline">\(Y\)</span>, denominado <strong>método de composición</strong> y que se presenta a continuación.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:metodocomposicion" class="definition"><strong>Definición 1.21  </strong></span><strong>Método de composición</strong></p>
<p>Si <span class="math inline">\(X\)</span> es una variable aleatoria continua con función de distribución <span class="math inline">\(F(X)\)</span>, e <span class="math inline">\(Y\)</span> otra variable aleatoria que se obtiene como <span class="math inline">\(Y = h(X)\)</span>, donde <span class="math inline">\(h()\)</span> es una función continua, podemos obtener una muestra de <span class="math inline">\(Y\)</span> a partir del siguiente proceso:</p>
<ul>
<li>Paso 1. Fijar el número de simulaciones (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir los pasos 2 y 3 hasta alcanzar el número de simulaciones del paso 1.</p>
<ul>
<li>Paso 2. Generar un valor de la variable <span class="math inline">\(X\)</span>, <span class="math inline">\(\{x_i \sim F(x)\}\)</span>.<br>
</li>
<li>Paso 3. Calcular el valor de la variable <span class="math inline">\(Y\)</span> para esa simulación mediante <span class="math inline">\(y_i = h(x_i)\)</span>.</li>
<li>Paso 4. Devolver el conjunto de valores simulados <span class="math inline">\(\{y_i\}_{i=1}^{nsim}.\)</span>
</li>
</ul>
</div>
</div>
<div class="example">
<p><span id="exm:cont2" class="example"><strong>Ejemplo 1.17  </strong></span>Sea <span class="math inline">\(X\)</span> una variable aleatoria de tipo continuo cuya función de densidad viene dada por:</p>
<p><span class="math display">\[\begin{equation*}
f(x) = 3x^2  \text{ para } 0 &lt; x &lt; 1
\end{equation*}\]</span></p>
<p>y consideramos la variable aleatoria <span class="math inline">\(Y = 1 - X^2\)</span>. Estamos interesados en conocer:</p>
<ul>
<li>¿Cuál es el valor esperado de la variable <span class="math inline">\(Y\)</span>? ¿Y su desviación típica?</li>
<li><span class="math inline">\(Pr(Y \in [0,1])\)</span></li>
<li><span class="math inline">\(Pr(Y \geq 0.5)\)</span></li>
</ul>
</div>
<p>Puesto que la distribución de <span class="math inline">\(X\)</span> no es de las estándar, para simular de ella hemos de utilizar el método de la transformada inversa (Definición <a href="intro.html#def:aticontinua">1.18</a>), para lo que hemos de obtener necesariamente su función de distribución, que viene dada por:</p>
<p><span class="math display" id="eq:fdx2">\[\begin{equation}
F(x) = 
\begin{cases}
0 &amp; \text{ para } x &lt;= 0\\
x^3 &amp; \text{ para } 0 &lt; x &lt; 1\\
1 &amp; \text{ para } x \geq 1
\end{cases}
\tag{1.23}
\end{equation}\]</span></p>
<p>La función de distribución inversa es pues: <span class="math display">\[F^{-1}(u)=u^{1/3}\]</span></p>
<p>El algoritmo para obtener una muestra de <span class="math inline">\(Y\)</span> viene dado por:</p>
<div class="silverbox">
<p>Si <span class="math inline">\(F(X)\)</span> es la función de distribución para <span class="math inline">\(X\)</span> dada en <a href="intro.html#eq:fdx2">(1.23)</a></p>
<ul>
<li>Paso 1. Establecer tamaño de muestra a simular <span class="math inline">\(nsim\)</span>.</li>
</ul>
<p>Repetir los pasos 2 a 4 para cada iteración <span class="math inline">\(i\)</span> de <span class="math inline">\(1, 2,..., nsim\)</span>:</p>
<ul>
<li>Paso 2. Generar <span class="math inline">\(u_i\)</span> a partir de una <span class="math inline">\(U(0,1)\)</span>.</li>
<li>Paso 3. Aplicar el método de la transformada inversa para obtener <span class="math inline">\(x_i = F^{-1}(u_i)=u^{1/3}\)</span>.</li>
<li>Paso 4. Actuar por composición y calcular <span class="math inline">\(y_i = 1 - x_i^2\)</span>.</li>
<li>Paso 5. Devolver el conjunto <span class="math inline">\(\{y_i\}_{i=1}^{nsim}.\)</span>
</li>
</ul>
</div>
<p>Procedemos con el algoritmo de simulación.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generamos uniformes </span>
<span class="va">uniforme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>
<span class="co"># Calculamos x con F^-1</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="va">uniforme</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>
<span class="co"># Calculamos y = h(x)</span>
<span class="va">ys</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">xs</span>
<span class="co"># Devolvemos los valores de x e y</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, x <span class="op">=</span> <span class="va">xs</span>, y <span class="op">=</span> <span class="va">ys</span><span class="op">)</span></code></pre></div>
<p>Podemos calcular ahora las cantidades de interés:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valor esperado y desviación típica de Y </span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="va">simulacion</span><span class="op">$</span><span class="va">y</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(Y)="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## E(Y)= 0.2478</code></pre>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"sd(Y)="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## sd(Y)= 0.1915</code></pre>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(0 &lt;= Y &lt;= 1) </span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(0 &lt;= Y &lt;= 1)="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">datos</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">datos</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(0 &lt;= Y &lt;= 1)= 1</code></pre>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(Y &gt;= 1) </span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(Y &gt;= 0.5)="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">datos</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">nsim</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(Y &gt;= 0.5)= 0.121</code></pre>
<p>Representamos gráficamente las simulaciones obtenidas tanto para la variable <span class="math inline">\(X\)</span> como la <span class="math inline">\(Y\)</span>.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulacion</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Densidad"</span><span class="op">)</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulacion</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Y"</span>, y <span class="op">=</span> <span class="st">"Densidad"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-037"></span>
<img src="01-Probabilidad_files/figure-html/01-037-1.png" alt="Función de densidad empírica e histogramas para X e Y." width="95%"><p class="caption">
Figura 1.12: Función de densidad empírica e histogramas para X e Y.
</p>
</div>
</div>
<div id="combinaciones-de-variables" class="section level3" number="1.7.3">
<h3>
<span class="header-section-number">1.7.3</span> Combinaciones de variables<a class="anchor" aria-label="anchor" href="#combinaciones-de-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Continuamos este bloque con un tipo de problema que nos encontraremos en muchas ocasiones en el análisis de sistemas, como es la definición de nuevas variables al operar (combinar aritméticamente) otras cuya distribución es conocida. Un ejemplo típico es la suma o resta de variables aleatorias. Imaginemos que tenemos dos variables <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_2\)</span> con funciones de densidad <span class="math inline">\(f_1(x_1)\)</span> y <span class="math inline">\(f_2(x_2)\)</span> respectivamente, y estamos interesados en estudiar las variables:</p>
<p><span class="math display">\[Y = X_1 + X_2 \quad\text{ y } \quad Z = X_1 - X_2\]</span> Para el estudio de <span class="math inline">\(Y\)</span> y <span class="math inline">\(Z\)</span> podemos proceder teóricamente mediante los correspondientes cambios de variable, pero en situaciones má complejas o con más variables ese procedimiento es poco práctico. En dichas situaciones, podemos utilizar el método de composición para obtener una muestra de las nuevas variables.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:unlabeled-div-6" class="definition"><strong>Definición 1.22  </strong></span><strong>Método de composición para combinaciones de variables</strong></p>
<p>Si <span class="math inline">\(X_1,..., X_n\)</span> es un conjunto de variables aleatorias continuas con funciones de distribución <span class="math inline">\(F_1,..., F_n\)</span> y se define la variable aleatoria <span class="math inline">\(Y\)</span> mediante una transformación <span class="math inline">\(h(X_1,...,X_n)\)</span>, donde <span class="math inline">\(h()\)</span> es una función continua, podemos obtener una muestra de <span class="math inline">\(Y\)</span> mediante el siguiente procedimiento:</p>
<ul>
<li>Paso 1. Fijar el número de simulaciones (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir pasos 2 y 3 hasta alcanzar el número de simulaciones fijado en el paso 1</p>
<ul>
<li>Paso 2. Generar un valor de cada variable <span class="math inline">\(X_i\)</span>, <span class="math inline">\(x_{ji} \sim F(x_j), \quad j=1,\ldots,n\)</span>.</li>
<li>Paso 3. Calcular el valor de la variable <span class="math inline">\(Y\)</span> mediante <span class="math inline">\(y_i = h(x_{1i},...,x_{ni})\)</span>.</li>
<li>Paso 4. Devolver el conjunto de valores simulados <span class="math inline">\(\{y_i\}_{i=1}^{nsim}.\)</span>
</li>
</ul>
</div>
</div>
<p>Estudiamos a continuación algunos ejemplos donde se aplica el algoritmo expuesto.</p>
<div class="example">
<p><span id="exm:combined1" class="example"><strong>Ejemplo 1.18  </strong></span>Supongamos que tenemos un conjunto de 10 variables <span class="math inline">\(X_1,...,X_{10}\)</span>, tales que cada una de ellas se distribuye de forma independiente como: <span class="math display">\[X_i \sim U(0,1), \quad i=1,...,10\]</span> y consideramos además las variables aleatorias</p>
<p><span class="math display">\[\begin{eqnarray*}
Y_{min} &amp;=&amp; min\{X_1,...,X_{10}\},\\
Y_{max} &amp;=&amp; max\{X_1,...,X_{10}\}.
\end{eqnarray*}\]</span></p>
<p>Estamos interesados en conocer:</p>
<ul>
<li>¿Cuál es el valor de <span class="math inline">\(Pr[(Y_{min} \leq 0.1) \cap (Y_{max} \geq 0.8)]\)</span>.</li>
<li>¿Cuál es el valor esperado del rango, definido como <span class="math inline">\(R = Y_{max} - Y_{min}\)</span>?</li>
<li>¿Cuál es el valor de <span class="math inline">\(Pr(R \geq 0.5)\)</span>?</li>
</ul>
</div>
<p>Auque el problema teórico se puede resolver fácilmente, vamos a plantear un algoritmo de simulación para responder a las cuestiones de interés.</p>
<div class="silverbox">
<p>Algoritmo para obtener una muestra de <span class="math inline">\(Y_{min}, Y_{max}\)</span> y <span class="math inline">\(R\)</span>.</p>
<ul>
<li>Paso 1. Fijar el número de simulaciones (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir los pasos 2 a 4 hasta alcanzar el número de simulaciones fijado en el paso 1.</p>
<ul>
<li>Paso 2. Generar valores <span class="math inline">\(x_{1,i},...,x_{10,i} \sim U(0,1)\)</span>.</li>
<li>Paso 3. Aplicando composición calcular <span class="math inline">\(y_{min,i} = min\{x_{1,i},...,x_{10,i}\}\)</span> e <span class="math inline">\(y_{max,i} = max\{x_{1,i},...,x_{10,i}\}\)</span>.</li>
<li>Paso 4. Aplicando composición calcular <span class="math inline">\(r_{i} = y_{max,i} - y_{min,i}.\)</span>
</li>
<li>Paso 5. Devolver el conjunto de valores simulados <span class="math inline">\(\{y_{min,i}, y_{max,i}, r_{i}\}_{i=1}^{nsim}.\)</span>
</li>
</ul>
</div>
<p>Procedemos con el algoritmo de simulación. Aprovechamos las ventajas de <code>R</code> para el cálculo vectorial y evitar los bucles.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="va">nvar</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># número de variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generamos matriz de datos uniformes de dimensiones nsim*nvar </span>
<span class="va">uniforme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">*</span><span class="va">nvar</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nsim</span><span class="op">)</span>
<span class="co"># Calculamos y_min e y_max</span>
<span class="va">ymin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">uniforme</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span>
<span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">uniforme</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span>
<span class="co"># Calculamos rango</span>
<span class="va">rango</span> <span class="op">&lt;-</span> <span class="va">ymax</span> <span class="op">-</span> <span class="va">ymin</span>
<span class="co"># Devolvemos los valores </span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, 
                         ymin <span class="op">=</span> <span class="va">ymin</span>, ymax <span class="op">=</span> <span class="va">ymax</span>, 
                         rango <span class="op">=</span> <span class="va">rango</span><span class="op">)</span></code></pre></div>
<p>Podemos evaluar ahora las cuestiones de interés a partir de la muestra obtenida para las tres variables.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Pr(Y_{min} &lt;= 0.1, Y_{max} &gt;= 0.8)$</span>
<span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">ymin</span> <span class="op">&lt;=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">ymax</span> <span class="op">&gt;=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(Y_{min} &lt;= 0.1, Y_{max} &gt;= 0.8)="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(Y_{min} &lt;= 0.1, Y_{max} &gt;= 0.8)= 0.5732</code></pre>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Valor esperado del rango </span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(R)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">rango</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## E(R)= 0.8183</code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pr(R &gt;= 0.5)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(R &gt;= 0.5)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">rango</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(R &gt;= 0.5)= 0.9874</code></pre>
<p>Representamos en la Figura <a href="intro.html#fig:01-040">1.13</a> la distribución obtenida a partir de las simulaciones para las tres variables consideradas.</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">orden</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ymin"</span>, <span class="st">"ymax"</span>, <span class="st">"rango"</span><span class="op">)</span>
<span class="co"># Construimos matriz de datos para el gráfico</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">simulacion</span>, cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, 
                      names_to <span class="op">=</span> <span class="st">"Medida"</span>, values_to <span class="op">=</span> <span class="st">"Valor"</span><span class="op">)</span>
<span class="co"># gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Valor</span>,fill <span class="op">=</span> <span class="va">Medida</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Densidad"</span>,x <span class="op">=</span> <span class="st">""</span>,fill <span class="op">=</span> <span class="st">"Variables"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-040"></span>
<img src="01-Probabilidad_files/figure-html/01-040-1.png" alt="Simulaciones del mímimo, máximo y rango de X1,...,X10 v.a. U(9,1)." width="95%"><p class="caption">
Figura 1.13: Simulaciones del mímimo, máximo y rango de X1,…,X10 v.a. U(9,1).
</p>
</div>
<div class="example">
<p><span id="exm:combined2" class="example"><strong>Ejemplo 1.19  </strong></span>En un estudio de calidad se está analizando el ajuste entre las pernos y las tuercas de cierto proceso de fabricación. Los pernos y las tuercas se fabrican de forma independiente y se colocan en dos cajas. Posteriormente se elige un perno y una tuerca y se prueba si encajan entre sí. Un perno y una tuerca ajustarán si el diámetro del agujero de la tuerca es mayor que el diámetro del perno y la diferencia entre estos diámetros no es mayor que 0.06 centímetros. Cuando no se cumplen estas especificaciones, tanto la tuerca como el perno se desechan. Las especificaciones de fabricación de los pernos indican que su diámetro se puede considerar que es una variable Normal con media 2 centimetros y desviación típica de 0.01 centímetros, mientras que el diámetro de las tuercas es una variable Normal con media 2.03 centímetros y desviación típica de 0.02 centímetros.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que encajen un perno y una tuerca elegidos al azar en una caja cualquiera?</li>
<li>Si se fabrican 10000 pernos y tuercas en un día, ¿cuántas desecharemos?</li>
<li>Si el porcentaje de desechos es inferior al 15% en un día no se modificarán las especificaciones de fabricación ¿Consideras que deberían modificarse las especificaciones de fabricación?</li>
</ol>
</div>
<p>Partimos pues, para resolver el problema, de las variables <span class="math inline">\(T\sim N(2.03, 0.02)\)</span>, que representa el diámetro de una tuerca, y <span class="math inline">\(P \sim N(2, 0.01)\)</span> que representa el diámetro de un perno. Las especificaciones de calidad exigen que <span class="math inline">\(T&gt;P\)</span> y que <span class="math inline">\(Dif=T-P\leq 0.6\)</span>, o lo que es lo mismo, <span class="math inline">\(0&lt;Dif\leq 0.6\)</span>.</p>
<p>Veamos cómo podríamos simular para responder a las preguntas planteadas.</p>
<div class="silverbox">
<p>Algoritmo para obtener la diferencia entre los diámetros de las tuercas y los pernos.</p>
<ul>
<li>Paso 1. Fijar el número de simulaciones (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir los pasos 2 a 4 hasta alacanzar el número de simulaciones fijado en el paso 1.</p>
<ul>
<li>Paso 2. Generar valores <span class="math inline">\(t_i\sim F(T)\)</span> y <span class="math inline">\(p_i \sim F(P)\)</span> de sus respectivas distribuciones.</li>
<li>Paso 3. Aplicando composición, calcular <span class="math inline">\(dif_i = t_i - p_i.\)</span>
</li>
<li>Paso 4. Verificar el requisito de calidad: <span class="math inline">\(0 &lt; dif_i \leq 0.06\)</span> y asignar <span class="math inline">\(valid_i = 1\)</span> si se cumple con el criterio y <span class="math inline">\(valid_i = 0\)</span> en otro caso.</li>
<li>Paso 5. Devolver el conjunto de valores simulados <span class="math inline">\(\{t_i, p_i, dif_i, valid_i\}_{i=1}^{nsim}.\)</span>
</li>
</ul>
</div>
<p>Pongamos en práctica el algoritmo diseñado.</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generamos diámetros para tuercas y pernos</span>
<span class="va">tuercas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="fl">2.03</span>, <span class="fl">0.02</span><span class="op">)</span>
<span class="va">pernos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="fl">2.00</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="co"># Calculamos la diferencia y creamos filtro de calidad</span>
<span class="va">diferencia</span> <span class="op">&lt;-</span> <span class="va">tuercas</span> <span class="op">-</span> <span class="va">pernos</span>
<span class="va">valid</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">diferencia</span> <span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">diferencia</span> <span class="op">&lt;=</span> <span class="fl">0.06</span><span class="op">)</span>
<span class="co"># Devolvemos los valores </span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, 
                         tuercas <span class="op">=</span> <span class="va">tuercas</span>, 
                         pernos <span class="op">=</span> <span class="va">pernos</span>, 
                         diferencia<span class="op">=</span> <span class="va">diferencia</span>, 
                         valid <span class="op">=</span> <span class="va">valid</span><span class="op">)</span></code></pre></div>
<p>Representamos los datos simulados en la Figura <a href="intro.html#fig:01-042">1.14</a>, con la que podemos ya responder la primera pregunta:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que encajen un perno y una tuerca elegidos al azar en una caja cualquiera? Como vemos en la gráfica superior izquierda, la respuesta es 0.82, a la vista de que el 82% de las cajas inspeccionadas son válidas.</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calidad del proceso</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">simulacion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">valid</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">valid</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">prop</span>, label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Sí"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1.5</span>,size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Resultado del proceso: validez"</span>, y <span class="op">=</span> <span class="st">"Porcentaje"</span><span class="op">)</span>
<span class="co"># Diferencia</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulacion</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">diferencia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span>,color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.06</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferencia Tuerca-Perno"</span>, y <span class="op">=</span> <span class="st">"Frecuencia"</span><span class="op">)</span>
<span class="co"># Diámetros</span>
<span class="va">orden</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tuercas"</span>, <span class="st">"pernos"</span><span class="op">)</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">simulacion</span>, cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, names_to <span class="op">=</span> <span class="st">"Medida"</span>, values_to <span class="op">=</span> <span class="st">"Valor"</span><span class="op">)</span>
<span class="co"># gráfico</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Medida</span>, <span class="va">Valor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="va">orden</span>, labels <span class="op">=</span> <span class="va">orden</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Diámetro"</span><span class="op">)</span>
<span class="co"># Combinación</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-042"></span>
<img src="01-Probabilidad_files/figure-html/01-042-1.png" alt="Simulaciones del proceso de calidad para tuercas y pernos." width="95%"><p class="caption">
Figura 1.14: Simulaciones del proceso de calidad para tuercas y pernos.
</p>
</div>
<p>Respondemos las siguientes preguntas:</p>
<ol start="2" style="list-style-type: decimal">
<li>Si se fabrican 10000 pernos y tuercas en un día, ¿cuántas desecharemos? Si nuestra producción es de 10000 parejas, el número de parejas desechadas será igual a:</li>
</ol>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">10000</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">valid</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1794</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Si el porcentaje de desechos es inferior al 15% en un día no se modificarán las especificaciones de fabricación ¿Consideras que deberían modificarse las especificaciones de fabricación? Realmente el porcentaje de piezas desechadas es del 18% (gráfico superior izquierdo en la Figura <a href="intro.html#fig:01-042">1.14</a>), por lo que la recomendación sería abordar un proceso de mejora en la fabricación para reducir los defectos.</li>
</ol>
<div class="example">
<p><span id="exm:combined3" class="example"><strong>Ejemplo 1.20  </strong></span>Una empresa de fabricación de componentes para aviones tiene entre sus productos una barra que se coloca como sujeción en las alas, y que se construye mediante la unión consecutiva de tres secciones A, B, y C. Las especificaciones de fabricación establecen que la longitud (en pulgadas) de cada barra es una distribución Normal. Más concretamente la sección A tiene una media de 20 pulgadas y una varianza de 0.04. la longitud de la sección B tiene una media de 14 y varianza de 0.01, mientras que la sección C tiene una media de 26 y varianza 0.04. Las tres piezas se unen consecutivamente (A con B y B con C) de forma que se encajan superponiendo 2 pulgadas en cada unión. La barra sólo puede ser utilizada si su longitud total está entre 55.5 y 56.5 pulgadas.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que la barra sea utilizable?</li>
<li>Si en un mes se fabrican 25000 barras ¿cuál es el número de barras desechadas?</li>
<li>Por cada barra dentro de especificaciones se obtiene un beneficio de 300 euros, pero si se desecha, se genera una pérdida de 100 euros. ¿Cuál será el beneficio estimado en un mes?</li>
</ol>
</div>
<p>Si denominamos <span class="math inline">\(LA\)</span>, <span class="math inline">\(LB\)</span>, y <span class="math inline">\(LC\)</span> a las variables aleatorias correspondientes a las longitudes de las secciones A, B, y C respectivamente, las distribuciones asociadas vienen dadas por:</p>
<p><span class="math display">\[LA \sim N(20, \sqrt{0.04}); \quad LB \sim N(14, \sqrt{0.01}); \quad  LC \sim N(26, \sqrt{0.04})\]</span></p>
<p>La otra variable involucrada es la suma de barra al unir las piezas, que se obtiene como <span class="math inline">\(L=LA+LB+LC-4\)</span>, dado que en cada junta se pierden 2 pulgadas. Las especificaciones de calidad sobre ella son <span class="math inline">\(55.5 \leq L \leq y 56.5\)</span>.</p>
<p>Proponemos pues, un algoritmo de simulación que nos permita simular la longitud total de la barra a partir de cada una de las secciones, y verificar si está dentro de las especificaciones de calidad establecidas.</p>
<div class="silverbox">
<ul>
<li>Paso 1. Fijar el número de simulaciones (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir los pasos 2 a 4 hasta alcanzar el número de simulaciones fijado en el paso 1.</p>
<ul>
<li><p>Paso 2. Generar valores <span class="math inline">\(LA_i\)</span>, <span class="math inline">\(LB_i\)</span>, y <span class="math inline">\(LC_i\)</span> a partir de sus distribuciones correspondientes.<br></p></li>
<li><p>Paso 3. Aplicando composición, calcular <span class="math inline">\(L_i = LA_i + LB_i + LC_i - 4.\)</span></p></li>
<li><p>Paso 4. Verificar el requisito de calidad: <span class="math inline">\(55.5 \leq L_i \leq 56.5\)</span> y asignar <span class="math inline">\(valid_i = 1\)</span> si lo cumple, y <span class="math inline">\(valid_i = 0\)</span> si no lo cumple.</p></li>
<li><p>Paso 5. Devolver el conjunto de valores simulados <span class="math inline">\(\{LA_i, LB_i, LC_i, L_i, valid_i\}_{i=1}^{nsim}.\)</span></p></li>
</ul>
</div>
<p>Programemos el algoritmo.</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros iniciales</span>
<span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generamos longitudes de las secciones</span>
<span class="va">LA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">0.04</span><span class="op">)</span><span class="op">)</span>
<span class="va">LB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="fl">14</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>
<span class="va">LC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="fl">26</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">0.04</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Calculamos longitud total y verificamos requisitos</span>
<span class="va">L</span> <span class="op">&lt;-</span> <span class="va">LA</span> <span class="op">+</span> <span class="va">LB</span> <span class="op">+</span> <span class="va">LC</span> <span class="op">-</span> <span class="fl">4</span>
<span class="va">valid</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">L</span> <span class="op">&gt;=</span> <span class="fl">55.5</span> <span class="op">&amp;</span> <span class="va">L</span> <span class="op">&lt;=</span> <span class="fl">56.5</span><span class="op">)</span>
<span class="co"># Devolvemos los valores </span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, LA <span class="op">=</span> <span class="va">LA</span>, LB <span class="op">=</span> <span class="va">LB</span>, 
                         LC <span class="op">=</span> <span class="va">LC</span>, L <span class="op">=</span> <span class="va">L</span>,valid<span class="op">=</span><span class="va">valid</span><span class="op">)</span></code></pre></div>
<p>Respondamos a las preguntas a partir de las simulaciones obtenidas.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que la barra sea utilizable? La respuesta viene aproximada por la proporción de piezas válidas. Calculamos también un intervalo de confianza utilizando la ecuación <a href="intro.html#eq:icMC">(1.5)</a>.</li>
</ol>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Pr proceso cumpla criterios calidad</span>
<span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">valid</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">error</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">valid</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># 1-alpha=nivel de confianza para el IC</span>
<span class="va">ic.low</span> <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="va">ic.up</span> <span class="op">=</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(barra utilizable)="</span>, <span class="va">p</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(barra utilizable)= 0.9016</code></pre>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Error de la aproximación="</span>, <span class="va">error</span><span class="op">)</span></code></pre></div>
<pre><code>## Error de la aproximación= 4.298784e-17</code></pre>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC("</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,<span class="st">"%)= ["</span>, <span class="va">ic.low</span>,<span class="st">","</span>, <span class="va">ic.up</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC( 0.95 %)= [ 0.9016 , 0.9016 ]</code></pre>
<p>Dado el error tan pequeño que genera el proceso de simulación, la estimación proporcionada es claramente precisa.</p>
<ol start="2" style="list-style-type: decimal">
<li>Si en un mes se fabrican 25000 barras ¿cuál es el número de barras desechadas?</li>
</ol>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desechos</span><span class="op">=</span><span class="fl">25000</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Barras desechadas en un mes:"</span>, <span class="va">desechos</span><span class="op">)</span></code></pre></div>
<pre><code>## Barras desechadas en un mes: 2460</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Por cada barra dentro de especificaciones se obtiene un beneficio de 300 euros, pero si se desecha, se genera una pérdida de 100 euros. ¿Cuál será el beneficio estimado en un mes?</li>
</ol>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">benef</span><span class="op">=</span><span class="op">(</span><span class="fl">25000</span><span class="op">-</span><span class="va">desechos</span><span class="op">)</span><span class="op">*</span><span class="fl">300</span><span class="op">-</span><span class="va">desechos</span><span class="op">*</span><span class="fl">100</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Beneficio obtenido en un mes:"</span>, <span class="va">benef</span>, <span class="st">"€"</span><span class="op">)</span></code></pre></div>
<pre><code>## Beneficio obtenido en un mes: 6516000 €</code></pre>
</div>
<div id="modelos-secuenciales" class="section level3" number="1.7.4">
<h3>
<span class="header-section-number">1.7.4</span> Modelos secuenciales<a class="anchor" aria-label="anchor" href="#modelos-secuenciales"><i class="fas fa-link"></i></a>
</h3>
<p>En la última sección para variables de tipo continuo presentamos los primeros modelos de simulación para variables aleatorias que actúan de forma consecutiva a lo largo del tiempo. Será pues, una introducción a los modelos estocásticos que estudiaremos en el resto de unidades. En estas situaciones todas las variables involucradas en el sistema hacen referencia al tiempo de ocurrencia de los eventos de interés. Trabajemos con ejemplos, para entender los conceptos y problemas involucrados.</p>
<div class="example">
<p><span id="exm:secuencia1" class="example"><strong>Ejemplo 1.21  </strong></span>El equipo de mantenimiento de una empresa debe programar las visitas a cierta instalación para establecer una calendario eficiente de revisiones. El sistema que debe analizar está compuesto por tres procesos (A, B, y C) que funcionan de forma independiente, pero que están conectados en serie, de forma que todo el sistema se detiene si un proceso falla. El tiempo de vida o tiempo hasta un fallo o avería, medido en horas, para cada uno de los procesos se puede considerar aleatorio y responde a distribuciones exponenciales con medias 1000, 333, y 167 respectivamente.</p>
<p>El proceso de fabricación completo, que involucra a los tres procesos A, B y C, funciona 24 horas al día y completa un ciclo cada siete días, tras el cual realiza un parón para tareas de mantenimiento. En ese ciclo, los procesos A, B y C operan consecutivamente durante un día: <span class="math inline">\(A\)</span> trabaja durante 15.6 horas, luego entra en funcionamiento el proceso <span class="math inline">\(B\)</span> durante 5.52 horas, y finalmente el <span class="math inline">\(C\)</span> durante 2.88 horas.</p>
<p>En la actualidad el equipo de manteniento está interesado en reajustar el ciclo para realizar las labores de mantenimiento, si fuera necesario, y reducir el tiempo muerto en que el sistema está parado, pues en estos momentos se dedican 24 horas tras cada ciclo, para las tareas de mantenimiento.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que el sistema falle antes de finalizar un ciclo de trabajo?</li>
<li>¿Cuál de los procesos está generando más parones en el ciclo debidos a una avería?</li>
<li>¿Cuál es el tiempo medio de funcionamiento del sistema sin ningún fallo? Interesa además, un rango o intervalo de confianza para dicha estimación. ¿Cuál sería el tiempo óptimo del ciclo para abordar las tareas de mantenimiento?</li>
</ol>
</div>
<p>En primer lugar modelicemos el sistema en base a la información proporcionada. Definamos las variables aleatorias <span class="math inline">\(TA\)</span>, <span class="math inline">\(TB\)</span>, y <span class="math inline">\(TC\)</span> que representan, respectivamente, el tiempo de funcionamiento -o tiempo a fallo- (en horas) de cada proceso A, B y C. Sus distribuciones son: <span class="math display">\[TA \sim Exp(1/1000); \quad TB \sim Exp(1/333); \quad TC \sim Exp(1/167).\]</span> También son importantes las siguientes cantidades: - El tiempo de funcionamiento requerido cada día para cada uno de los procesos <span class="math inline">\(ta=15.6, tb=5.52, tc=2.88\)</span> y el número de días que conforma cada ciclo, <span class="math inline">\(nciclo=7\)</span>.</p>
<ul>
<li>El tiempo de vida potencial del sistema completo, esto es, el tiempo <span class="math inline">\(T\)</span> que funciona el sistema de fabricación hasta un fallo, y que se calcula a partir del mínimo número de días que funciona cada proceso, <span class="math inline">\(min \{TA/ta,TB/tb,TC/tb\}\)</span>.</li>
</ul>
<p>Propongamos pues, un algoritmo de simulación que reproduzca el proceso de fabricación para un número <span class="math inline">\(nsim\)</span> de ciclos simulados, cuyas simulaciones permitan responder a las preguntas planteadas.</p>
<div class="silverbox">
<p><strong>Algoritmo para el estudio de fallo del sistema</strong></p>
<ul>
<li>Paso 1. Fijar el número de simulaciones o ciclos a simular (<span class="math inline">\(nsim\)</span>).</li>
</ul>
<p>Repetir los pasos 2 a 4 tantas veces como simulaciones a generar (<em>nsim</em>).</p>
<ul>
<li><p>Paso 2. Generar valores <span class="math inline">\(TA_i\)</span>, <span class="math inline">\(TB_i\)</span>, y <span class="math inline">\(TC_i\)</span> de los tiempos a fallo de cada proceso según su distribución.</p></li>
<li><p>Paso 3. Calcular el número de días que dura sin fallos cada proceso, con los ratios <span class="math inline">\(rt_i=\{TA_i/ta, TB_i/tb, TC_i/tc\}\)</span>. Identificar cuál falla primero (<span class="math inline">\(min(rt_i)\)</span>).</p></li>
<li><p>Paso 4. Verificar si el primero en fallar lo hace antes de terminar el ciclo, <span class="math inline">\(min(rt_i)&lt;=7\)</span>. Si es que sí, guardar cuál es el proceso responsable del fallo y calcular la duración del ciclo mediante <span class="math inline">\(24*rt_i\)</span> horas. Si es que no, indicarlo y especificar como duración del ciclo <span class="math inline">\(24*7\)</span> horas.</p></li>
<li><p>Paso 5. Devolver los valores de las simulaciones de los tiempos a fallo de cada proceso, de la duración del ciclo, el indicador de fallo y el proceso responsable en cada ciclo (simulación).</p></li>
</ul>
</div>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Función para simular el proceso de fabricación con tres subprocesos ABC encadenados.</span>
<span class="va">simula.proceso</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">nsim</span>, <span class="va">nciclo</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">delta</span>, <span class="va">ta</span>, <span class="va">tb</span>, <span class="va">tc</span><span class="op">)</span><span class="op">{</span>
<span class="co"># semilla=Semilla aleatoria y nsim=nº simulaciones o ciclos a simular</span>
<span class="co">#nciclo es el número de días del ciclo</span>
<span class="co"># alpha, beta y delta son los parámetros de las exponenciales TA,TB,TC</span>
<span class="co"># ta,tb y tc son los tiempos de funcionamiento diarios para los procesos A, B y C.</span>
<span class="va">Tciclo</span><span class="op">=</span><span class="va">Dciclo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span>   <span class="co"># tiempo de ciclo (en horas T y días D)</span>
<span class="va">Tpotencial</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span>      <span class="co"># tiempo(en horas) que funcionaría sin fallos</span>
<span class="va">fallo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>                   <span class="co"># qué proceso ha fallado en cada ciclo</span>
<span class="va">procesos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>

<span class="co"># simulamos las duraciones para todos los ciclos</span>
<span class="va">TA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">alpha</span><span class="op">)</span>  
<span class="va">TB</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">beta</span><span class="op">)</span>
<span class="va">TC</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">nsim</span>, <span class="va">delta</span><span class="op">)</span>
<span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ta</span>, <span class="va">tb</span>, <span class="va">tc</span><span class="op">)</span> <span class="co"># funcionamiento diario de cada proceso</span>

<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span>
  <span class="cn">T</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">TA</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">TB</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">TC</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>      <span class="co"># tiempos de vida para el ciclo j</span>
  <span class="va">nfallo</span> <span class="op">=</span> <span class="cn">T</span><span class="op">/</span><span class="va">t</span>                  <span class="co"># número días que funcionará cada proceso</span>
  <span class="va">falla</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">nfallo</span><span class="op">)</span>     <span class="co"># qué proceso falla primero</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nfallo</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">nciclo</span><span class="op">)</span><span class="op">{</span>  <span class="co"># si falla antes de cerrar el ciclo</span>
   <span class="va">fallo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">procesos</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span>   <span class="co">#identificamos el proceso que falla</span>
   <span class="va">Dciclo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="cn">T</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span><span class="op">/</span><span class="va">t</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span>   <span class="co"># y lo pasamos a días</span>
   <span class="va">Tciclo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">Tpotencial</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fl">24</span><span class="op">*</span><span class="va">Dciclo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>   <span class="co"># duración del ciclo (en horas)</span>
  <span class="op">}</span>
  <span class="kw">else</span><span class="op">{</span>                       <span class="co">#si no falla ninguno antes de cerrar el ciclo</span>
    <span class="va">Tciclo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fl">24</span><span class="op">*</span><span class="fl">7</span>            <span class="co">#cerramos el ciclo sin fallos</span>
    <span class="va">Dciclo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fl">7</span>
    <span class="va">fallo</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="st">"No"</span>
    <span class="va">Tpotencial</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="cn">T</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span><span class="op">/</span><span class="va">t</span><span class="op">[</span><span class="va">falla</span><span class="op">]</span><span class="op">*</span><span class="fl">24</span>    <span class="co"># y guardamos la duración potencial </span>
  <span class="op">}</span>
<span class="op">}</span> <span class="co"># fin del for (j)</span>
<span class="va">resultado</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ciclo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, <span class="va">fallo</span>,
                     Tciclo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Tciclo</span>, <span class="fl">2</span><span class="op">)</span>,Dciclo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Dciclo</span>, <span class="fl">2</span><span class="op">)</span>,
                     Tpotencial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Tpotencial</span>, <span class="fl">2</span><span class="op">)</span>,
                     DA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">TA</span><span class="op">/</span><span class="va">ta</span>, <span class="fl">2</span><span class="op">)</span>, DB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">TB</span><span class="op">/</span><span class="va">tb</span>, <span class="fl">2</span><span class="op">)</span>, DC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">TC</span><span class="op">/</span><span class="va">tc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">resultado</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Lanzamos el proceso para los valores del ejemplo, y visualizamos los resultados en la Tabla <a href="intro.html#tab:procesofabricacion">1.5</a></p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nciclo</span> <span class="op">=</span> <span class="fl">7</span>; <span class="va">alpha</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>; <span class="va">beta</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">333</span>; <span class="va">delta</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">167</span>
<span class="va">ta</span> <span class="op">=</span> <span class="fl">15.6</span>;<span class="va">tb</span> <span class="op">=</span> <span class="fl">5.52</span>; <span class="va">tc</span> <span class="op">=</span> <span class="fl">2.88</span>
<span class="va">semilla</span> <span class="op">=</span> <span class="fl">12</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">semilla</span><span class="op">)</span>
<span class="va">nsim</span><span class="op">=</span><span class="fl">5000</span>                  
<span class="va">simulacion</span><span class="op">=</span><span class="fu">simula.proceso</span><span class="op">(</span><span class="va">nsim</span>,<span class="va">nciclo</span>,<span class="va">alpha</span>,<span class="va">beta</span>,<span class="va">delta</span>,<span class="va">ta</span>,<span class="va">tb</span>,<span class="va">tc</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span>,caption<span class="op">=</span><span class="st">"Simulaciones para el proceso de fabricación con tres subprocesos encadenados A, B y C. Tipo de fallo, tiempos de funcionamiento del sistema (Tciclo en horas, Dciclo en días) y tiempo de funcionamiento potencial (Tpotencial en horas). Días de vida DA, DB, DC de los procesos."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
 <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; ">
<caption>
<span id="tab:procesofabricacion">Tabla 1.5: </span>Simulaciones para el proceso de fabricación con tres subprocesos encadenados A, B y C. Tipo de fallo, tiempos de funcionamiento del sistema (Tciclo en horas, Dciclo en días) y tiempo de funcionamiento potencial (Tpotencial en horas). Días de vida DA, DB, DC de los procesos.
</caption>
<thead><tr>
<th style="text-align:right;">
ciclo
</th>
<th style="text-align:left;">
fallo
</th>
<th style="text-align:right;">
Tciclo
</th>
<th style="text-align:right;">
Dciclo
</th>
<th style="text-align:right;">
Tpotencial
</th>
<th style="text-align:right;">
DA
</th>
<th style="text-align:right;">
DB
</th>
<th style="text-align:right;">
DC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
168.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
219.46
</td>
<td style="text-align:right;">
140.33
</td>
<td style="text-align:right;">
9.14
</td>
<td style="text-align:right;">
59.78
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
168.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
171.59
</td>
<td style="text-align:right;">
40.74
</td>
<td style="text-align:right;">
7.15
</td>
<td style="text-align:right;">
18.27
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
96.63
</td>
<td style="text-align:right;">
4.03
</td>
<td style="text-align:right;">
96.63
</td>
<td style="text-align:right;">
7.52
</td>
<td style="text-align:right;">
32.32
</td>
<td style="text-align:right;">
4.03
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
34.45
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:right;">
34.45
</td>
<td style="text-align:right;">
183.16
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:right;">
259.42
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
168.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
617.69
</td>
<td style="text-align:right;">
116.45
</td>
<td style="text-align:right;">
87.16
</td>
<td style="text-align:right;">
25.74
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
168.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
435.89
</td>
<td style="text-align:right;">
18.16
</td>
<td style="text-align:right;">
83.25
</td>
<td style="text-align:right;">
112.44
</td>
</tr>
</tbody>
</table></div>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que el sistema falle antes de finalizar un ciclo de trabajo?</li>
</ol>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">fallo</span> <span class="op">!=</span> <span class="st">"No"</span><span class="op">)</span>
<span class="va">error</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">fallo</span> <span class="op">!=</span> <span class="st">"No"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ic.low</span> <span class="op">=</span> <span class="va">m</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="va">ic.up</span> <span class="op">=</span> <span class="va">m</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pr(fallo antes del ciclo="</span>,<span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## Pr(fallo antes del ciclo= 0.2876</code></pre>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(Probabilidad)=["</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ic.low</span>, <span class="fl">4</span><span class="op">)</span>,<span class="st">","</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ic.up</span>, <span class="fl">4</span><span class="op">)</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(Probabilidad)=[ 0.2751 , 0.3001 ]</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>¿Cuál de los procesos está generando más parones en el ciclo debidos a una avería?</li>
</ol>
<p>En la Figura <a href="intro.html#fig:01-048">1.15</a> representamos (a la izquierda) el porcentaje que se detiene el proceso de fabricación antes de finalizar el ciclo, para cada uno de los tipos de fallo posible (debido a un parón en A, B o C), y difieren muy poco entre sí. El más frecuente, dentro de la similaridad es el fallo en el proceso C, con una probabilidad de 0.0986. A la derecha de la gráfica vemos cómo los tres tipos de fallo están dando tiempos de fabricación muy similares en media y variabilidad.</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Representación gráfica del ciclo de vida: tabla de probabilidades</span>
<span class="va">g1</span> <span class="op">=</span> <span class="va">simulacion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">fallo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, prop <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fallo</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">fallo</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, 
                  y <span class="op">=</span> <span class="va">prop</span>, group <span class="op">=</span> <span class="va">fallo</span><span class="op">)</span>,
              position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,
              vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tipo de fallo"</span>,y <span class="op">=</span> <span class="st">"Proporción"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>


<span class="co"># Tiempo de vida en función del ciclo</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulacion</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">fallo</span>, <span class="va">Tciclo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tipo de fallo"</span>, y <span class="op">=</span> <span class="st">"Tiempo de funcionamiento (horas)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:01-048"></span>
<img src="01-Probabilidad_files/figure-html/01-048-1.png" alt="Gráfico del ciclo de vida y de la probabilidad del tiempo de fabricación sin fallos." width="95%"><p class="caption">
Figura 1.15: Gráfico del ciclo de vida y de la probabilidad del tiempo de fabricación sin fallos.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>¿Cuál es el tiempo medio de funcionamiento del sistema sin ningún fallo? Interesa además, un rango o intervalo de confianza para dicha estimación. ¿Cuál sería el tiempo óptimo del ciclo para abordar las tareas de mantenimiento?</li>
</ol>
<p>Respondemos esta pregunta utilizando no el tiempo de ciclo impuesto como cota superior, sino el tiempo de funcionamiento que el sistema es capaz de aguantar sin fallos, recogido en la variable <code>Tpotencial</code>(en horas). Damos una estimación y construimos un intervalo de confianza al 95% para responder la pregunta.</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Tpotencial</span><span class="op">)</span>
<span class="va">error</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">Tpotencial</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">nsim</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ic.low</span> <span class="op">=</span> <span class="va">m</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="va">ic.up</span> <span class="op">=</span> <span class="va">m</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="va">error</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"E(Tpotencial)="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m</span><span class="op">/</span><span class="fl">24</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## E(Tpotencial)= 20.54</code></pre>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"IC(estimación)=["</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ic.low</span><span class="op">/</span><span class="fl">24</span>, <span class="fl">2</span><span class="op">)</span>,<span class="st">","</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ic.up</span><span class="op">/</span><span class="fl">24</span>, <span class="fl">2</span><span class="op">)</span>,<span class="st">"]"</span><span class="op">)</span></code></pre></div>
<pre><code>## IC(estimación)=[ 19.98 , 21.11 ]</code></pre>
<p>Resulta pues, que el sistema de fabricación tiene capacidad para funcionar sin fallos una media de 20.5 días, y el intervalo de confianza da un límite inferior de 19.98, lo que da justificaría, con unas garantías del 97.5%, reajustar el ciclo y darle un tamaño de 20 días, reduciendo así considerablemente los parones de un día completo de mantenimiento cada 7 en funcionamiento.</p>
<div class="example">
<p><span id="exm:secuencia2" class="example"><strong>Ejemplo 1.22  </strong></span>El gerente de una empresa que se dedica a la extracción y venta de piedra natural está preocupado porque piensa que hay un problema con la máquina que se dedica a cortar, en bloques más manejables, los bloques de piedra que vienen desde la cantera. La máquina trabaja durante 24 horas al día los 365 días del año, y las especificaciones de calidad establecen que la media y varianza del tiempo hasta que la máquina se detiene por un fallo, <span class="math inline">\(TF\)</span>, han de ser de 80 y 50 horas respectivamente.</p>
<p>En el histórico de mantenimiento de la empresa se han detectado tres tipos de fallos que se han catalogado como leves, moderados y graves. Además, la información del equipo de mantenimiento indica que el tipo de fallo que se produce está muy relacionado con el tiempo de funcionamiento de la máquina, de forma que la probabilidad de que se produzca un fallo u otro varía de acuerdo a la tabla siguiente:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>TF vs Fallo</th>
<th>Leve</th>
<th>Moderado</th>
<th>Grave</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(TF \leq 1500\)</span></td>
<td>0.85</td>
<td>0.10</td>
<td>0.05</td>
</tr>
<tr class="even">
<td><span class="math inline">\(1500 &lt; TF \leq 3000\)</span></td>
<td>0.75</td>
<td>0.15</td>
<td>0.10</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(TF &gt; 3000\)</span></td>
<td>0.65</td>
<td>0.20</td>
<td>0.15</td>
</tr>
</tbody>
</table></div>
<p>Los tiempos de reparación (medidos en minutos), <span class="math inline">\(TR\)</span>, tienen medias y varianzas dadas por:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Fallo</th>
<th>Media</th>
<th>Varianza</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Leve</td>
<td>30</td>
<td>15</td>
</tr>
<tr class="even">
<td>Moderado</td>
<td>60</td>
<td>30</td>
</tr>
<tr class="odd">
<td>Grave</td>
<td>120</td>
<td>45</td>
</tr>
</tbody>
</table></div>
<p>Además se sabe que si el fallo es leve, no es necesario detener la producción por completo, ya que esta se puede reducir al 60% y seguir trabajando mientras se realiza la reparación. En los otros dos casos la máquina debe detenerse por completo.</p>
<p>El gerente está interesado en conocer el funcionamiento de la máquina en los próximos seis meses asumiendo que las variables de tiempo de funcionamiento y tiempo de reparación son de tipo Weibull. En concreto desea saber qué porcentaje del tiempo la máquina estará trabajando a pleno rendimiento, a rendimiento reducido y parada.</p>
</div>
<p>Antes de plantear un algoritmo de simulación, tratemos de entender y modelizar bien la secuenciación de variables involucradas, según las especificaciones dadas. Las variables descritas son:</p>
<ul>
<li>
<span class="math inline">\(TF\)</span>: Tiempo de funcionamiento de la máquina hasta fallo.</li>
<li>
<span class="math inline">\(averia\)</span>: Tipo de avería cuando el sistema falla: leve, moderado, grave. Su distribución depende de <span class="math inline">\(tf\)</span>.</li>
<li>
<span class="math inline">\(TR.xx\)</span>: Tiempo de reparación para una avería “xx={leve, moderado, grave},” que depende del tipo de avería.</li>
</ul>
<p>El tiempo de funcionamiento a pleno rendimiento vendrá dado por el tiempo acumulado en el que el sistema funciona sin ningún fallo, obtenido de todos los <span class="math inline">\(TF\)</span> simulados. El funcionamiento a rendimiento reducido se dará mientras se está reparando alguna avería de tipo leve. El tiempo de parada del sistema corresponde a los periodos en los que se está reparando alguna avería de tipo moderada o grave. Puesto que el funcionamiento del sistema depende del tipo de avería, nos interesará guardar información sobre el tipo de avería que se está reparando, información que recopilaremos en la variable <span class="math inline">\(averia\)</span>. El tiempo dedicado a reparaciones lo guardaremos en una variable global denominada <span class="math inline">\(TREPARA\)</span>, que nos permitirá calcular cuándo el sistema no funciona a pleno rendimiento.</p>
<ul>
<li>
<span class="math inline">\(TREPARA\)</span>: Tiempo total dedicado a reparaciones.</li>
</ul>
<p>En cada simulación nos interesará contabilizar el tiempo transcurrido, en una variable</p>
<ul>
<li>
<span class="math inline">\(ciclo\)</span>: Tiempo de funcionamiento hasta fallo + tiempo de reparación.</li>
</ul>
<p>Interesa simular el funcionamiento del sistema en los próximos seis meses, de modo que dicho periodo expresado en minutos es de 2.592^{5}, y la simulación parará cuando <span class="math inline">\(ttotal&lt;259200\)</span> minutos, siendo</p>
<ul>
<li>
<span class="math inline">\(ttotal\)</span>: tiempo total acumulado de funcionamiento y reparaciones.</li>
</ul>
<p>Puesto que nos piden modelizar con distribuciones Weibull y sólo nos han dado su media y su varianza, hemos de calcular los parámetros a utilizar, para lo que acudimos a la función que ya propusimos en la Ecuación <a href="intro.html#eq:estimaweibuleq">(1.19)</a>.</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parámetros tiempo funcionamiento (en minutos)</span>
<span class="va">tf.params</span> <span class="op">&lt;-</span> <span class="fu">estima.weibull</span><span class="op">(</span><span class="fl">80</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">50</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span>; <span class="va">tf.params</span></code></pre></div>
<pre><code>## [1]    1.64 5365.22</code></pre>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tiempo de reparación para avería leve</span>
<span class="va">tr.leve</span> <span class="op">&lt;-</span> <span class="fu">estima.weibull</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">15</span><span class="op">)</span>; <span class="va">tr.leve</span></code></pre></div>
<pre><code>## [1]  2.10 33.87</code></pre>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tiempo de reparación para avería moderada</span>
<span class="va">tr.moderado</span> <span class="op">&lt;-</span> <span class="fu">estima.weibull</span><span class="op">(</span><span class="fl">60</span>, <span class="fl">30</span><span class="op">)</span>; <span class="va">tr.moderado</span></code></pre></div>
<pre><code>## [1]  2.10 67.74</code></pre>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tiempo de reparación para avería moderada</span>
<span class="va">tr.grave</span> <span class="op">&lt;-</span> <span class="fu">estima.weibull</span><span class="op">(</span><span class="fl">120</span>, <span class="fl">45</span><span class="op">)</span>; <span class="va">tr.grave</span></code></pre></div>
<pre><code>## [1]   2.90 134.58</code></pre>
<p>Así, tendremos las siguientes distribuciones para el tiempo de funcionamiento <span class="math inline">\(tf\)</span> y los tiempos de reparación <span class="math inline">\(tr\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray*}
TF &amp;\sim&amp; Weib(1.64,5365.22) \\
TR.leve &amp;\sim&amp; Weib(2.10, 33.87)  \\
TR.moderado &amp;\sim&amp; Weib(2.10, 67.74)  \\
TR.grave &amp;\sim&amp; Weib(2.90, 134.58).  
\end{eqnarray*}\]</span></p>
<p>Veamos ahora el algoritmo de simulación para este problema.</p>
<div class="silverbox">
<p><strong>Algoritmo secuencial para el estudio de fallo de la máquina</strong></p>
<ul>
<li>Paso 1. Inicializar todos las variables temporales a 0.</li>
</ul>
<p>Repetir los pasos 2 a 5 hasta que <span class="math inline">\(tiempo &gt; 6*30*24*60 = 259200\)</span> minutos.</p>
<ul>
<li><p>Paso 2. Generar <span class="math inline">\(tf\)</span>.<br></p></li>
<li><p>Paso 3. Generar el tipo de averia <span class="math inline">\(averia\)</span> en función de <span class="math inline">\(tf\)</span>.</p></li>
<li><p>Paso 4. Generar el tiempo de reparación <span class="math inline">\(trepara\)</span> en función del tipo de avería.</p></li>
<li><p>Paso 5. Actualizar el tiempo total acumulado <span class="math inline">\(ttotal\)</span> con el tiempo de funcionamiento y reparación.</p></li>
<li><p>Paso 6. Devolver el conjunto de valores simulados.</p></li>
</ul>
</div>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fijamos semilla y límite de tiempo para la simulación</span>
<span class="va">semilla</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">semilla</span><span class="op">)</span>
<span class="va">Tsim</span> <span class="op">&lt;-</span> <span class="fl">259200</span>
<span class="co"># Incicializamos variables</span>
<span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">trepara</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">averia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">ttotal</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">ciclo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="co"># Creamos variables necesarias para la simulación del tipo de avería:</span>
<span class="co"># probabilidades de avería leve, moderada y grave</span>
<span class="va">eti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"leve"</span>, <span class="st">"moderada"</span>, <span class="st">"grave"</span><span class="op">)</span>
<span class="va">pr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.10</span>, <span class="fl">0.05</span><span class="op">)</span>  <span class="co"># si tf&lt;=1500</span>
<span class="va">pr1acu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pr1</span><span class="op">)</span>
<span class="va">pr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.15</span>, <span class="fl">0.10</span><span class="op">)</span>  <span class="co"># si 1500&lt;tf&lt;=3000</span>
<span class="va">pr2acu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pr2</span><span class="op">)</span>
<span class="va">pr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.20</span>, <span class="fl">0.15</span><span class="op">)</span>  <span class="co"># si tf&gt;3000</span>
<span class="va">pr3acu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pr3</span><span class="op">)</span>

<span class="co">#############################</span>
<span class="co">## Simulación del proceso</span>
<span class="co">#############################</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">ttotal</span><span class="op">&lt;=</span> <span class="va">Tsim</span><span class="op">)</span>
<span class="op">{</span>
  <span class="co"># Tiempo de funcionamiento</span>
  <span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">rweibull</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">tf.params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tf.params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="co"># Tipo Averia</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">1500</span><span class="op">)</span>
      <span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">eti</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">pr1acu</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1500</span> <span class="op">&amp;</span> <span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">3000</span><span class="op">)</span>
      <span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">eti</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">pr2acu</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
  <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">3000</span><span class="op">)</span>
       <span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">eti</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">pr3acu</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
 <span class="co"># tiempo de reparación</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"leve"</span><span class="op">)</span>
      <span class="va">trepara</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">rweibull</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">tr.leve</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tr.leve</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"moderada"</span> <span class="op">)</span>
      <span class="va">trepara</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">rweibull</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">tr.moderado</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tr.moderado</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">averia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"grave"</span><span class="op">)</span>
      <span class="va">trepara</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">rweibull</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">tr.grave</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tr.grave</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> 
  <span class="co"># actualizamos tiempo total</span>
  <span class="va">ciclo</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">tf</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">trepara</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">ttotal</span><span class="op">=</span><span class="va">ttotal</span><span class="op">+</span><span class="va">ciclo</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span>
<span class="va">simulacion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tf</span>, averia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">averia</span><span class="op">)</span>, 
                         <span class="va">trepara</span>,tiempo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">ciclo</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Mostramos en la Tabla <a href="intro.html#tab:01-054">1.6</a> las simulaciones obtenidas y damos a continuación una breve descripción.</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span>,caption <span class="op">=</span> <span class="st">"Simulaciones para el sistema de corte de piedra."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic_2</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:01-054">Tabla 1.6: </span>Simulaciones para el sistema de corte de piedra.
</caption>
<thead><tr>
<th style="text-align:right;">
tf
</th>
<th style="text-align:left;">
averia
</th>
<th style="text-align:right;">
trepara
</th>
<th style="text-align:right;">
tiempo
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
9761.123
</td>
<td style="text-align:left;">
moderada
</td>
<td style="text-align:right;">
17.61378
</td>
<td style="text-align:right;">
9778.737
</td>
</tr>
<tr>
<td style="text-align:right;">
6330.278
</td>
<td style="text-align:left;">
leve
</td>
<td style="text-align:right;">
60.52762
</td>
<td style="text-align:right;">
16169.542
</td>
</tr>
<tr>
<td style="text-align:right;">
7472.127
</td>
<td style="text-align:left;">
leve
</td>
<td style="text-align:right;">
63.77925
</td>
<td style="text-align:right;">
23705.449
</td>
</tr>
<tr>
<td style="text-align:right;">
13942.609
</td>
<td style="text-align:left;">
leve
</td>
<td style="text-align:right;">
15.95977
</td>
<td style="text-align:right;">
37664.017
</td>
</tr>
<tr>
<td style="text-align:right;">
5291.304
</td>
<td style="text-align:left;">
leve
</td>
<td style="text-align:right;">
38.77331
</td>
<td style="text-align:right;">
42994.094
</td>
</tr>
<tr>
<td style="text-align:right;">
4762.548
</td>
<td style="text-align:left;">
leve
</td>
<td style="text-align:right;">
26.86817
</td>
<td style="text-align:right;">
47783.511
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Descriptivo del sistema</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">)</span></code></pre></div>
<pre><code>##        tf               averia      trepara            tiempo      
##  Min.   :  532.4   grave   : 5   Min.   :  5.171   Min.   :  9779  
##  1st Qu.: 2460.9   leve    :41   1st Qu.: 21.329   1st Qu.: 84710  
##  Median : 3878.1   moderada: 9   Median : 33.343   Median :146116  
##  Mean   : 4687.1                 Mean   : 43.292   Mean   :142494  
##  3rd Qu.: 6600.7                 3rd Qu.: 59.206   3rd Qu.:204825  
##  Max.   :13942.6                 Max.   :159.389   Max.   :260174</code></pre>
<p>Respondamos ya a diversas preguntas de interés.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es tiempo total de funcionamiento del sistema, incluidas reparaciones?</li>
<li>¿Qué porcentaje del tiempo total el sistema ha estado a pleno rendimiento, reducido y en parada?</li>
</ol>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tiempo total de funcionamiento del sistema (con reparaciones)</span>
<span class="va">ttotal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">last</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">tiempo</span><span class="op">)</span>
<span class="co"># Tiempo a pleno rendimiento</span>
<span class="va">tpleno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">tf</span><span class="op">)</span>
<span class="co"># Tiempo a rendimiento reducido</span>
<span class="va">tparcial</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">averia</span> <span class="op">==</span> <span class="st">"leve"</span><span class="op">)</span><span class="op">*</span><span class="va">trepara</span><span class="op">*</span><span class="fl">0.6</span><span class="op">)</span>
<span class="co"># Tiempo parado (reparaciones moderadas y graves)</span>
<span class="va">tdetenido</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">simulacion</span><span class="op">$</span><span class="va">averia</span> <span class="op">!=</span> <span class="st">"leve"</span><span class="op">)</span><span class="op">*</span><span class="va">trepara</span><span class="op">)</span>
<span class="co"># Juntamos los tiempos y calculamos porcentajes sobre el tiempo de funcionamiento total</span>
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ttotal</span>, <span class="va">tpleno</span>, <span class="va">tparcial</span>, <span class="va">tdetenido</span><span class="op">)</span><span class="op">/</span><span class="va">ttotal</span>,<span class="fl">2</span><span class="op">)</span>,
    col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"%Tiempo total"</span>,<span class="st">"%Pleno rendimiento"</span>,<span class="st">"%Rendimiento reducido"</span>,<span class="st">"%Parado"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic_2</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:right;">
%Tiempo total
</th>
<th style="text-align:right;">
%Pleno rendimiento
</th>
<th style="text-align:right;">
%Rendimiento reducido
</th>
<th style="text-align:right;">
%Parado
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
99.08
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.42
</td>
</tr></tbody>
</table></div>
<p>Se concluye que el 99.08% del tiempo durante los seis meses simulados, el sistema ha estado a pleno rendimiento, operando sin averías.</p>
</div>
</div>
<div id="ProEstoc" class="section level2" number="1.8">
<h2>
<span class="header-section-number">1.8</span> Procesos estocásticos<a class="anchor" aria-label="anchor" href="#ProEstoc"><i class="fas fa-link"></i></a>
</h2>
<p>Una vez hemos recordado cuestiones básicas y distribuciones comunes de probabilidad, a la vez que hemos aprendido algunos algoritmos como el de la Transformada Inversa (Sección <a href="intro.html#transformadainversa">1.5</a> o el de Composición Sección <a href="intro.html#composicionsec">1.7.2</a>), damos un paso más y presentamos el concepto de procesos estocásticos, que es el objeto de esta asignatura.</p>
<div class="yellowbox">
<div class="definition">
<p><span id="def:procesoestocastico" class="definition"><strong>Definición 1.23  </strong></span>Un proceso estocástico es una secuencia de variables aleatorias <span class="math inline">\(\{X(t), t \in T\}\)</span> y que dependen del parámetro <span class="math inline">\(t\)</span>, que toma valores en el conjunto índice <span class="math inline">\(T\)</span> o de instantes de tiempo.</p>
<p>Se denomina <strong>espacio de estados del proceso</strong>, <span class="math inline">\(S\)</span>, al conjunto de todos los posibles valores de las variables aleatorias que componen el proceso.</p>
</div>
</div>
<p>Si <span class="math inline">\(T\)</span> es un conjunto de tiempos discretos, <span class="math inline">\(t = 0, 1, 2, 3,...\)</span>, definidos por ejemplo al finalizar cada día o cada hora, obtenemos un <strong>proceso estocástico de tiempo discreto (PETD)</strong>, <span class="math inline">\(\{X(0), X(1), X(2),...\}\)</span>.</p>
<p>En cambio, si observamos el sistema continuamente a lo largo del tiempo <span class="math inline">\(t&gt;\geq 0\)</span>, obtenemos un <strong>proceso estocástico de tiempo continuo (PETC)</strong>, <span class="math inline">\(\{X(t), t \geq 0\}\)</span>.</p>
<p>El espacio de estados de un proceso puede ser de tipo discreto o continuo, en función de los posibles valores que pueden tomar las variables aleatorias <span class="math inline">\(X(t)\)</span> que lo componen.</p>
<div id="ejemplos-de-procesos-estocásticos" class="section level3" number="1.8.1">
<h3>
<span class="header-section-number">1.8.1</span> Ejemplos de procesos estocásticos<a class="anchor" aria-label="anchor" href="#ejemplos-de-procesos-estoc%C3%A1sticos"><i class="fas fa-link"></i></a>
</h3>
<p>A continuación veamos algunos ejemplos de procesos PETD y PETC. Te proponemos identificar en cada uno de ellos cuáles pueden ser las cuestiones de interés a investigar.</p>
<p>En primer lugar, presentamos algunos ejemplos de procesos estocásticos de tiempo discreto (PETD).</p>
<div class="example">
<p><span id="exm:petd1" class="example"><strong>Ejemplo 1.23  </strong></span>Sea <span class="math inline">\(X_t\)</span> la temperatura (en grados centígrados) registrada en el aeropuerto de Alicante-Elche a las 12:00 horas del día <span class="math inline">\(t\)</span>. El espacio de estados del proceso estocástico <span class="math inline">\(S\)</span> viene dado por <span class="math inline">\((-20, 50).\)</span> Esto implica que la temperatura nunca baja de veinte bajo cero ni supera los cincuenta grados; da lugar a un espacio de estados continuo.</p>
</div>
<div class="example">
<p><span id="exm:petd2" class="example"><strong>Ejemplo 1.24  </strong></span>Consideramos como <span class="math inline">\(X_t\)</span> la variable aleatoria que registra el número ganador de la ONCE en el sorteo diario. Puesto que los números tienen 5 dígitos, el espacio de estados es discreto y viene dado por el conjunto de enteros entre 00000 y 99999.</p>
</div>
<div class="example">
<p><span id="exm:petd3" class="example"><strong>Ejemplo 1.25  </strong></span>Sea <span class="math inline">\(X_t\)</span> la variable aleatoria que registra el valor del IPC al final del mes <span class="math inline">\(t\)</span> para España. En tería el IPC puede tomar cualquier valor ente <span class="math inline">\((-\infty, +\infty)\)</span>, por lo que el espacio de estados es continuo.</p>
</div>
<div class="example">
<p><span id="exm:petd4" class="example"><strong>Ejemplo 1.26  </strong></span>Sea <span class="math inline">\(X_t\)</span> el número de reclamaciones que recibe una compañía de seguros una semana cualquiera <span class="math inline">\(t\)</span>. El espacio de estados es discreto y viene dado por <span class="math inline">\(\{0, 1, 2, 3, 4,...\}\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:petd5" class="example"><strong>Ejemplo 1.27  </strong></span>Sea <span class="math inline">\(X_t\)</span> el número de accidentes que ocurren en la carretera que une las poblaciones de Elche y Santa Pola en la semana <span class="math inline">\(t\)</span>. El espacio de estados es discreto y viene dado por <span class="math inline">\(\{0, 1, 2, 3, 4,...\}\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:petd6" class="example"><strong>Ejemplo 1.28  </strong></span>Sea <span class="math inline">\(X_t\)</span> el número de productos defectuosos que genera una cadena de producción en cada uno de los lotes fabricados a lo largo de un día. El espacio de estados es discreto, <span class="math inline">\(\{0, 1, 2, 3, 4,...\}\)</span> y también <span class="math inline">\(t\)</span>, que identifica el número de lote producido.</p>
</div>
<p>Y a continuación veamos otros ejemplos de procesos estocásticos de tiempo continuo (PETC).</p>
<div class="example">
<p><span id="exm:petc1" class="example"><strong>Ejemplo 1.29  </strong></span>Supongamos que una máquina puede estar en dos estados, encendido o apagado. Sea <span class="math inline">\(X(t)\)</span> la variable aleatoria que refleja el estado de la máquina en el instante de tiempo <span class="math inline">\(t\)</span>. Entonces <span class="math inline">\(\{X(t), t \geq 0\}\)</span> es un proceso estocástico de tiempo continuo con el espacio de estados discreto, con valores posibles {encendido, apagado}.</p>
</div>
<div class="example">
<p><span id="exm:petc2" class="example"><strong>Ejemplo 1.30  </strong></span>Un ordenador personal (PC) puede ejecutar muchos procesos simultáneamente. Si <span class="math inline">\(X(t)\)</span> es el número de procesos que se ejecutan en dicho PC en el momento <span class="math inline">\(t\)</span>. Entonces <span class="math inline">\(X(t), t \geq 0\)</span> es un proceso estocástico de tiempo continuo con espacio de estados discreto <span class="math inline">\(0, 1, 2,...,K\)</span> ,donde <span class="math inline">\(K\)</span> es el número máximo de trabajos que puede manejar el PC simultáneamente.</p>
</div>
<div class="example">
<p><span id="exm:petc3" class="example"><strong>Ejemplo 1.31  </strong></span>Sea <span class="math inline">\(X(t)\)</span> es el número de clientes que entran a una tienda de libros en una franja de tiempo de duración <span class="math inline">\(t\)</span>. Entonces <span class="math inline">\(X(t), t \geq 0\)</span> es un proceso estocástico de tiempo continuo con espacio de estados discreto <span class="math inline">\(0, 1, 2,...\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:petc4" class="example"><strong>Ejemplo 1.32  </strong></span>Sea <span class="math inline">\(X(t)\)</span> una variable que recopila información sobre si se produce o no un fallo en el sistema de alimentación eléctrico de un circuito a lo largo del tiempo. El espacio de estados es discreto, con valores <span class="math inline">\(\{0,1\}\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:petc5" class="example"><strong>Ejemplo 1.33  </strong></span>Sea <span class="math inline">\(X(t)\)</span> la temperatura en grados centígrados registrada en una localización dada en cualquier instante de tiempo <span class="math inline">\(t\)</span>. Entonces <span class="math inline">\(X(t), t \geq 0\)</span> es un proceso estocástico de tiempo continuo con espacio de estados continuo.</p>
</div>
</div>
<div id="función-de-distribución-del-proceso" class="section level3" number="1.8.2">
<h3>
<span class="header-section-number">1.8.2</span> Función de distribución del proceso<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-distribuci%C3%B3n-del-proceso"><i class="fas fa-link"></i></a>
</h3>
<p>Los ejemplos anteriores muestran una variedad de problemas que pueden ser modelados y estudiados como procesos estocásticos, y para hacerlo será preciso analizar el comportamiento aleatorio del proceso, sea cual sea la naturaleza de los tiempos, discretos o continuos.</p>
<p>Puesto un proceso estocástico es una colección de variables aleatorias, la forma de inferir sobre él es a través de la <strong>función de distribución conjunta</strong> que se construye a partir de las variables <span class="math inline">\(X(t_1), X(t_2),...,X(t_n)\)</span>:</p>
<p><span class="math display" id="eq:dproceso">\[\begin{equation}
F(x_1, x_2,...,x_n) = Pr(X(t_1) \leq x_1, X(t_2) \leq x_2,..., X(t_n) \leq x_n) 
\tag{1.24}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(x_1, x_2,..., x_n \in \mathbb{R}^n.\)</span></p>
<p>Si el proceso estocástico tiene una estructura simple, entonces los cálculos no son excesivamente complicados, pero no suele ser la tónica de procesos útiles para representar sistemas reales. A lo largo de los años los investigadores han modelizado y estudiado clases especiales de procesos estocásticos que pueden utilizarse para describir una gran variedad de sistemas reales, resolviendo y posibilitando así los cálculos probabilísticos necesarios, aunque su complejidad en ocasiones no haya sido evitable. Las dos clases más importantes de procesos estocásticos ya modelizados son las <strong>cadenas de Markov de tiempo discreto (CMTD)</strong> y las <strong>cadenas de Markov de tiempo continuo (CMTC)</strong>. Sin embargo, en los últimos años el desarrollo de la computación ha posibilitado el uso intensivo de la simulación para resolver de un modo sencillo cálculos probabilísticos complejos y así analizar fácilmente el comportamiento de los sistemas reales, sin necesidad de extraer analíticamente la distribución de probabilidad conjunta del proceso.</p>
<p>En los temas siguientes iremos describiendo este tipo de procesos, mostrando los resultados teórico, pero centrándonos en cómo utilizar las herramientas de simulación disponibles para reproducir el comportamiento del sistemas reales sin necesidad de registrar datos ni de realizar complejos desarrollos probabilísticos.</p>
<p>Por analogía con el análisis de variables aleatorias serán relevantes en el estudio de procesos estocásticos, su valor esperado, <span class="math inline">\(E[X(t)]\)</span>, su varianza, <span class="math inline">\(V[X(t)] = E[X(t)^2] - E[X(t)]^2\)</span> y la covarianza <span class="math inline">\(Cov[X(t), X(s)] = E[X(t)X(s)] - E[X(t)]E[X(s)]\)</span>, que vendrán dadas en función de tiempos <span class="math inline">\(t\)</span> y <span class="math inline">\(s\)</span>.</p>
</div>
</div>
<div id="ejer-u1" class="section level2" number="1.9">
<h2>
<span class="header-section-number">1.9</span> Ejercicios<a class="anchor" aria-label="anchor" href="#ejer-u1"><i class="fas fa-link"></i></a>
</h2>
<div id="básicos" class="section level3" number="1.9.1">
<h3>
<span class="header-section-number">1.9.1</span> Básicos<a class="anchor" aria-label="anchor" href="#b%C3%A1sicos"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Ejercicio B1.1.</strong> Un proceso de fabricación tiene una tasa de defectos del 20% y los artículos se colocan en cajas de cinco. Un inspector toma muestras de dos artículos de cada caja. Si uno o los dos artículos seleccionados son defectuosos, la caja se rechaza. Si un cliente pide 10 cajas, ¿cuál es el número esperado de artículos defectuosos que recibirá el cliente? Da una aproximación del error y una banda de confianza.</p>
<p><strong>Ejercicio B1.2.</strong> Un vendedor a domicilio vende ollas y sartenes. Sólo entra en el 50% de las casas que visita. De las casas en las que entra, 1/6 de los propietarios no están interesados en comprar nada, 1/2 de ellos acaban haciendo un pedido de 60 dólares, y 1/3 de ellos acaban haciendo un pedido de 100 dólares. Estima el promedio de ventas (en dólares) conseguidas para 25 visitas (junto con una medida del error). Estima el promedio de ventas por visita.</p>
<p><strong>Ejercicio B1.3.</strong> Un contratista de techos independiente ha determinado que el número de trabajos que se solicitan para el mes de septiembre es bastante variable. A partir de la experiencia anterior, las probabilidades de obtener 0, 1, 2 o 3 trabajos se han determinado como 0.1, 0.35, 0.30 y 0.25, respectivamente. El beneficio obtenido por cada trabajo es de 300 dólares. ¿Cuál es el beneficio esperado para el mes de septiembre?</p>
<p><strong>Ejercicio B1.4.</strong> Un sistema de visión está diseñado para medir el ángulo en el que el brazo de un robot se desvía de la vertical. Sin embargo, el sistema de visión no es totalmente preciso, y el resultado de las observaciones es una variable aleatoria con una distribución uniforme. Si la medición indica que el rango del ángulo está entre 9.7 y 10.5 grados, aproxima por simulación la probabilidad de que el ángulo real esté entre 9.9 y 10.1 grados y da una medida del error de dicha aproximación.</p>
<p><strong>Ejercicio B1.5.</strong> En una operación de soldadura automatizada, la posición en la que se coloca la soldadura es muy importante. La desviación del centro de la placa es una variable aleatoria normal con una media de 0 pulgadas y una desviación estándar de 0.01 pulgadas. Una desviación positiva indica una desviación a la derecha del centro y una desviación negativa indica una desviación a la izquierda del centro.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que en una placa dada, la ubicación real de la soldadura se desvíe menos de 0.005 pulgadas (en valor absoluto) del centro?</li>
<li>¿Cuál es la probabilidad de que en una placa dada, la ubicación real de la soldadura se desvíe más de 0.02 pulgadas (en valor absoluto) del centro?</li>
</ol>
<p>Da aproximaciones del error cometido al aproximar por simulación.</p>
<p><strong>Ejercicio B1.6.</strong> Un departamento de compras percibe que el 75% de sus pedidos especiales se reciben a tiempo. De los pedidos que se reciben a tiempo, el 80% cumple totalmente las especificaciones; de los pedidos que llegan con retraso, el 60% cumple con las especificaciones. Responde a las siguientes preguntas utilizando simulación, dando también una medida del error.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que un pedido llegue a tiempo y cumpla con las especificaciones?</li>
<li>¿Cuál es la probabilidad de que un pedido cumpla con las especificaciones?</li>
<li>Si se han recibido cuatro pedidos, ¿cuál es la probabilidad de que los cuatro pedidos cumplan con las especificaciones?</li>
</ol>
<p><strong>Ejercicio B1.7.</strong> Una empresa manufacturera tiene tres operarios para una máquina que produce cierto tipo de componentes. El operario A tiene una tasa de defectos del 5%, el operario B del 3%, y el operario C del 2%. Los tres operarios producen el mismo número de componentes. Si un componente elegido al azar resulta defectuoso, ¿cuál es la probabilidad de que el componente haya sido producido por A, B, o C? Responde a la pregunta con simulación y da una medida del error de la aproximación.</p>
<p><strong>Ejercicio B1.8.</strong> El 1% de los préstamos que hace cierta empresa financiera no son saldados (es decir, la cantidad prestada no le es devuelta en su totalidad). La compañía efectúa un estudio rutinario de las posibilidades crediticias de los solicitantes. Encuentra que el 30% de los préstamos no saldados se hicieron a clientes de alto riesgo, el 40% a clientes de riesgo moderado y el restante 30% a clientes de bajo riesgo. De los préstamos que fueron saldados, el 10% se hicieron a clientes de alto riesgo, el 40% a clientes de riesgo moderado y el 50% a clientes de bajo riesgo. Responde a las siguientes preguntas utilizando simulación, dando también una medida del error.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que un préstamo de alto riesgo no sea saldado?</li>
<li>¿Cuál es la probabilidad de que una deuda no saldada, dado que el riesgo es moderado?</li>
</ol>
<p><strong>Ejercicio B1.9.</strong> Se hacen dos inversiones de 10000€ cada una en dos proyectos. Se supone que el proyecto A va a producir un rendimiento neto de 800, 1000 y 1200 euros con probabilidades respectivas de 0.2, 0.6, 0.2. Se supone que el proyecto B va a producir una ganancia neta de 800, 1000, y 1200 euros, con probabilidades respectivas 0.3, 0.4, 0.3. Si asumimos que lo que se gana con un proyecto es independiente de lo que se gana con el otro, responde a las siguientes preguntas utilizando simulación, dando también una medida del error.</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que la ganancia total sea de 2000 euros exactamente?</li>
<li>¿Cuál es la probabilidad de que la ganancia total sea igual o superior a 2000 euros?</li>
<li>¿Cuál es la probabilidad de que la ganancia sea inferior a 2000 euros?</li>
</ol>
<p><strong>Ejercicio B1.10.</strong> Sea <span class="math inline">\(X\)</span> una variable aleatoria de tipo continuo cuya función de densidad viene dada por:</p>
<p><span class="math display">\[\begin{equation*}
f(x) = \frac{5}{3}(1-x^3)x  \text{ para } 0 \leq x \leq 1
\end{equation*}\]</span></p>
<p>Utilizando simulación:</p>
<ol style="list-style-type: decimal">
<li>Determina la <span class="math inline">\(Pr(X \leq 0.5).\)</span>
</li>
<li>Determina la <span class="math inline">\(Pr(0.25 \leq X \leq 0.75).\)</span>
</li>
<li>Determina la <span class="math inline">\(Pr(X &gt; 1/3).\)</span>
</li>
</ol>
<p><strong>Ejercicio B1.11.</strong> Sea <span class="math inline">\(X\)</span> una variable aleatoria de tipo continuo cuya función de densidad viene dada por:</p>
<p><span class="math display">\[\begin{equation*}
f(x) = \frac{1}{8}x \text{ para } 0 \leq x \leq 4
\end{equation*}\]</span></p>
<p>Utilizando simulación:</p>
<ol style="list-style-type: decimal">
<li>Determina el valor de <span class="math inline">\(t\)</span> tal que <span class="math inline">\(Pr(X \leq t) = 0.25\)</span>
</li>
<li>Determina el valor de <span class="math inline">\(t\)</span> tal que <span class="math inline">\(Pr(X \leq t) = 0.5\)</span>
</li>
</ol>
<p><strong>Ejercicio B1.12.</strong> Sea <span class="math inline">\(X\)</span> una variable aleatoria de tipo continuo cuya función de densidad viene dada por:</p>
<p><span class="math display">\[\begin{equation*}
f(x) = e^{-x} \text{ para } x &gt; 0
\end{equation*}\]</span></p>
<p>Utilizando simulación:</p>
<ol style="list-style-type: decimal">
<li>Determina el valor esperado y la desviación típica de la variable <span class="math inline">\(Y = X^{1/2}.\)</span>
</li>
<li>Determina <span class="math inline">\(Pr(Y \geq 1).\)</span>
</li>
</ol>
<p><strong>Ejercicio B1.13.</strong> Los administradores de cierta industria han probado, por pruebas técnicas, que su producto tiene una vida media de 5 años, y la han descrito con una distribución exponencial. Si el tiempo de garantía asignado por los administradores es de 1 año, ¿qué porcentaje de sus productos será devuelto para reparar durante el periodo de garantía? Aproxima por simulación y da una medida del error.</p>
</div>
<div id="avanzados" class="section level3" number="1.9.2">
<h3>
<span class="header-section-number">1.9.2</span> Avanzados<a class="anchor" aria-label="anchor" href="#avanzados"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Ejercicio A1.1.</strong></p>
<p>Los problemas de inventario tratan de dar respuesta a las necesidades de almacenamiento de las empresas para satisfacer la demanda de los consumidores. En concreto, en este caso se plantea el problema de un distribuidor del mercado central especializado en la venta de fresas. Dicho comerciante compra cajas al precio de 20€, y las vende por 50€, y tiene dos problemas relacionados directamente con lo que denominamos “inventario”:</p>
<ol style="list-style-type: lower-alpha">
<li>Si los clientes solicitan más cajas de las disponibles el comerciante pierde 30€ por cada caja de menos disponible.</li>
<li>Si el comerciante almacena más cajas de las solicitadas por los clientes, el producto se debe tirar y pierde 20€ por cada caja que no vende.</li>
</ol>
<p>Para tratar de determinar el número de cajas que debe comprar y almacenar, recoge información sobre la demanda realizada por los clientes en la campaña anterior, cuyos datos vienen dados en la tabla siguiente:</p>
<div class="inline-table"><table class="table table-sm"><tbody>
<tr class="odd">
<td>Cajas Vendidas</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
</tr>
<tr class="even">
<td>Número de días</td>
<td>15</td>
<td>20</td>
<td>40</td>
<td>25</td>
</tr>
</tbody></table></div>
<p>La empresa proporciona en la tabla siguiente las ganancias esperadas diarias (en euros) asociadas al número de cajas vendidas y las cajas que debería almacenar:</p>
<div class="inline-table"><table class="table table-sm"><tbody>
<tr class="odd">
<td>Demanda</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
</tr>
<tr class="even">
<td>Almacenar 10</td>
<td>300</td>
<td>300</td>
<td>300</td>
<td>300</td>
</tr>
<tr class="odd">
<td>Almacenar 11</td>
<td>280</td>
<td>330</td>
<td>330</td>
<td>330</td>
</tr>
</tbody></table></div>
<p>En base a esta información se debe obtener la ganancia esperada para cada acción de inventario, y determinar aquella que proporcione mayores beneficios, es decir, las mayores ganancias diarias. ¿Qué recomendación se debería hacer al distribuidor?</p>
<p>Por otro lado, los asesores convencen al distribuidor de que para tener mayor certeza de sus ganancias debería realizar un estudio marginal, que se basa en el hecho de que cuando se compra una unidad adicional de un artículo (en este caso una caja) pueden ocurrir dos cosas: la unidad se vende o no se vende. De esta forma:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que la demanda sea al menos de 11 cajas? ¿Y de al menos 12? ¿Y de al menos 13?</li>
<li>¿Cuál resulta la ganancia y pérdida marginal esperada por la venta o no de una caja más con cada una de las probabilidades anteriores?</li>
<li>¿Qué opción recomiendas al distribuidor?</li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="software.html">Software</a></div>
<div class="next"><a href="cmtd.html"><span class="header-section-number">2</span> Cadenas de Markov de Tiempo Discreto</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#intro"><span class="header-section-number">1</span> Conceptos básicos</a></li>
<li>
<a class="nav-link" href="#variables-aleatorias"><span class="header-section-number">1.1</span> Variables aleatorias</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#funci%C3%B3n-de-probabilidad"><span class="header-section-number">1.1.1</span> Función de probabilidad</a></li>
<li><a class="nav-link" href="#variables-relevantes"><span class="header-section-number">1.1.2</span> Variables relevantes</a></li>
<li><a class="nav-link" href="#media-y-varianza"><span class="header-section-number">1.1.3</span> Media y varianza</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#APMC"><span class="header-section-number">1.2</span> Aproximación Monte Carlo</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mc-y-probabilidad"><span class="header-section-number">1.2.1</span> MC y probabilidad</a></li>
<li><a class="nav-link" href="#mc-y-momentos"><span class="header-section-number">1.2.2</span> MC y momentos</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distribuciones-discretas"><span class="header-section-number">1.3</span> Distribuciones discretas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#bernouilli"><span class="header-section-number">1.3.1</span> Bernouilli</a></li>
<li><a class="nav-link" href="#binomial"><span class="header-section-number">1.3.2</span> Binomial</a></li>
<li><a class="nav-link" href="#geom%C3%A9trica"><span class="header-section-number">1.3.3</span> Geométrica</a></li>
<li><a class="nav-link" href="#poisson"><span class="header-section-number">1.3.4</span> Poisson</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distribuciones-continuas"><span class="header-section-number">1.4</span> Distribuciones continuas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#uniforme"><span class="header-section-number">1.4.1</span> Uniforme</a></li>
<li><a class="nav-link" href="#exponencial"><span class="header-section-number">1.4.2</span> Exponencial</a></li>
<li><a class="nav-link" href="#gamma"><span class="header-section-number">1.4.3</span> Gamma</a></li>
<li><a class="nav-link" href="#weibull"><span class="header-section-number">1.4.4</span> Weibull</a></li>
<li><a class="nav-link" href="#normal"><span class="header-section-number">1.4.5</span> Normal</a></li>
</ul>
</li>
<li><a class="nav-link" href="#transformadainversa"><span class="header-section-number">1.5</span> Simular con la Transformada Inversa</a></li>
<li>
<a class="nav-link" href="#otras-distribuciones-discretas"><span class="header-section-number">1.6</span> Otras distribuciones discretas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#una-variable-discreta"><span class="header-section-number">1.6.1</span> Una variable discreta</a></li>
<li><a class="nav-link" href="#mixturas-de-discretas"><span class="header-section-number">1.6.2</span> Mixturas de Discretas</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#otras-distribuciones-continuas"><span class="header-section-number">1.7</span> Otras distribuciones continuas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#una-variable-continua"><span class="header-section-number">1.7.1</span> Una variable continua</a></li>
<li><a class="nav-link" href="#composicionsec"><span class="header-section-number">1.7.2</span> Transformaciones y Método de Composición</a></li>
<li><a class="nav-link" href="#combinaciones-de-variables"><span class="header-section-number">1.7.3</span> Combinaciones de variables</a></li>
<li><a class="nav-link" href="#modelos-secuenciales"><span class="header-section-number">1.7.4</span> Modelos secuenciales</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ProEstoc"><span class="header-section-number">1.8</span> Procesos estocásticos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ejemplos-de-procesos-estoc%C3%A1sticos"><span class="header-section-number">1.8.1</span> Ejemplos de procesos estocásticos</a></li>
<li><a class="nav-link" href="#funci%C3%B3n-de-distribuci%C3%B3n-del-proceso"><span class="header-section-number">1.8.2</span> Función de distribución del proceso</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ejer-u1"><span class="header-section-number">1.9</span> Ejercicios</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#b%C3%A1sicos"><span class="header-section-number">1.9.1</span> Básicos</a></li>
<li><a class="nav-link" href="#avanzados"><span class="header-section-number">1.9.2</span> Avanzados</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Simulación de Procesos y Sistemas</strong>" was written by true, true. It was last built on 2022-03-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
